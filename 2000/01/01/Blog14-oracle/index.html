<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 5.4.2">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.0.0/css/all.min.css" integrity="sha256-jTIdiMuX/e3DGJUGwl3pKSxuc6YOuqtJYkM0bGQESA4=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"example.com","root":"/","images":"/images","scheme":"Muse","darkmode":false,"version":"8.10.1","exturl":false,"sidebar":{"position":"left","width":500,"display":"always","padding":1,"offset":12},"copycode":false,"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"}}</script><script src="/js/config.js"></script>

    <meta name="description" content="oracle">
<meta property="og:type" content="article">
<meta property="og:title" content="Blog14-oracle">
<meta property="og:url" content="http://example.com/2000/01/01/Blog14-oracle/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="oracle">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="1999-12-31T16:00:14.000Z">
<meta property="article:modified_time" content="2023-11-23T06:15:19.311Z">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="http://example.com/2000/01/01/Blog14-oracle/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"en","comments":true,"permalink":"http://example.com/2000/01/01/Blog14-oracle/","path":"2000/01/01/Blog14-oracle/","title":"Blog14-oracle"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>Blog14-oracle | Hexo</title>
  





  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">Hexo</p>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>







</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Blog14-oracle"><span class="nav-text">Blog14-oracle</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%B8%AE%E5%8A%A9"><span class="nav-text">帮助</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%86%85%E5%AE%B9%E7%AE%A1%E7%90%86"><span class="nav-text">内容管理</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Chapter01-%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BB%8B%E7%BB%8D"><span class="nav-text">Chapter01 数据库介绍</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-1-Oracle-%E4%BB%8B%E7%BB%8D"><span class="nav-text">1.1 Oracle 介绍</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9AOracle-%E6%95%B0%E6%8D%AE%E5%BA%93%E7%94%9F%E6%80%81"><span class="nav-text">知识点：Oracle 数据库生态</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9AOracle-%E6%95%B0%E6%8D%AE%E5%BA%93%E7%89%88%E6%9C%AC%E5%8F%B7"><span class="nav-text">知识点：Oracle 数据库版本号</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9AOracle-%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8A%9F%E8%83%BD%E6%BC%94%E5%8F%98"><span class="nav-text">知识点：Oracle 数据库功能演变</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9AOracle-%E8%AE%A4%E8%AF%81"><span class="nav-text">知识点：Oracle 认证</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9ADUAL-%E8%A1%A8"><span class="nav-text">知识点：DUAL 表</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Chapter02-sqlplus"><span class="nav-text">Chapter02 sqlplus</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#2-1-sqlplus-%E4%BB%8B%E7%BB%8D"><span class="nav-text">2.1 sqlplus 介绍</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9AOracle-%E5%AE%A2%E6%88%B7%E7%AB%AF%E4%BB%8B%E7%BB%8D"><span class="nav-text">知识点：Oracle 客户端介绍</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9Asqlplus-%E4%BB%8B%E7%BB%8D"><span class="nav-text">知识点：sqlplus 介绍</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9Asqlplus-%E5%AE%89%E8%A3%85"><span class="nav-text">知识点：sqlplus 安装</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9Asqlplus-%E6%98%BE%E7%A4%BA%E4%B8%AD%E6%96%87"><span class="nav-text">知识点：sqlplus 显示中文</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-2-sqlplus-%E5%BB%BA%E7%AB%8B%E8%BF%9E%E6%8E%A5"><span class="nav-text">2.2 sqlplus 建立连接</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9Asqlplus-%E6%8C%87%E4%BB%A4"><span class="nav-text">知识点：sqlplus 指令</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9Asqlplus-%E6%9C%AC%E5%9C%B0%E8%BF%9E%E6%8E%A5"><span class="nav-text">知识点：sqlplus 本地连接</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9Asqlplus-%E7%9A%84%E8%BF%9E%E6%8E%A5%E6%A8%A1%E5%BC%8F"><span class="nav-text">知识点：sqlplus 的连接模式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9ACONNECT-%E6%8C%87%E4%BB%A4"><span class="nav-text">知识点：CONNECT 指令</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9ADISCONNECT-%E6%8C%87%E4%BB%A4"><span class="nav-text">知识点：DISCONNECT 指令</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-3-sqlplus-%E9%85%8D%E7%BD%AE"><span class="nav-text">2.3 sqlplus 配置</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9Asqlplus-%E9%85%8D%E7%BD%AE"><span class="nav-text">知识点：sqlplus 配置</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9Asqlplus-%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="nav-text">知识点：sqlplus 配置文件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9ASET-%E6%8C%87%E4%BB%A4"><span class="nav-text">知识点：SET 指令</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9ASTORE-%E6%8C%87%E4%BB%A4"><span class="nav-text">知识点：STORE 指令</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9ACLEAR-%E6%8C%87%E4%BB%A4"><span class="nav-text">知识点：CLEAR 指令</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9ASHOW-%E6%8C%87%E4%BB%A4"><span class="nav-text">知识点：SHOW 指令</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-4-sqlplus-%E8%BF%90%E8%A1%8C-SQL"><span class="nav-text">2.4 sqlplus 运行 SQL</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9Asqlplus-%E8%BF%90%E8%A1%8C-SQL"><span class="nav-text">知识点：sqlplus 运行 SQL</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9ASTART-%E6%8C%87%E4%BB%A4"><span class="nav-text">知识点：START 指令</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A%E6%9B%BF%E6%8D%A2%E5%8F%98%E9%87%8F"><span class="nav-text">知识点：替换变量</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9ADEFINE-%E6%8C%87%E4%BB%A4"><span class="nav-text">知识点：DEFINE 指令</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9AUNDEFINE-%E6%8C%87%E4%BB%A4"><span class="nav-text">知识点：UNDEFINE 指令</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9AACCEPT-%E6%8C%87%E4%BB%A4"><span class="nav-text">知识点：ACCEPT 指令</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-5-sqlplus-%E6%8A%A5%E5%91%8A"><span class="nav-text">2.5 sqlplus 报告</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9Asqlplus-%E6%8A%A5%E5%91%8A"><span class="nav-text">知识点：sqlplus 报告</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9ACOLUMN-%E6%8C%87%E4%BB%A4"><span class="nav-text">知识点：COLUMN 指令</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9AREPHEADER%E3%80%81REPFOOTER%E3%80%81TTITLE%E3%80%81BTITLE-%E6%8C%87%E4%BB%A4"><span class="nav-text">知识点：REPHEADER、REPFOOTER、TTITLE、BTITLE 指令</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9APAUSE-%E6%8C%87%E4%BB%A4"><span class="nav-text">知识点：PAUSE 指令</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9ABREAK-%E6%8C%87%E4%BB%A4"><span class="nav-text">知识点：BREAK 指令</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9ACOMPUTE-%E6%8C%87%E4%BB%A4"><span class="nav-text">知识点：COMPUTE 指令</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9Adummy-column"><span class="nav-text">知识点：dummy column</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9ASPOOL-%E6%8C%87%E4%BB%A4"><span class="nav-text">知识点：SPOOL 指令</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9AMARKUP"><span class="nav-text">知识点：MARKUP</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-6-sqlplus-%E6%99%AE%E9%80%9A%E6%8C%87%E4%BB%A4"><span class="nav-text">2.6 sqlplus 普通指令</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9AHELP-%E6%8C%87%E4%BB%A4"><span class="nav-text">知识点：HELP 指令</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9AEXIT-%E6%8C%87%E4%BB%A4"><span class="nav-text">知识点：EXIT 指令</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9APROMPT-%E6%8C%87%E4%BB%A4"><span class="nav-text">知识点：PROMPT 指令</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9AHOST-%E6%8C%87%E4%BB%A4"><span class="nav-text">知识点：HOST 指令</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9AHISTORY-%E6%8C%87%E4%BB%A4"><span class="nav-text">知识点：HISTORY 指令</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9ATIMING-%E6%8C%87%E4%BB%A4"><span class="nav-text">知识点：TIMING 指令</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9APASSWORD-%E6%8C%87%E4%BB%A4"><span class="nav-text">知识点：PASSWORD 指令</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9AEXEC-%E6%8C%87%E4%BB%A4"><span class="nav-text">知识点：EXEC 指令</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-7-sql-buffer"><span class="nav-text">2.7 sql buffer</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9Asql-buffer-%E4%BB%8B%E7%BB%8D"><span class="nav-text">知识点：sql buffer 介绍</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9ALIST-%E6%8C%87%E4%BB%A4"><span class="nav-text">知识点：LIST 指令</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9AEDIT-%E6%8C%87%E4%BB%A4"><span class="nav-text">知识点：EDIT 指令</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9ARUN-%E6%8C%87%E4%BB%A4"><span class="nav-text">知识点：RUN 指令</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9AGET-%E6%8C%87%E4%BB%A4"><span class="nav-text">知识点：GET 指令</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9ASAVE-%E6%8C%87%E4%BB%A4"><span class="nav-text">知识点：SAVE 指令</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9ACHANGE-%E6%8C%87%E4%BB%A4"><span class="nav-text">知识点：CHANGE 指令</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9AAPPEND-%E6%8C%87%E4%BB%A4"><span class="nav-text">知识点：APPEND 指令</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9AINPUT-%E6%8C%87%E4%BB%A4"><span class="nav-text">知识点：INPUT 指令</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9ADEL-%E6%8C%87%E4%BB%A4"><span class="nav-text">知识点：DEL 指令</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Chapter03-%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BD%93%E7%B3%BB"><span class="nav-text">Chapter03 数据库体系</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#3-1-%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BD%93%E7%B3%BB%E4%BB%8B%E7%BB%8D"><span class="nav-text">3.1 数据库体系介绍</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-2-%E6%95%B0%E6%8D%AE%E5%AD%97%E5%85%B8"><span class="nav-text">3.2 数据字典</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-3-%E5%8F%82%E6%95%B0"><span class="nav-text">3.3 参数</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-4-%E6%8E%A7%E5%88%B6%E6%96%87%E4%BB%B6"><span class="nav-text">3.4 控制文件</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-5-redo"><span class="nav-text">3.5 redo</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-6-undo"><span class="nav-text">3.6 undo</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-7-%E5%A4%9A%E7%A7%9F%E6%88%B7"><span class="nav-text">3.7 多租户</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Chapter04-%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E4%BE%8B"><span class="nav-text">Chapter04 数据库实例</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#4-1-%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E4%BE%8B%E6%A6%82%E8%BF%B0"><span class="nav-text">4.1 数据库实例概述</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-2-%E5%90%AF%E5%8A%A8%E5%92%8C%E5%81%9C%E6%AD%A2%E5%AE%9E%E4%BE%8B"><span class="nav-text">4.2 启动和停止实例</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-3-%E5%86%85%E5%AD%98%E7%BB%93%E6%9E%84"><span class="nav-text">4.3 内存结构</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-4-%E8%BF%9B%E7%A8%8B%E7%BB%93%E6%9E%84"><span class="nav-text">4.4 进程结构</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Chapter05-%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AD%98%E5%82%A8"><span class="nav-text">Chapter05 数据库存储</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#5-1-%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AD%98%E5%82%A8%E6%A6%82%E8%BF%B0"><span class="nav-text">5.1 数据库存储概述</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-2-%E8%A1%A8%E7%A9%BA%E9%97%B4%E5%92%8C%E6%95%B0%E6%8D%AE%E6%96%87%E4%BB%B6"><span class="nav-text">5.2 表空间和数据文件</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-3-%E6%AE%B5"><span class="nav-text">5.3 段</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-4-%E5%8C%BA"><span class="nav-text">5.4 区</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-5-%E5%9D%97"><span class="nav-text">5.5 块</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Chapter06-%E6%95%B0%E6%8D%AE%E5%BA%93%E7%AE%A1%E7%90%86"><span class="nav-text">Chapter06 数据库管理</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#6-6-diag"><span class="nav-text">6.6 diag</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Chapter07-%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%89%E5%85%A8"><span class="nav-text">Chapter07 数据库安全</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#7-1-%E8%B4%A6%E5%8F%B7"><span class="nav-text">7.1 账号</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#7-2-%E6%9D%83%E9%99%90"><span class="nav-text">7.2 权限</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#7-3-%E9%85%8D%E9%A2%9D"><span class="nav-text">7.3 配额</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Chapter08-%E6%95%B0%E6%8D%AE%E5%BA%93%E7%BD%91%E7%BB%9C"><span class="nav-text">Chapter08 数据库网络</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#8-1-Oracle-%E7%BD%91%E7%BB%9C%E4%BB%8B%E7%BB%8D"><span class="nav-text">8.1 Oracle 网络介绍</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9AOracle-%E7%BD%91%E7%BB%9C%E4%BB%8B%E7%BB%8D"><span class="nav-text">知识点：Oracle 网络介绍</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#8-2-%E8%BF%9E%E6%8E%A5"><span class="nav-text">8.2 连接</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A%E8%BF%9E%E6%8E%A5"><span class="nav-text">知识点：连接</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A%E4%B8%93%E6%9C%89%E8%BF%9E%E6%8E%A5"><span class="nav-text">知识点：专有连接</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A%E5%85%B1%E4%BA%AB%E8%BF%9E%E6%8E%A5"><span class="nav-text">知识点：共享连接</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#8-3-%E4%BC%9A%E8%AF%9D"><span class="nav-text">8.3 会话</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A%E4%BC%9A%E8%AF%9D"><span class="nav-text">知识点：会话</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A%E4%BC%9A%E8%AF%9D%E6%93%8D%E4%BD%9C"><span class="nav-text">知识点：会话操作</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9Av-session"><span class="nav-text">知识点：v$session</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#8-4-%E7%9B%91%E5%90%AC"><span class="nav-text">8.4 监听</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A%E7%9B%91%E5%90%AC"><span class="nav-text">知识点：监听</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9Alistener-ora"><span class="nav-text">知识点：listener.ora</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9Alsnrctl"><span class="nav-text">知识点：lsnrctl</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#8-5-%E6%9C%8D%E5%8A%A1"><span class="nav-text">8.5 服务</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A%E6%9C%8D%E5%8A%A1"><span class="nav-text">知识点：服务</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A%E9%9D%99%E6%80%81%E6%B3%A8%E5%86%8C"><span class="nav-text">知识点：静态注册</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A%E5%8A%A8%E6%80%81%E6%B3%A8%E5%86%8C"><span class="nav-text">知识点：动态注册</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A%E5%8A%A8%E6%80%81%E6%B3%A8%E5%86%8C%E6%93%8D%E4%BD%9C"><span class="nav-text">知识点：动态注册操作</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#8-6-tnsname"><span class="nav-text">8.6 tnsname</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9Atnsname-%E4%BB%8B%E7%BB%8D"><span class="nav-text">知识点：tnsname 介绍</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9Atnsname-ora-%E8%AF%AD%E6%B3%95"><span class="nav-text">知识点：tnsname.ora 语法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9Atnsping"><span class="nav-text">知识点：tnsping</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#8-7-dblink"><span class="nav-text">8.7 dblink</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9Adblink-%E4%BB%8B%E7%BB%8D"><span class="nav-text">知识点：dblink 介绍</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9ACREATE-DATABASE-LINK"><span class="nav-text">知识点：CREATE DATABASE LINK</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9ADROP-DATABASE-LINK"><span class="nav-text">知识点：DROP DATABASE LINK</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9AALTER-DATABASE-LINK"><span class="nav-text">知识点：ALTER DATABASE LINK</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#8-8-netca"><span class="nav-text">8.8 netca</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9Anetca"><span class="nav-text">知识点：netca</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9Anetca-%E5%88%9B%E5%BB%BA%E9%BB%98%E8%AE%A4%E7%9B%91%E5%90%AC"><span class="nav-text">知识点：netca 创建默认监听</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Chapter09-%E5%AE%89%E8%A3%85%E5%92%8C%E5%BB%BA%E5%BA%93"><span class="nav-text">Chapter09 安装和建库</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#9-1-%E5%AE%89%E8%A3%85"><span class="nav-text">9.1 安装</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9AOracle-%E5%AE%89%E8%A3%85%E4%BB%8B%E7%BB%8D"><span class="nav-text">知识点：Oracle 安装介绍</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9AOracle-%E5%AE%89%E8%A3%85%E5%87%86%E5%A4%87%E6%93%8D%E4%BD%9C"><span class="nav-text">知识点：Oracle 安装准备操作</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9ArunInstaller-%E4%BB%8B%E7%BB%8D"><span class="nav-text">知识点：runInstaller 介绍</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9ArunInstaller-%E8%BF%90%E8%A1%8C%E5%8F%82%E6%95%B0"><span class="nav-text">知识点：runInstaller 运行参数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9Aruninstaller-%E5%93%8D%E5%BA%94%E6%96%87%E6%A1%A3"><span class="nav-text">知识点：runinstaller 响应文档</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9Aruninstaller-%E9%9D%99%E9%BB%98%E5%AE%89%E8%A3%85-19c-%E6%93%8D%E4%BD%9C"><span class="nav-text">知识点：runinstaller 静默安装 19c 操作</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#9-2-DBCA"><span class="nav-text">9.2 DBCA</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9ADBCA-%E4%BB%8B%E7%BB%8D"><span class="nav-text">知识点：DBCA 介绍</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9ADBCA-createDatabase"><span class="nav-text">知识点：DBCA createDatabase</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9ADBCA-%E9%9D%99%E9%BB%98%E5%88%9B%E5%BB%BA-19c-%E5%8D%95%E5%AE%9E%E4%BE%8B%E4%BC%A0%E7%BB%9F%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="nav-text">知识点：DBCA 静默创建 19c 单实例传统数据库</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9ADBCA-%E9%9D%99%E9%BB%98%E5%88%9B%E5%BB%BA-19c-%E5%8D%95%E5%AE%9E%E4%BE%8B%E5%A4%9A%E7%A7%9F%E6%88%B7%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="nav-text">知识点：DBCA 静默创建 19c 单实例多租户数据库</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9ADBCA-deleteDatabase"><span class="nav-text">知识点：DBCA deleteDatabase</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#9-3-%E5%88%9B%E5%BB%BA-PDB"><span class="nav-text">9.3 创建 PDB</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A%E5%88%9B%E5%BB%BA-PDB-%E4%BB%8B%E7%BB%8D"><span class="nav-text">知识点：创建 PDB 介绍</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9ACREATE-PLUGGABLE-DATABASE"><span class="nav-text">知识点：CREATE PLUGGABLE DATABASE</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9ADROP-PLUGGABLE-DATABASE"><span class="nav-text">知识点：DROP PLUGGABLE DATABASE</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Chapter10-%E6%95%B0%E6%8D%AE%E8%BF%81%E7%A7%BB"><span class="nav-text">Chapter10 数据迁移</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#10-1-spool"><span class="nav-text">10.1 spool</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9Aoracle-%E6%95%B0%E6%8D%AE%E4%BF%9D%E5%AD%98%E4%B8%BA-csv"><span class="nav-text">知识点：oracle 数据保存为 csv</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#10-2-datapump"><span class="nav-text">10.2 datapump</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9Adatapump-%E4%BB%8B%E7%BB%8D"><span class="nav-text">知识点：datapump 介绍</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9Aexpdp-%E6%8C%87%E4%BB%A4"><span class="nav-text">知识点：expdp 指令</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9Aexpdp-%E8%8C%83%E4%BE%8B"><span class="nav-text">知识点：expdp 范例</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9Aexpdp-%E5%8F%82%E6%95%B0%E6%96%87%E4%BB%B6%E5%92%8C%E9%AB%98%E7%BA%A7%E9%80%89%E9%A1%B9"><span class="nav-text">知识点：expdp 参数文件和高级选项</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9Aimpdp-%E6%8C%87%E4%BB%A4"><span class="nav-text">知识点：impdp 指令</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9Aimpdp-%E5%8F%82%E6%95%B0%E6%96%87%E4%BB%B6%E5%92%8C%E9%AB%98%E7%BA%A7%E9%85%8D%E7%BD%AE"><span class="nav-text">知识点：impdp 参数文件和高级配置</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9Aimpdp-%E8%8C%83%E4%BE%8B"><span class="nav-text">知识点：impdp 范例</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#10-3-sqlldr"><span class="nav-text">10.3 sqlldr</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9Asqlldr-%E4%BB%8B%E7%BB%8D%EF%BC%88%E4%B8%8D%E5%85%A8%EF%BC%89"><span class="nav-text">知识点：sqlldr 介绍（不全）</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Chapter11-%E5%A4%87%E4%BB%BD%E6%81%A2%E5%A4%8D"><span class="nav-text">Chapter11 备份恢复</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#11-1-%E6%95%B0%E6%8D%AE%E5%AE%89%E5%85%A8"><span class="nav-text">11.1 数据安全</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A%E6%95%B0%E6%8D%AE%E5%AE%89%E5%85%A8%E4%BB%8B%E7%BB%8D"><span class="nav-text">知识点：数据安全介绍</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9AOracle-%E7%9A%84%E6%95%B0%E6%8D%AE%E5%AE%89%E5%85%A8%E4%BD%93%E7%B3%BB"><span class="nav-text">知识点：Oracle 的数据安全体系</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#11-2-%E5%A4%87%E4%BB%BD"><span class="nav-text">11.2 备份</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A%E5%A4%87%E4%BB%BD%E6%96%87%E4%BB%B6"><span class="nav-text">知识点：备份文件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A%E5%A4%87%E4%BB%BD%E6%96%B9%E5%BC%8F"><span class="nav-text">知识点：备份方式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A%E5%A2%9E%E9%87%8F%E5%A4%87%E4%BB%BD"><span class="nav-text">知识点：增量备份</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#11-3-%E6%81%A2%E5%A4%8D"><span class="nav-text">11.3 恢复</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A%E8%BF%98%E5%8E%9F%E5%92%8C%E6%81%A2%E5%A4%8D"><span class="nav-text">知识点：还原和恢复</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A%E5%AE%8C%E5%85%A8%E6%81%A2%E5%A4%8D%E5%92%8C%E4%B8%8D%E5%AE%8C%E5%85%A8%E6%81%A2%E5%A4%8D"><span class="nav-text">知识点：完全恢复和不完全恢复</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#11-4-FRA"><span class="nav-text">11.4 FRA</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9AFRA-%E4%BB%8B%E7%BB%8D"><span class="nav-text">知识点：FRA 介绍</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#11-5-%E5%BD%92%E6%A1%A3"><span class="nav-text">11.5 归档</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A%E5%BD%92%E6%A1%A3%E6%97%A5%E5%BF%97%E4%BB%8B%E7%BB%8D"><span class="nav-text">知识点：归档日志介绍</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9AARCHIVE-LOG-LIST-%E8%AF%AD%E5%8F%A5"><span class="nav-text">知识点：ARCHIVE LOG LIST 语句</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9AALTER-DATABASE-ARCHIVELOG-%E8%AF%AD%E5%8F%A5"><span class="nav-text">知识点：ALTER DATABASE ARCHIVELOG 语句</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9AALTER-SYSTEM-ARCHIVE-LOG-%E8%AF%AD%E5%8F%A5"><span class="nav-text">知识点：ALTER SYSTEM ARCHIVE LOG 语句</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#11-6-DRA"><span class="nav-text">11.6 DRA</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#11-7-%E9%97%AA%E5%9B%9E"><span class="nav-text">11.7 闪回</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#11-8-%E9%A2%9D%E5%A4%96%E5%86%85%E5%AE%B9"><span class="nav-text">11.8 额外内容</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Chapter12-RMAN"><span class="nav-text">Chapter12 RMAN</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#12-1-RMAN-%E4%BB%8B%E7%BB%8D"><span class="nav-text">12.1 RMAN 介绍</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9ARMAN-%E4%BB%8B%E7%BB%8D"><span class="nav-text">知识点：RMAN 介绍</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9ARMAN-TARGET-%E6%8C%87%E4%BB%A4"><span class="nav-text">知识点：RMAN TARGET 指令</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#12-2-RMAN-%E9%85%8D%E7%BD%AE"><span class="nav-text">12.2 RMAN 配置</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9ARMAN-%E9%85%8D%E7%BD%AE%E4%BB%8B%E7%BB%8D"><span class="nav-text">知识点：RMAN 配置介绍</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9ARMAN-%E9%85%8D%E7%BD%AE%E8%AF%A6%E8%A7%A3"><span class="nav-text">知识点：RMAN 配置详解</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9ARMAN-SHOW-%E5%91%BD%E4%BB%A4"><span class="nav-text">知识点：RMAN SHOW 命令</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9ARMAN-CONFIGURE-%E5%91%BD%E4%BB%A4"><span class="nav-text">知识点：RMAN CONFIGURE 命令</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9ARMAN-SET-%E5%91%BD%E4%BB%A4"><span class="nav-text">知识点：RMAN SET 命令</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#12-3-RMAN-%E5%9F%BA%E7%A1%80%E6%8C%87%E4%BB%A4"><span class="nav-text">12.3 RMAN 基础指令</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9ARMAN-EXIT-%E5%91%BD%E4%BB%A4"><span class="nav-text">知识点：RMAN EXIT 命令</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9ARMAN-SQL-%E5%91%BD%E4%BB%A4"><span class="nav-text">知识点：RMAN SQL 命令</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9ARMAN-DESCRIBE-%E5%91%BD%E4%BB%A4"><span class="nav-text">知识点：RMAN DESCRIBE 命令</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9ARMAN-RUN-%E5%91%BD%E4%BB%A4"><span class="nav-text">知识点：RMAN RUN 命令</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#12-4-RMAN-%E4%BB%93%E5%BA%93%E6%93%8D%E4%BD%9C"><span class="nav-text">12.4 RMAN 仓库操作</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9ARMAN-LIST-%E5%91%BD%E4%BB%A4"><span class="nav-text">知识点：RMAN LIST 命令</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9ARMAN-REPORT-%E5%91%BD%E4%BB%A4"><span class="nav-text">知识点：RMAN REPORT 命令</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9ARMAN-CROSSCHECK-%E5%91%BD%E4%BB%A4"><span class="nav-text">知识点：RMAN CROSSCHECK 命令</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9ARMAN-VALIDATE-%E5%91%BD%E4%BB%A4"><span class="nav-text">知识点：RMAN VALIDATE 命令</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#12-5-RMAN-%E5%A4%87%E4%BB%BD%E6%93%8D%E4%BD%9C"><span class="nav-text">12.5 RMAN 备份操作</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9ARMAN-BACKUP-%E5%91%BD%E4%BB%A4"><span class="nav-text">知识点：RMAN BACKUP 命令</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9ARMAN-BACKUP-Backup-Operand-%E4%BB%8E%E5%8F%A5"><span class="nav-text">知识点：RMAN BACKUP Backup_Operand 从句</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9ARMAN-BACKUP-Backup-Spec-%E4%BB%8E%E5%8F%A5"><span class="nav-text">知识点：RMAN BACKUP Backup_Spec 从句</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9ARMAN-BACKUP-Backup-Spec-Operand-%E4%BB%8E%E5%8F%A5"><span class="nav-text">知识点：RMAN BACKUP Backup_Spec_Operand 从句</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9ARMAN-BACKUP-FormatSpec-%E4%BB%8E%E5%8F%A5"><span class="nav-text">知识点：RMAN BACKUP FormatSpec 从句</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#11-6-RMAN-%E6%81%A2%E5%A4%8D%E6%93%8D%E4%BD%9C"><span class="nav-text">11.6 RMAN 恢复操作</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#11-7-%E5%B8%B8%E8%A7%81%E6%95%85%E9%9A%9C"><span class="nav-text">11.7 常见故障</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Chapter13-ASM"><span class="nav-text">Chapter13 ASM</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Chapter12-DG"><span class="nav-text">Chapter12 DG</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">John Doe</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">18</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
  </nav>
</div>



        </div>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2000/01/01/Blog14-oracle/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="John Doe">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
      <meta itemprop="description" content="">
    </span>
    
    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="Blog14-oracle | Hexo">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Blog14-oracle
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2000-01-01 00:00:14" itemprop="dateCreated datePublished" datetime="2000-01-01T00:00:14+08:00">2000-01-01</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2023-11-23 14:15:19" itemprop="dateModified" datetime="2023-11-23T14:15:19+08:00">2023-11-23</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <hr>
<h1 id="Blog14-oracle"><a href="#Blog14-oracle" class="headerlink" title="Blog14-oracle"></a>Blog14-oracle</h1><p><a href="#Chapter01-Oracle-%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BB%8B%E7%BB%8D"><strong>Chapter01 Oracle 数据库介绍</strong></a></p>
<ul>
<li><a href="#1-1-Oracle-%E4%BB%8B%E7%BB%8D">1.1 Oracle 介绍</a></li>
</ul>
<p><a href="#Chapter02-sqlplus"><strong>Chapter02 sqlplus</strong></a></p>
<ul>
<li><a href="#2-1-sqlplus-%E4%BB%8B%E7%BB%8D">2.1 sqlplus 介绍</a></li>
<li><a href="#2-2-sqlplus-%E5%BB%BA%E7%AB%8B%E8%BF%9E%E6%8E%A5">2.2 sqlplus 建立连接</a></li>
<li><a href="#2-3-sqlplus-%E9%85%8D%E7%BD%AE">2.3 sqlplus 配置</a></li>
<li><a href="#2-4-sqlplus-%E8%BF%90%E8%A1%8C-sql">2.4 sqlplus 运行 sql</a></li>
<li><a href="#2-5-sqlplus-%E6%8A%A5%E5%91%8A">2.5 sqlplus 报告</a></li>
<li><a href="#2-6-sqlplus-%E6%99%AE%E9%80%9A%E6%8C%87%E4%BB%A4">2.6 sqlplus 普通指令</a></li>
<li><a href="#2-7-sql-buffer">2.7 sql buffer</a></li>
</ul>
<p><a href="#Chapter03-%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BD%93%E7%B3%BB"><strong>Chapter03 数据库体系</strong></a></p>
<ul>
<li>[3.1 数据库体系介绍]</li>
<li>[3.2 数据字典]</li>
<li>[3.3 参数]</li>
<li>[3.4 控制文件]</li>
<li>[3.5 redo]</li>
<li>[3.6 undo]</li>
<li>[3.7 多租户]</li>
</ul>
<p><a href="#Chapter04-%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E4%BE%8B"><strong>Chapter04 数据库实例</strong></a></p>
<ul>
<li>[4.1 数据库实例概述]</li>
<li>[4.2 启动和停止实例]</li>
<li>[4.3 内存结构]</li>
<li>[4.4 进程结构]</li>
</ul>
<p><a href="#Chapter05-%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AD%98%E5%82%A8"><strong>Chapter05 数据库存储</strong></a></p>
<ul>
<li>[5.1 数据库存储概述]</li>
<li>[5.2 表空间和数据文件]</li>
<li>[5.3 段]</li>
<li>[5.4 区]</li>
<li>[5.5 块]</li>
</ul>
<p><a href="#Chapter06-%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%89%E8%A3%85"><strong>Chapter06 数据库管理</strong></a></p>
<ul>
<li>[6.6 diag]</li>
</ul>
<p><a href="#Chapter07-%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%89%E5%85%A8"><strong>Chapter07 数据库安全</strong></a></p>
<ul>
<li>[7.1 账号]</li>
<li>[7.2 权限]</li>
<li>[7.3 配额]</li>
</ul>
<p><a href="#Chapter08-%E6%95%B0%E6%8D%AE%E5%BA%93%E7%BD%91%E7%BB%9C"><strong>Chapter08 数据库网络</strong></a></p>
<ul>
<li><a href="#8-1-Oracle-%E7%BD%91%E7%BB%9C%E4%BB%8B%E7%BB%8D">8.1 Oracle 网络介绍</a></li>
<li><a href="#8-2-%E8%BF%9E%E6%8E%A5">8.2 连接</a></li>
<li><a href="#8-3-%E4%BC%9A%E8%AF%9D">8.3 会话</a></li>
<li><a href="#8-4-%E7%9B%91%E5%90%AC">8.4 监听</a></li>
<li><a href="#8-5-%E6%9C%8D%E5%8A%A1">8.5 服务</a></li>
<li><a href="#8-6-tnsname">8.6 tnsname</a></li>
<li><a href="#8-7-dblink">8.7 dblink</a></li>
<li><a href="#8-8-netca">8.8 netca</a></li>
</ul>
<p><a href="#Chapter09-%E5%AE%89%E8%A3%85%E5%92%8C%E5%BB%BA%E5%BA%93"><strong>Chapter09 安装和建库</strong></a></p>
<ul>
<li><a href="#9-1-%E5%AE%89%E8%A3%85">9.1 安装</a></li>
<li><a href="#9-2-DBCA">9.2 DBCA</a></li>
<li><a href="#9-3-%E5%88%9B%E5%BB%BA-PDB">9.3 创建 PDB</a></li>
<li><a href="#9-4-%E5%BC%80%E6%9C%BA%E8%87%AA%E5%90%AF">9.4 开机自启</a></li>
</ul>
<p><a href="#Chapter10-%E6%95%B0%E6%8D%AE%E8%BF%81%E7%A7%BB"><strong>Chapter10 数据迁移</strong></a></p>
<ul>
<li><a href="#10-1-spool">10.1 spool</a></li>
<li><a href="#10-2-datapump">10.2 datapump</a></li>
<li><a href="#10-3-sqlldr">10.3 sqlldr</a></li>
</ul>
<p><a href="#Chapter11-%E5%A4%87%E4%BB%BD%E6%81%A2%E5%A4%8D"><strong>Chapter11 备份恢复</strong></a></p>
<ul>
<li><a href="#11-1-%E6%95%B0%E6%8D%AE%E5%AE%89%E5%85%A8">11.1 数据安装</a></li>
<li><a href="#11-2-%E5%A4%87%E4%BB%BD">11.2 备份</a></li>
<li><a href="#11-3-%E6%81%A2%E5%A4%8D">11.3 恢复</a></li>
<li><a href="#11-4-FRA">11.4 FRA</a></li>
<li><a href="#11-5-%E5%BD%92%E6%A1%A3">11.5 归档</a></li>
<li><a href="#11-6-%E5%BD%92%E6%A1%A3">11.6 DRA</a></li>
<li><a href="#11-7-%E9%97%AA%E5%9B%9E">11.7 闪回</a></li>
<li><a href="#11-8-%E9%A2%9D%E5%A4%96%E5%86%85%E5%AE%B9">11.8 额外内容</a></li>
</ul>
<p><a href="#Chapter12-%E5%A4%87%E4%BB%BD%E6%81%A2%E5%A4%8D"><strong>Chapter12 RMAN</strong></a></p>
<ul>
<li><a href="#12-1-RMAN-%E4%BB%8B%E7%BB%8D">12.1 RMAN 介绍</a></li>
<li><a href="#12-2-RMAN-%E9%85%8D%E7%BD%AE">12.2 RMAN 配置</a></li>
<li><a href="#12-3-RMAN-%E5%9F%BA%E7%A1%80%E6%8C%87%E4%BB%A4">12.3 RMAN 基础指令</a></li>
<li><a href="#12-4-RMAN-%E4%BB%93%E5%BA%93%E6%93%8D%E4%BD%9C">12.4 RMAN 仓库操作</a></li>
<li><a href="#12-5-RMAN-%E5%A4%87%E4%BB%BD%E6%93%8D%E4%BD%9C">12.5 RMAN 备份操作</a></li>
<li><a href="#12-6-RMAN-%E6%81%A2%E5%A4%8D%E6%93%8D%E4%BD%9C">12.6 RMAN 恢复操作</a></li>
<li><a href="#12-7-%E5%B8%B8%E8%A7%81%E6%95%85%E9%9A%9C">12.7 常见故障</a></li>
</ul>
<p><a href="#Chapter13-ASM"><strong>Chapter13 ASM</strong></a></p>
<p><a href="#Chapter14-DG"><strong>Chapter14 DG</strong></a></p>
<hr>
<h2 id="帮助"><a href="#帮助" class="headerlink" title="帮助"></a>帮助</h2><ol>
<li><strong>官方文档</strong></li>
</ol>
<ul>
<li><a target="_blank" rel="noopener" href="https://docs.oracle.com/en/database/oracle/oracle-database/18/books.html"><strong>18C BOOKS</strong></a></li>
<li><a target="_blank" rel="noopener" href="https://docs.oracle.com/en/database/oracle/oracle-database/18/cncpt/index.html"><strong>18C 数据库概念 Database Concepts</strong></a></li>
<li><a target="_blank" rel="noopener" href="https://docs.oracle.com/en/database/oracle/oracle-database/18/admin/index.html"><strong>18C 数据库管理 Administrator’s Guide</strong></a></li>
<li><a target="_blank" rel="noopener" href="https://docs.oracle.com/en/database/oracle/oracle-database/18/netag/index.html"><strong>18C 数据库网络 Net Services Administrator’s Guide</strong></a></li>
<li><a target="_blank" rel="noopener" href="https://docs.oracle.com/en/database/oracle/oracle-database/18/dbseg/index.html"><strong>18C 数据库安全 Security Guide</strong></a></li>
<li><a target="_blank" rel="noopener" href="https://docs.oracle.com/en/database/oracle/oracle-database/18/bradv/index.html"><strong>18C 备份恢复 User Guide</strong></a></li>
<li><a target="_blank" rel="noopener" href="https://docs.oracle.com/en/database/oracle/oracle-database/18/refrn/index.html"><strong>18C Database Reference</strong></a></li>
<li><a target="_blank" rel="noopener" href="https://docs.oracle.com/en/database/oracle/oracle-database/18/sqlrf/index.html"><strong>18C SQL Reference</strong></a></li>
<li><a target="_blank" rel="noopener" href="https://docs.oracle.com/en/database/oracle/oracle-database/18/sqpug/index.html"><strong>18C Sqlplus Reference</strong></a></li>
<li><a target="_blank" rel="noopener" href="https://docs.oracle.com/en/database/oracle/oracle-database/18/rcmrf/index.html"><strong>18C RMAN Reference</strong></a></li>
<li><a target="_blank" rel="noopener" href="https://docs.oracle.com/en/database/oracle/oracle-database/18/sutil/index.html"><strong>18C Utilities</strong></a></li>
<li><a target="_blank" rel="noopener" href="https://docs.oracle.com/en/database/oracle/oracle-database/18/vldbg/index.html"><strong>18C VLDB Guide</strong></a></li>
<li><a target="_blank" rel="noopener" href="https://docs.oracle.com/en/database/oracle/oracle-database/18/ostmg/index.html"><strong>18C ASM Guide</strong></a></li>
<li><a target="_blank" rel="noopener" href="https://docs.oracle.com/en/database/oracle/oracle-database/18/sbydb/index.html"><strong>18C DG Guide</strong></a></li>
<li><a target="_blank" rel="noopener" href="https://docs.oracle.com/en/database/oracle/oracle-database/18/tgsql/index.html"><strong>18C SQL Tuning Guide</strong></a></li>
<li><a target="_blank" rel="noopener" href="https://docs.oracle.com/en/database/oracle/oracle-database/18/tgdba/index.html"><strong>18C Performance Tuning Guide</strong></a></li>
<li><a target="_blank" rel="noopener" href="https://docs.oracle.com/en/database/oracle/oracle-database/21/multi/index.html"><strong>21C Multitenant Guide</strong></a><ul>
<li><a target="_blank" rel="noopener" href="https://docs.oracle.com/en/database/oracle/oracle-database/21/multi/dbca-reference.html#GUID-5DD346B8-4404-48F1-A811-F39D739E4D05"><strong>dbca</strong></a></li>
</ul>
</li>
</ul>
<hr>
<h2 id="内容管理"><a href="#内容管理" class="headerlink" title="内容管理"></a>内容管理</h2><ol>
<li><strong>未整理</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">* Chapter01 Oracle 数据库介绍</span><br><span class="line"></span><br><span class="line">* Chapter02 sqlplus</span><br><span class="line"></span><br><span class="line">* Chapter03 数据库体系</span><br><span class="line"></span><br><span class="line">* Chapter04 数据库实例</span><br><span class="line"></span><br><span class="line">* Chapter05 数据库存储</span><br><span class="line"></span><br><span class="line">* Chapter06 数据库管理</span><br><span class="line"></span><br><span class="line">* Chapter07 数据库安全</span><br><span class="line"></span><br><span class="line">* Chapter08 数据库网络</span><br><span class="line">  - 连接</span><br><span class="line">    1. 什么是连接</span><br><span class="line">    2. 连接与进程之间的关系</span><br><span class="line">    3. 连接在数据字典/动态性能视图之中的记录</span><br><span class="line">  - 共享连接</span><br><span class="line">    1. 数据库只能有一个共享连接 service？</span><br><span class="line">    2. 共享连接只能连接到 cdb？</span><br><span class="line">  - 会话</span><br><span class="line">    - 会话和连接之间的关系</span><br><span class="line"></span><br><span class="line">* Chapter09 安装和建库</span><br><span class="line">  - 开机自启</span><br><span class="line"></span><br><span class="line">* Chapter10 数据迁移</span><br><span class="line"></span><br><span class="line">* Chapter11 备份恢复</span><br><span class="line">  * 化身 incarnation</span><br><span class="line">  * backupset 的关键字 Primary_Key 和 backuppiece 的关键字 Primary_key</span><br><span class="line"></span><br><span class="line">* Chapter12 RMAN</span><br><span class="line"></span><br><span class="line">* Chapter13 ASM</span><br><span class="line"></span><br><span class="line">* Chapter14 DG</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
<li><strong>待学习</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">* ASM</span><br><span class="line"></span><br><span class="line">* 数据库同步</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h1 id="Chapter01-数据库介绍"><a href="#Chapter01-数据库介绍" class="headerlink" title="Chapter01 数据库介绍"></a>Chapter01 数据库介绍</h1><hr>
<h2 id="1-1-Oracle-介绍"><a href="#1-1-Oracle-介绍" class="headerlink" title="1.1 Oracle 介绍"></a>1.1 Oracle 介绍</h2><hr>
<h3 id="知识点：Oracle-数据库生态"><a href="#知识点：Oracle-数据库生态" class="headerlink" title="知识点：Oracle 数据库生态"></a>知识点：Oracle 数据库生态</h3><ol>
<li><strong>组件</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">* Grid</span><br><span class="line">  - kickrestart，高可用，数据库自动重启</span><br><span class="line">  - ASM，存储</span><br><span class="line"></span><br><span class="line">* DG，主从</span><br><span class="line"></span><br><span class="line">* Golden Gate，数据库同步</span><br><span class="line"></span><br><span class="line">* RAC，集群</span><br><span class="line"></span><br><span class="line">* EMCC，图形化管理界面</span><br><span class="line"></span><br><span class="line">* Database Valut，安全</span><br></pre></td></tr></table></figure></li>
<li><strong>实用工具 utility</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">* OUI</span><br><span class="line">  - runinstaller</span><br><span class="line">  - dbca</span><br><span class="line">  - dbua</span><br><span class="line">  - asmca</span><br><span class="line"></span><br><span class="line">* 网络</span><br><span class="line">  - lsnrctl</span><br><span class="line">  - netca</span><br><span class="line">  - netmgr</span><br><span class="line">  - tnsping</span><br><span class="line"></span><br><span class="line">* 备份恢复</span><br><span class="line">  - rman</span><br><span class="line">  - obtool    -- OSB</span><br><span class="line"></span><br><span class="line">* 客户端</span><br><span class="line">  - sqlplus</span><br><span class="line">  - sqldeveloper</span><br><span class="line">  - instant client</span><br><span class="line"></span><br><span class="line">* 数据迁移</span><br><span class="line">  - exp，imp</span><br><span class="line">  - datapump，expdp，impdp</span><br><span class="line">  - sqlldr</span><br><span class="line"></span><br><span class="line">* ASM</span><br><span class="line">  - crs_stat</span><br><span class="line">  - crs_ctl</span><br><span class="line">  - asmcmd</span><br><span class="line"></span><br><span class="line">* 集群</span><br><span class="line">  - srvctl</span><br><span class="line"></span><br><span class="line">* 报错</span><br><span class="line">  - oerr</span><br><span class="line">  - adrci</span><br><span class="line"></span><br><span class="line">* OEM</span><br><span class="line">  - emca</span><br><span class="line">  - emctl</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：Oracle-数据库版本号"><a href="#知识点：Oracle-数据库版本号" class="headerlink" title="知识点：Oracle 数据库版本号"></a>知识点：Oracle 数据库版本号</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">* 旧版本号规则</span><br><span class="line">  - 多年一发布</span><br><span class="line">  - 根据 Oracle 数据库的代数来决定，并跟一个代表主要功能的后缀</span><br><span class="line">    - 如 &#x27;g&#x27; 表示 &#x27;grid&#x27;</span><br><span class="line">    - 如 &#x27;c&#x27; 表示 &#x27;cloud&#x27;</span><br><span class="line"></span><br><span class="line">* 新版本号规则</span><br><span class="line">  - 从 201707 开始，从 18c 开始</span><br><span class="line">  - 每年发布一个年度发行版 Release，并定期发布季度更新</span><br><span class="line">  - 优点，更快的提供更多的新功能，避免大的版本升级对系统产生的风险</span><br></pre></td></tr></table></figure></li>
<li><strong>格式</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">* 格式</span><br><span class="line">  release.update.revision</span><br><span class="line"></span><br><span class="line">* release</span><br><span class="line">  - Yearly Release</span><br><span class="line">  - 表示发行年度，每年一发布</span><br><span class="line"></span><br><span class="line">* update</span><br><span class="line">  - Quarterly Release Update</span><br><span class="line">  - 表示季度更新 RU，每年 1/4/7/10 月发布</span><br><span class="line">  - 主要包含查询优化器相关 BUG 和安全漏洞的修复等</span><br><span class="line"></span><br><span class="line">* revision</span><br><span class="line">  - Release Update Revisions</span><br><span class="line">  - 表示季度更新修订 RUR</span><br><span class="line">  - 对每一个季度更新 RU，不固定的提供更新修订 RUR，主要是对 RU 的缺陷进行的修复，以及安全漏洞补丁等</span><br><span class="line"></span><br><span class="line">* 第 4 位</span><br><span class="line">* 第 5 位</span><br><span class="line">  - 第 4 位是 Oracle 数据库的增量版本，偶尔会用于 Oracle 云数据库中</span><br><span class="line">  - 第 5 位是保留位，预留给将来</span><br><span class="line">  - 对于大多数用户来说，只需要关注前 3 位</span><br><span class="line"></span><br><span class="line">* 维护期</span><br><span class="line">  - 每个 Release 发布后的至少两年内，都会提供 RU 的支持</span><br><span class="line">  - 每个 RU 会提供两个独立的 RUR 支持</span><br><span class="line">  - 每个 RUR 之间间隔 6 个月</span><br><span class="line">  - 因此每个年度 Release 至少会有 3 年的支持周期</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：Oracle-数据库功能演变"><a href="#知识点：Oracle-数据库功能演变" class="headerlink" title="知识点：Oracle 数据库功能演变"></a>知识点：Oracle 数据库功能演变</h3><ol>
<li><strong>Oracle 10G 之前</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">* XML Database</span><br><span class="line"></span><br><span class="line">* Data Guard</span><br><span class="line"></span><br><span class="line">* RAC</span><br><span class="line"></span><br><span class="line">* Flashback Query</span><br><span class="line"></span><br><span class="line">* Virtual Private Database</span><br><span class="line"></span><br><span class="line">* Built-in Java VM</span><br><span class="line"></span><br><span class="line">* Partitioning Support</span><br><span class="line"></span><br><span class="line">* Built-in Messaging</span><br><span class="line"></span><br><span class="line">* Object Relational Support</span><br><span class="line"></span><br><span class="line">* Multimedia Support</span><br></pre></td></tr></table></figure></li>
<li><strong>Oracle 10G</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">* Audit Vault</span><br><span class="line"></span><br><span class="line">* Database Vault</span><br><span class="line"></span><br><span class="line">* Secure Enterprise Search</span><br><span class="line"></span><br><span class="line">* Grid Computing</span><br><span class="line"></span><br><span class="line">* Automatic Storage Mgmt</span><br><span class="line"></span><br><span class="line">* Self Managing Database</span><br></pre></td></tr></table></figure></li>
<li><strong>Oracle 11G</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">* Oracle Grid Infrastructure</span><br><span class="line"></span><br><span class="line">* Real Application Testing</span><br><span class="line"></span><br><span class="line">* Automatic SQL Tuning</span><br><span class="line"></span><br><span class="line">* Fault Management</span><br></pre></td></tr></table></figure></li>
<li><strong>Oracle 12C</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">* Private Database Cloud</span><br><span class="line"></span><br><span class="line">* Oracle Data Redaction</span><br><span class="line"></span><br><span class="line">* Real Application Security</span><br><span class="line"></span><br><span class="line">* Information Lifecycle Management ( ILM )</span><br><span class="line"></span><br><span class="line">* Flex Clusters</span><br><span class="line"></span><br><span class="line">* Data Guard Far-Sync</span><br><span class="line"></span><br><span class="line">* Application Continuity</span><br><span class="line"></span><br><span class="line">* Lower Cost Migrations</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：Oracle-认证"><a href="#知识点：Oracle-认证" class="headerlink" title="知识点：Oracle 认证"></a>知识点：Oracle 认证</h3><ol>
<li><strong>OCP</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">* OCP 不涉及的内容</span><br><span class="line">  - 分区表 partitioned table</span><br><span class="line">  - 物化视图 materialized view</span><br><span class="line">  - 索引组织表 index organized table</span><br><span class="line">  - DIMENSION</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：DUAL-表"><a href="#知识点：DUAL-表" class="headerlink" title="知识点：DUAL 表"></a>知识点：DUAL 表</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - Oracle 所特用的 Dummy 表，用来进行一次性查询</span><br><span class="line">  - Mysql 中的一次性查询不需要使用 Dummy 表</span><br></pre></td></tr></table></figure></li>
<li><strong>范例</strong><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- Oracle</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">power</span>(<span class="number">2</span>,<span class="number">10</span>) <span class="keyword">FROM</span> DUAL ;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- Mysql</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">power</span>(<span class="number">2</span>,<span class="number">10</span>) ;</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h1 id="Chapter02-sqlplus"><a href="#Chapter02-sqlplus" class="headerlink" title="Chapter02 sqlplus"></a>Chapter02 sqlplus</h1><hr>
<h2 id="2-1-sqlplus-介绍"><a href="#2-1-sqlplus-介绍" class="headerlink" title="2.1 sqlplus 介绍"></a>2.1 sqlplus 介绍</h2><hr>
<h3 id="知识点：Oracle-客户端介绍"><a href="#知识点：Oracle-客户端介绍" class="headerlink" title="知识点：Oracle 客户端介绍"></a>知识点：Oracle 客户端介绍</h3><ol>
<li><strong>sqlplus</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - Oracle 的命令行客户端</span><br><span class="line">  - 是 Oracle 最基础的客户端工具</span><br></pre></td></tr></table></figure></li>
<li><strong>sqldeveloper</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - Oracle 官方提供的图形化客户端工具</span><br><span class="line"></span><br><span class="line">* 快捷键</span><br><span class="line">  Ctrl + F6、Ctrl + Shift + F6      &lt;== 切换文件，建议修改为 Ctrl + PageUp/PageDown</span><br><span class="line">  Ctrl + Enter                      &lt;== 执行一条语句</span><br><span class="line">  Ctrl + F7                         &lt;== 对语句进行格式化</span><br></pre></td></tr></table></figure></li>
<li><strong>sqlcl</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - Oracle 的新的命令行客户端，相比 sqlplus 增加了很多功能</span><br><span class="line">  - 支持所有的 sqlplus 指令</span><br><span class="line"></span><br><span class="line">* 额外支持一些内部指令</span><br><span class="line">  - DDL         查看某个对象的创建 DDL 语句</span><br><span class="line">  - INFO        查看某个对象的结构信息，包括注释</span><br><span class="line">  - info table  主键列会带上星号</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：sqlplus-介绍"><a href="#知识点：sqlplus-介绍" class="headerlink" title="知识点：sqlplus 介绍"></a>知识点：sqlplus 介绍</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">* 功能</span><br><span class="line">  - 创建到数据库的连接</span><br><span class="line">  - 执行 SQL 语句</span><br><span class="line">  - 执行 SQL 脚本</span><br><span class="line"></span><br><span class="line">* 相关目录</span><br><span class="line">  - $ORACLE_HOME/sqlplus  默认安装目录</span><br><span class="line">  - $ORACLE_HOME/bin      默认命令目录</span><br></pre></td></tr></table></figure></li>
<li><strong>相关环境变量</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">* ORACLE_BASE</span><br><span class="line">  - 可选</span><br><span class="line"></span><br><span class="line">* ORACLE_HOME</span><br><span class="line">  - 必须</span><br><span class="line">  - 确定 sqlplus 的安装位置</span><br><span class="line">  - 确定 sqlplus 的 message file 的位置</span><br><span class="line"></span><br><span class="line">* SID</span><br><span class="line">* ORACLE_SID</span><br><span class="line">  - 可选</span><br><span class="line">  - 指定进行本地连接时的目标数据库实例</span><br><span class="line">  - 仅在本地连接时需要使用，采用网络连接时不会用到</span><br><span class="line"></span><br><span class="line">* PATH</span><br><span class="line">  - 确定使用的 sqlplus 程序的位置</span><br><span class="line">  - 不同版本的 ORACLE DATABASE，sqlplus 的版本也不同</span><br><span class="line">  - 常用设置，PATH=$ORACLE_HOME/bin:PATH</span><br><span class="line"></span><br><span class="line">* ORACLE_PATH</span><br><span class="line">  - 可选</span><br><span class="line">  - 确定 sqlplus 搜索 SQL 脚本和用户配置文件的目录</span><br><span class="line">  - 冒号间隔多个路径，不包含其子路径</span><br><span class="line"></span><br><span class="line">* TNS_ADMIN</span><br><span class="line">  - 指定 tnsnames.ora 的位置</span><br><span class="line">  - 默认为 $ORACLE_HOME/network/admin</span><br><span class="line"></span><br><span class="line">* TWO_TASK</span><br><span class="line">  - UNIX 环境变量，指定默认的连接字符</span><br><span class="line">  - 设定后，可以使用 sqlplus user_name 的方式进行连接，其功能为 sqlplus user_name@TWO_TASK</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：sqlplus-安装"><a href="#知识点：sqlplus-安装" class="headerlink" title="知识点：sqlplus 安装"></a>知识点：sqlplus 安装</h3><ol>
<li><strong>InstantClient rpm 方式安装</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">* 下载 rpm 包</span><br><span class="line">  - instantclient-basic-linux.rpm</span><br><span class="line">  - instantclient-sqlplus-linux.rpm</span><br><span class="line"></span><br><span class="line">* yum 安装</span><br><span class="line">  - 会自动安装依赖 libaio.x86_64</span><br><span class="line"></span><br><span class="line">* 设置环境变量</span><br><span class="line">  - ll -d $(which sqlplus)，记录 sqlplus 的安装位置，如 /usr/lib/oracle/19.19/client64/bin</span><br><span class="line">  - export LD_LIBRARY_PATH=/usr/lib/oracle/19.19/client64/bin:$&#123;LD_LIBRARY_PATH&#125;</span><br><span class="line">  - export NLS_LANG=&#x27;simplified chinese_china.al32utf8&#x27;</span><br><span class="line"></span><br><span class="line">* 执行 sqlplus</span><br><span class="line">  - sqlplus /nolog</span><br></pre></td></tr></table></figure></li>
<li><strong>InstantClient zip 方式安装</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">* 下载 zip 包</span><br><span class="line">  - instantclient-basic-linux.zip</span><br><span class="line">  - instantclient-sqlplus-linux.zip</span><br><span class="line"></span><br><span class="line">* 安装依赖</span><br><span class="line">  - yum -y install libaio.x86_64</span><br><span class="line"></span><br><span class="line">* 解压</span><br><span class="line">  - 两个 zip 包解压到一起</span><br><span class="line">  - 例如，都在 /opt/Oracle 中解压，则都会解压到一个子目录 instantclient_XXXX 中</span><br><span class="line"></span><br><span class="line">* 配置环境变量</span><br><span class="line">  - 按照 zip 包的解压目录</span><br><span class="line">  - export ORACLE_HOME=/opt/Oracle/instantclient_XXXX</span><br><span class="line">  - export LD_LIBRARY_PATH=$ORACLE_HOME:$&#123;LD_LIBRARY_PATH&#125;</span><br><span class="line">  - export PATH=$PATH:$ORACLE_HOME</span><br><span class="line">  - export NLS_LANG=&#x27;simplified chinese_china.al32utf8&#x27;</span><br><span class="line"></span><br><span class="line">* 添加 tnsname</span><br><span class="line">  - vim $ORACLE_HOME/network/admin/tnsnames.ora</span><br><span class="line"></span><br><span class="line">* 执行 sqlplus</span><br><span class="line">  - sqlplus /nolog</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：sqlplus-显示中文"><a href="#知识点：sqlplus-显示中文" class="headerlink" title="知识点：sqlplus 显示中文"></a>知识点：sqlplus 显示中文</h3><ol>
<li><strong>修改 OS 环境变量</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">* export NLS_LANG=&#x27;simplified chinese_china.al32utf8&#x27;</span><br><span class="line"></span><br><span class="line">* export NLS_LANG=&#x27;simplified chinese_china.zhs16gbk&#x27;</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h2 id="2-2-sqlplus-建立连接"><a href="#2-2-sqlplus-建立连接" class="headerlink" title="2.2 sqlplus 建立连接"></a>2.2 sqlplus 建立连接</h2><hr>
<h3 id="知识点：sqlplus-指令"><a href="#知识点：sqlplus-指令" class="headerlink" title="知识点：sqlplus 指令"></a>知识点：sqlplus 指令</h3><ol>
<li><strong>格式</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">* 格式</span><br><span class="line">  sqlplus [Options] [Logon | /NOLOG] [Start]</span><br><span class="line"></span><br><span class="line">* NOLOG</span><br><span class="line">  - 只启动 sqlplus 环境，不进行连接</span><br><span class="line">  - 之后可以通过 connect 命令连接到数据库</span><br><span class="line"></span><br><span class="line">* Options</span><br><span class="line">  -H、-HELP            显示 sqlplus 的帮助</span><br><span class="line">  -V、-VERSION         显示 sqlplus 的版本</span><br><span class="line">  -S、-SILENT          静默模式</span><br><span class="line">  -F、–Fast            快速模式</span><br><span class="line">  -R、-RESTRICT 1|2|3  限制模式</span><br><span class="line">  -L、-LOGON           只登陆一次，一次登陆失败则直接退出 sqlplus</span><br><span class="line">  -C、-COMPATIBILITY &#123;x.y.z&#125;     兼容模式，使用指定版本的 sqlplus</span><br><span class="line">  -M、-MARKUP Markup_Option      指定 markup 格式，Markup_Option 要用双引号括起来，详细见 SET MARKUP</span><br></pre></td></tr></table></figure></li>
<li><strong>Logon</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 指定需要连接的目标数据库</span><br><span class="line">  - 指定创建连接使用的身份和角色</span><br><span class="line"></span><br><span class="line">* 格式</span><br><span class="line">  UserName[/PassWord]@Connect_Identifier [AS SYSASM|SYSBACKUP|SYSDBA|SYSDG|SYSOPER|SYSRAC|SYSKM] [edition=Value]</span><br><span class="line"></span><br><span class="line">* UserName/PassWord</span><br><span class="line">  - 指定用户名和密码</span><br><span class="line">  - 省略密码，则需要之后在交互界面手动输入密码</span><br><span class="line"></span><br><span class="line">* AS SYSASM|SYSBACKUP|SYSDBA|SYSDG|SYSOPER|SYSRAC|SYSKM</span><br><span class="line">  - 指定用户的角色</span><br><span class="line"></span><br><span class="line">* edition=Value</span><br><span class="line">  - 指定 Oracle Database 的版本</span><br></pre></td></tr></table></figure></li>
<li><strong>Connect_Identifier</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 连接字符串</span><br><span class="line">  - 用于指定需要登录的目标数据库实例</span><br><span class="line">  - 省略连接字符串，则表示自动使用本地连接方式</span><br><span class="line">  - Connect_Identifier 的变化情况</span><br><span class="line">    - sqlplus 登录数据库，会记录 Connect_Identifier</span><br><span class="line">    - CONNECT 登录数据库，会记录 Connect_Identifier</span><br><span class="line">    - ALTER SESSION SET CONTAINER，不会改变 Connect_Identifier</span><br><span class="line"></span><br><span class="line">* 格式</span><br><span class="line">  Tns_Entry                     使用 tns_name.ora 中保存的 tns_entry</span><br><span class="line">  Host:Port/Service_Name        使用网络+端口的方式访问数据库</span><br></pre></td></tr></table></figure></li>
<li><strong>Start</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 指定 sqlplus 连接建立成功后，执行的脚本</span><br><span class="line">  - 连接到数据库时，先执行脚本，再打开交互界面</span><br><span class="line">  - 只能添加一个脚本文件，但可以通过父脚本子脚本的方式指定多个脚本文件</span><br><span class="line"></span><br><span class="line">* 格式</span><br><span class="line">  @File_Name [Args]</span><br><span class="line"></span><br><span class="line">* File_Name</span><br><span class="line">  - 指定使用的脚本文件</span><br><span class="line">  - 可以是 Url 方式的文件名</span><br><span class="line"></span><br><span class="line">* Args</span><br><span class="line">  - 为脚本指定参数</span><br><span class="line">  - 在脚本内，通过 &amp;1 &amp;2 的方式来接收命令行的参数</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：sqlplus-本地连接"><a href="#知识点：sqlplus-本地连接" class="headerlink" title="知识点：sqlplus 本地连接"></a>知识点：sqlplus 本地连接</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 直接连接到本机上运行的数据库</span><br><span class="line">  - 采用 IPC 方式进行通信，不通过网络</span><br><span class="line"></span><br><span class="line">* 前提条件</span><br><span class="line">  - ORACLE_SID 变量已经设定好，指向待连接的数据库</span><br><span class="line">  - 如果需要以 SYSDBA 连接到数据库中，则当前用户需要在 dba 组中，dba 组在安装数据库时指定，默认就叫 dba</span><br></pre></td></tr></table></figure></li>
<li><strong>范例</strong><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sqlplus UserName/PassWord</span><br><span class="line"></span><br><span class="line">sqlplus / as sysdba</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：sqlplus-的连接模式"><a href="#知识点：sqlplus-的连接模式" class="headerlink" title="知识点：sqlplus 的连接模式"></a>知识点：sqlplus 的连接模式</h3><ol>
<li><strong>快速模式</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - &quot;-F&quot; 选项</span><br><span class="line">  - 快速模式会提高性能，主要是修改了一些 sqlplus 的默认设置</span><br><span class="line">    - ARRAYSIZE = 100</span><br><span class="line">    - LOBPREFETCH = 16384</span><br><span class="line">    - PAGESIZE = 50000</span><br><span class="line">    - ROWPREFETCH = 2</span><br><span class="line">    - STATEMENTCACHE = 20</span><br></pre></td></tr></table></figure></li>
<li><strong>限制模式</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - &quot;-R&quot; 选项</span><br><span class="line">  - 限制模式，会禁用一些可以和操作系统进行交互的 sqlplus 命令</span><br><span class="line">  - 限制模式有三个级别，1 级禁用的命令最少，3 级禁用的命令最多</span><br><span class="line">    - 1 级，EDIT，HOST</span><br><span class="line">    - 2 级，EDIT，HOST，SAVE，SPOOL，STORE</span><br><span class="line">    - 3 级，EDIT，HOST，SAVE，SPOOL，STORE，GET，START，@，@@</span><br></pre></td></tr></table></figure></li>
<li><strong>静默模式</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - &quot;-S&quot; 选项</span><br><span class="line">  - 会隐藏所有的 sqlplus 提示</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：CONNECT-指令"><a href="#知识点：CONNECT-指令" class="headerlink" title="知识点：CONNECT 指令"></a>知识点：CONNECT 指令</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 连接或切换数据库</span><br></pre></td></tr></table></figure></li>
<li><strong>格式</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CONNECT Logon [Role] [edition=Value]</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">* Logon</span><br><span class="line">  - 指定要连接的数据库和用户</span><br><span class="line">  - 格式：UserName[/PassWord]@Connect_Identifier</span><br><span class="line"></span><br><span class="line">* Role</span><br><span class="line">  - 指定连接使用的角色</span><br><span class="line">  - 格式：AS SYSASM|SYSBACKUP|SYSDBA|SYSDG|SYSOPER|SYSRAC|SYSKM</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：DISCONNECT-指令"><a href="#知识点：DISCONNECT-指令" class="headerlink" title="知识点：DISCONNECT 指令"></a>知识点：DISCONNECT 指令</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 断开连接，但不退出 sqlplus 环境</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h2 id="2-3-sqlplus-配置"><a href="#2-3-sqlplus-配置" class="headerlink" title="2.3 sqlplus 配置"></a>2.3 sqlplus 配置</h2><hr>
<h3 id="知识点：sqlplus-配置"><a href="#知识点：sqlplus-配置" class="headerlink" title="知识点：sqlplus 配置"></a>知识点：sqlplus 配置</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - sqlplus 的配置项，也称为配置参数、Set Variables、System Variabs 等</span><br><span class="line">  - 主要用来让 sqlplus 开启不同的功能，或修改 sqlplus 的显示格式</span><br><span class="line">  - sqlplus 的配置是基于 session 的，修改 sqlplus 的配置不会影响到数据库</span><br><span class="line">  - sqlplus 配置的语句常嵌入在 SQL 脚本中，用来完善脚本的功能</span><br></pre></td></tr></table></figure></li>
<li><strong>sqlplus 常用配置</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">* SHOWMODE</span><br><span class="line">  - 使用 SET 命令修改配置参数时，是否打印旧值和新值</span><br><span class="line">  - 格式：SET SHOWMODE ON|OFF</span><br><span class="line"></span><br><span class="line">* SQLTERMINATOR</span><br><span class="line">  - 设置 SQL 语句的结束字符</span><br><span class="line">  - 默认为分号 semicolon</span><br><span class="line">  - 格式：SET SQLTERMINATOR &#123;;|c|ON|OFF&#125;</span><br><span class="line"></span><br><span class="line">* SQLBLANKLINES</span><br><span class="line">  - 设置 SQL 语句和脚本中是否允许出现空行</span><br><span class="line">  - ON 表示接受空行，但同时 sqlplus 失去以空行结束语句的功能</span><br><span class="line">  - 格式：SET SQLBLANKLINES ON|OFF</span><br><span class="line"></span><br><span class="line">* SQLPROMPT</span><br><span class="line">  - 设置 sqlplus 的提示符 Prompt</span><br><span class="line">  - 格式：SET SQLPROMPT Text</span><br><span class="line">  - Text</span><br><span class="line">    - 需要用单/双引号括起来</span><br><span class="line">    - 可以使用 8 个预定义变量或者自定义变量</span><br><span class="line">    - 如：SET SQLPROMPT _USER&#x27;@&#x27;_CONNECT_IDENTIFIER</span><br><span class="line"></span><br><span class="line">* TIME</span><br><span class="line">  - 设置是否在 sqlplus 的提示符 Prompt 前显示时间</span><br><span class="line">  - 格式：SET TIME ON|OFF</span><br><span class="line"></span><br><span class="line">* TIMING</span><br><span class="line">  - 设置 sqlplus 是否自动记录 SQL statement 的执行时间</span><br><span class="line">  - 比使用 TIMING 指令创建 timer 方便</span><br><span class="line">  - 格式：SET TIMING ON|OFF</span><br><span class="line"></span><br><span class="line">* HISTORY</span><br><span class="line">  - 开启或关闭 sqlplus 的历史命令功能，并设置历史命令的容量</span><br><span class="line">  - 格式：SET HISTORY ON|OFF|Number</span><br><span class="line"></span><br><span class="line">* VERIFY</span><br><span class="line">  - 设置 sqlplus 是否显示对替换变量的替换过程</span><br><span class="line">  - 格式：SET VERIFY ON|OFF</span><br></pre></td></tr></table></figure></li>
<li><strong>PL&#x2F;SQL 常用配置</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">* BLOCKTERMINATOR</span><br><span class="line">  - 设置 PL/SQL 块的结束字符</span><br><span class="line">  - 格式：SET BLOCKTERMINATOR &#123;.|Char|ON|OFF&#125;</span><br><span class="line"></span><br><span class="line">* SERVEROUTPUT</span><br><span class="line">  - 设置是否显示 PL/SQL 的输出过程 DBMS_OUTPUT.PUT_LINE 的结果</span><br><span class="line">  - 格式：SET SERVEROUTPUT &#123;ON|OFF&#125; [SIZE &#123;Number|UNL[IMITED]&#125;] [FOR[MAT] &#123;WRA[PPED] | WOR[D_WRAPPED] | TRU[NCATED]&#125;]</span><br></pre></td></tr></table></figure></li>
<li><strong>AUTOTEACE 配置</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 是否开启对 SQL 语句的自动追踪</span><br><span class="line"></span><br><span class="line">* 前提</span><br><span class="line">  - 提前建好一个 PLAN_TABLE 表，利用脚本 $ORACLE_HOME/rdbms/admin/utlxplan.sql 创建 PLAN_TABLE 表</span><br><span class="line">  - 拥有 PLUSTRACE 角色，DBA 利用脚本 $ORACLE_HOME/sqlplus/admin/plustrce.sql 创建 PLUSTRACE 角色</span><br><span class="line"></span><br><span class="line">* 格式</span><br><span class="line">  SET AUTOTRACE &#123;ON|OFF|TRACEONLY&#125; [EXPLAIN] [STATISTICS]</span><br><span class="line"></span><br><span class="line">* SET AUTOTRACE ON</span><br><span class="line">  - SET AUTOTRACE ON EXPLAIN        &lt;== 显示 query execution path 和 query result</span><br><span class="line">  - SET AUTOTRACE ON STATISTICS     &lt;== 显示 SQL statement statistics 和 query result</span><br><span class="line">  - SET AUTOTRACE ON                &lt;== 相当于 SET AUTOTRACE ON EXPLAIN STATIXTICS</span><br><span class="line"></span><br><span class="line">* SET AUTOTRACE TRACEONLY</span><br><span class="line">  - SET AUTOTRACE TRACEONLY EXPLAIN       &lt;== 显示 query execution path，不执行查询和 I/O</span><br><span class="line">  - SET AUTOTRACE TRACEONLY STATISTICS    &lt;== 显示 SQL statement statistics 两部分内容，实际执行了查询和 I/O</span><br><span class="line">  - SET AUTOTRACE TRACEONLY               &lt;== 相当于 SET AUTOTRACE EXPLAIN STATISTICS</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：sqlplus-配置文件"><a href="#知识点：sqlplus-配置文件" class="headerlink" title="知识点：sqlplus 配置文件"></a>知识点：sqlplus 配置文件</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 配置文件 profile，本质上是一个 SQL 脚本</span><br><span class="line">  - sqlplus 在启动时，会自动读取配置文件的内容，来初始化执行环境</span><br><span class="line"></span><br><span class="line">* 配置文件的生效时刻</span><br><span class="line">  - sqlplus 建立连接</span><br><span class="line">  - sqlplus nolog</span><br><span class="line">  - connect 建立连接</span><br><span class="line">  - alter session set container 不会使用 sqlplus 用户配置文件</span><br><span class="line"></span><br><span class="line">* 支持的内容</span><br><span class="line">  - sqlplus SET 命令</span><br><span class="line">  - sqlplus 命令</span><br><span class="line">  - SQL 语句</span><br><span class="line">  - PL/SQL blocks</span><br></pre></td></tr></table></figure></li>
<li><strong>两个配置文件</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">* site profile</span><br><span class="line">  - sqlplus 的全局用户配置文件</span><br><span class="line">  - 当有用户使用 sqlplus 进行建立连接时，会自动执行 site file 中的内容</span><br><span class="line">  - 默认为 $ORACLE_HOME/sqlplus/admin/glogin.sql</span><br><span class="line">  - 当安装 sqlplus 时，会自动创建一个空的 site file</span><br><span class="line"></span><br><span class="line">* user profile</span><br><span class="line">  - sqlplus 的用户个性化配置文件</span><br><span class="line">  - 在用户进行建立连接时，先执行 site file，再执行 user file</span><br><span class="line">  - 默认为 $ORACLE_PATH/login.sql</span><br><span class="line">  - 如果没有设置 $ORACLE_PATH，则 login.sql 不生效</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：SET-指令"><a href="#知识点：SET-指令" class="headerlink" title="知识点：SET 指令"></a>知识点：SET 指令</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 修改 sqlplus 的某个配置参数</span><br><span class="line"></span><br><span class="line">* 格式</span><br><span class="line">  SET Parameter_Name Parameter_Value ;</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：STORE-指令"><a href="#知识点：STORE-指令" class="headerlink" title="知识点：STORE 指令"></a>知识点：STORE 指令</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 将当前的 sqlplus 设置保存到离线文件</span><br><span class="line">  - 默认扩展名为 sql</span><br><span class="line">  - 保存的文件可以直接作为 SQL 脚本执行，来设置 sqlplus 环境</span><br><span class="line">  - 保存的内容的格式为：SET Parameter_Name Parameter_Value</span><br><span class="line"></span><br><span class="line">* 格式</span><br><span class="line">  STORE SET File_Name [CREATE|REPLACE|APPEND]</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：CLEAR-指令"><a href="#知识点：CLEAR-指令" class="headerlink" title="知识点：CLEAR 指令"></a>知识点：CLEAR 指令</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 清除 sqlplus 设置</span><br><span class="line">  - 清除屏幕</span><br><span class="line"></span><br><span class="line">* 格式</span><br><span class="line">  CLEAR SCREEN        &lt;== 清屏</span><br><span class="line">  CLEAR SQL           &lt;== 清除 sql buffer 的内容</span><br><span class="line">  CLEAR BUFFER        &lt;== 清除 sql buffer 的内容，与 CLEAR SQL 的区别在于 multiple buffers</span><br><span class="line">  CLEAR BREAKS        &lt;== 清除所有的 break 设置</span><br><span class="line">  CLEAR COLUMNS       &lt;== 清除所有的 column 设置</span><br><span class="line">  CLEAR COMPUTES      &lt;== 清除所有的 compute 设置</span><br><span class="line">  CLEAR TIMING        &lt;== 清除所有的 timer</span><br><span class="line">  CLEAR               &lt;== 清除以上的所有设置</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：SHOW-指令"><a href="#知识点：SHOW-指令" class="headerlink" title="知识点：SHOW 指令"></a>知识点：SHOW 指令</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 查看 sqlplus 的配置参数</span><br><span class="line">  - 查看数据库信息</span><br><span class="line">  - 查看错误信息</span><br></pre></td></tr></table></figure></li>
<li><strong>查看 sqlplus 配置参数</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SHOW ALL              查看所有配置参数</span><br><span class="line">SHOW Parameter_Name   查看某一个配置参数</span><br></pre></td></tr></table></figure></li>
<li><strong>查看数据库信息</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">SHOW PARAMETER Parameter_Name</span><br><span class="line">  - 查看某一个数据库参数的值</span><br><span class="line">  - 可以只给出参数名的一部分，sqlplus 会自动打印所有合适的参数</span><br><span class="line"></span><br><span class="line">SHOW EDITION          查看数据库版本</span><br><span class="line"></span><br><span class="line">SHOW USER             查看当前的用户</span><br><span class="line"></span><br><span class="line">SHOW PDBS             查看所有的 PDB</span><br><span class="line">SHOW CON_ID           查看当前所在的容器的 ID</span><br><span class="line">SHOW CON_NAME         查看当前所在的容器的名字</span><br><span class="line"></span><br><span class="line">SHOW SGA              查看 SGA 中重要组件的大小</span><br><span class="line"></span><br><span class="line">SHOW RECYCLEBIN       查看回收站信息</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
<li><strong>查看错误信息</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">SHOW SQLCODE          查看最近一次 SQL 语句的返回值代码</span><br><span class="line"></span><br><span class="line">SHOW ERRORS [Type [Schema.]Name]</span><br><span class="line">  - 查看 PL/SQL 存储过程的编译错误</span><br><span class="line">  - 如果省略对象名 Schema.Name ，则显示所有存储过程的编译错误</span><br><span class="line">  - 如果省略类型名 Type，则显示所有类型的存储过程的编译错误</span><br><span class="line">  - Type 支持的值：</span><br><span class="line">    - ANALYTIC VIEW</span><br><span class="line">    - ATTRIBUTE DIMENSION</span><br><span class="line">    - HIERARCHY</span><br><span class="line">    - FUNCTION</span><br><span class="line">    - PROCEDURE</span><br><span class="line">    - PACKAGE</span><br><span class="line">    - PACKAGE BODY</span><br><span class="line">    - TRIGGER</span><br><span class="line">    - VIEW</span><br><span class="line">    - TYPE</span><br><span class="line">    - TYPE BODY</span><br><span class="line">    - DIMENSION</span><br><span class="line">    - JAVA CLASS</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h2 id="2-4-sqlplus-运行-SQL"><a href="#2-4-sqlplus-运行-SQL" class="headerlink" title="2.4 sqlplus 运行 SQL"></a>2.4 sqlplus 运行 SQL</h2><hr>
<h3 id="知识点：sqlplus-运行-SQL"><a href="#知识点：sqlplus-运行-SQL" class="headerlink" title="知识点：sqlplus 运行 SQL"></a>知识点：sqlplus 运行 SQL</h3><ol>
<li><strong>执行 SQL 语句</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">* 语句的结束</span><br><span class="line">  - 空行</span><br><span class="line">  - 分号</span><br><span class="line"></span><br><span class="line">* 中断 SQL 语句的运行</span><br><span class="line">  - 按下系统的中断字符 cancel，即可结束 SQL 语句的运行，通常是 ctrl + C</span><br><span class="line">  - 如果通过 spool 输出到打印机，则不会结束打印机的工作</span><br></pre></td></tr></table></figure></li>
<li><strong>执行 SQL 脚本</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">* sqlplus 搜索 SQL 脚本的步骤</span><br><span class="line">  - 第一步，ORACLE_PATH</span><br><span class="line">  - 第二步，current working directory</span><br><span class="line">  - 第三步，SQLPATH</span><br><span class="line">  - 如果指定的绝对路径，则 sqlplus 直接执行 SQL 脚本</span><br><span class="line"></span><br><span class="line">* 替换格式 &#x27;?&#x27;</span><br><span class="line">  - 指向 ORACLE_HOME 所代表的目录</span><br><span class="line">  - 主要用于执行由 Oracle 提供的脚本</span><br><span class="line">  - 可以放在单引号中</span><br><span class="line"></span><br><span class="line">* 脚本的环境</span><br><span class="line">  - sqlplus 直接运行 SQL 脚本，运行环境为默认的 sqlplus 配置</span><br><span class="line">  - sqlplus 交互界面运行 SQL 脚本，运行环境会继承当时的 sqlplus 配置</span><br><span class="line">    - 在交互界面中，如果 SQL 脚本运行时修改了 sqlplus 配置，则脚本结束后，修改的配置会依然保留</span><br><span class="line">    - 在交互界面中，脚本中的 EXIT or QUIT 指令会退出 SQLPLUS 而不是停止脚本的执行</span><br></pre></td></tr></table></figure></li>
<li><strong>静默脚本</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 正常情况下使用 sqlplus 执行语句或脚本，会打印 sqlplus 自己的提示信息</span><br><span class="line">  - 通过静默脚本的方式，打印的信息直接是 SQL 脚本的结果</span><br><span class="line">  - 常用应用场景：创建 csv 文件</span><br><span class="line"></span><br><span class="line">* 执行方式</span><br><span class="line">  sqlplus -s nolog @SlienctScript.sql</span><br><span class="line"></span><br><span class="line">* SlienctScript.sql 的内容</span><br><span class="line">  - CONNECT 指令，连接到某个数据库</span><br><span class="line">  - SET ECHO，SET SPOOL 等配置</span><br><span class="line">  - 各种 SQL 语句</span><br><span class="line">  - EXIT 退出 sqlplus 环境</span><br></pre></td></tr></table></figure></li>
<li><strong>相关配置</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">* SET SUFFIX</span><br><span class="line">  - 设定默认的脚本文件扩展名</span><br><span class="line">  - 只在省略了扩展名时生效，当脚本文件指定了扩展名则按照指定的扩展名搜索脚本</span><br><span class="line">  - 格式：SET SUFFIX &#123;SQL | TXT | Text&#125;</span><br><span class="line"></span><br><span class="line">* SET ECHO</span><br><span class="line">  - 设置在执行 SQL 脚本时，是否显示脚本的内容</span><br><span class="line">  - 格式：SET ECHO &#123;ON|OFF&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：START-指令"><a href="#知识点：START-指令" class="headerlink" title="知识点：START 指令"></a>知识点：START 指令</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 运行 SQL 脚本</span><br><span class="line">  - 如果文件未指定扩展名，则默认采用 &#x27;.sql&#x27; 作为扩展名</span><br><span class="line">  - 支持运行远程文件，如 ftp 和 http，但不支持 https</span><br><span class="line">    - HTTP://machine_name.domain:port/absolute_path</span><br><span class="line">    - FTP://machine_name.domain:port/absolute_path</span><br></pre></td></tr></table></figure></li>
<li><strong>格式</strong><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">START</span> Relative_Path</span><br><span class="line"></span><br><span class="line"><span class="keyword">START</span> Absolute_Path</span><br><span class="line"></span><br><span class="line"><span class="keyword">START</span> Url</span><br><span class="line"></span><br><span class="line"><span class="keyword">START</span> File_Name Arg1, Arg2</span><br></pre></td></tr></table></figure></li>
<li><strong>替换格式</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">* START 指令有两个替换格式，&#x27;@&#x27; 和 &#x27;@@&#x27;</span><br><span class="line">  - START 指令与 @ 的功能完全相同</span><br><span class="line">  - 如果 sqlplus 中的 START 指令被禁用，则 @ 和 @@ 也会被禁用</span><br><span class="line"></span><br><span class="line">* &#x27;@&#x27; 和 &#x27;@@&#x27; 的区别</span><br><span class="line">  - @ 和 @@ 只有一个区别，当嵌入在脚本中，来继续引用其他脚本时，并且 File_Name 为 Relative_Name</span><br><span class="line">  - @ 的搜索路径为 current working directory</span><br><span class="line">  - @@ 的搜索路径为父脚本的存放路径</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：替换变量"><a href="#知识点：替换变量" class="headerlink" title="知识点：替换变量"></a>知识点：替换变量</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 替换变量 Substitution Variables</span><br><span class="line">  - 相当于 SQL 语句的形参，在 SQL 语句中充当占位符，实际执行 SQL 语句时将实参值填充到替换变量的位置</span><br><span class="line">  - 不区分大小写</span><br><span class="line">  - 优点</span><br><span class="line">    - 替换变量可以增加 SELECT 语句的灵活性</span><br><span class="line">    - 替换变量可以节省 SQL 语句的解析时间，使不同的 SQL 语句使用相同的执行计划</span><br><span class="line"></span><br><span class="line">* 位置参数形式的替换变量</span><br><span class="line">  - &amp;1、&amp;2，依次类推</span><br><span class="line">  - 在执行脚本时，sqlplus 会按位置将参数值会传递给相应的替换变量</span><br><span class="line">  - 范例：</span><br><span class="line">    START 1.sql Arg1 Arg_2</span><br><span class="line">    Arg1 的值传递给 &amp;1</span><br><span class="line">    Arg2 的值传递给 &amp;2，依次类推</span><br><span class="line"></span><br><span class="line">* 可以使用替换变量的位置</span><br><span class="line">  - WHERE</span><br><span class="line">  - ORDER BY</span><br><span class="line">  - ColumnExpressions</span><br><span class="line">  - TableNames</span><br><span class="line">  - Entire SELECT statements</span><br><span class="line"></span><br><span class="line">* 不能使用替换变量的位置</span><br><span class="line">  - sqlplus 的各种 buffer editing 命令中，如 APPEND，CHANGE，DEL，INPUT</span><br></pre></td></tr></table></figure></li>
<li><strong>引用替换变量</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 引用替换变量有两种形式，&quot;&amp;&quot; 和 &quot;&amp;&amp;&quot;</span><br><span class="line"></span><br><span class="line">* &quot;&amp;&quot; single-ampersand</span><br><span class="line">  - 变量的值只使用一次，用完便扔掉，不保存变量的值</span><br><span class="line">  - 即使是重复的变量，每次也都要重新输入</span><br><span class="line"></span><br><span class="line">* &quot;&amp;&amp;&quot; double-ampersand</span><br><span class="line">  - 以 session 为基础，保存变量的值</span><br><span class="line">  - 重复的变量只需要输入一次，可以重用，包括语句内重用和多个 SQL 语句重用，下一条 SQL 语句可以直接引用变量的值</span><br><span class="line">  - sqlplus 会自动对替换变量执行 DEFINE 指令</span><br><span class="line">  - 由于 SQL 语句是从后向前解析，由下向上解析，所以 &amp;&amp; 方式的替换变量会以最后一个的变量值为准</span><br><span class="line">  - 通常与 ACCEPT 命令一起使用</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">* 普通格式</span><br><span class="line">  &amp;Variable          引用变量的值</span><br><span class="line"></span><br><span class="line">* 带 &quot;.&quot; 的格式</span><br><span class="line">  &amp;Variable.Value    引用变量的值，并与 Value 拼接在一起组成一个新的值，&quot;.&quot; 在替换后会移除</span><br><span class="line">  Value.&amp;Variable    引用变量的值，并与 Value 拼接在一起组成一个新的值，&quot;.&quot; 在替换后会保留，Value 在整数部分，Variable 在小数部分</span><br><span class="line">  &amp;Variable..Value   引用变量的值，并与 Value 拼接在一起组成一个新的值，&quot;..&quot; 在替换后会变为 &quot;.&quot;，Variable 在整数部分，value 在小数部分</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">* 对字符型替换变量的两种引用方式</span><br><span class="line">  - &amp;var      将 var 的值，作为字面量，加入到 SQL statement 中</span><br><span class="line">  - &#x27;&amp;var&#x27;    将 var 的值，作为字符串，加入到 SQL statement 中</span><br></pre></td></tr></table></figure></li>
<li><strong>预定义的替换变量</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - sqlplus 默认提供了 8 个预定义替换变量 Predefined Variables</span><br><span class="line"></span><br><span class="line">* _CONNECT_IDENTIFIER</span><br><span class="line">  - 记录了 Connect Identifier</span><br><span class="line"></span><br><span class="line">* _DATE</span><br><span class="line">  - 记录了当前日期，数据类型为 DATE 型</span><br><span class="line">  - 对其赋空字符串表示恢复原始功能，如 DEFINE _date=&#x27;&#x27;</span><br><span class="line"></span><br><span class="line">* _USER</span><br><span class="line">  - 记录了建立连接的 User_Name</span><br><span class="line"></span><br><span class="line">* _PRIVILEGE</span><br><span class="line">  - 记录了当前连接的 database administrator level privileges</span><br><span class="line">  - 空表示普通用户权限</span><br><span class="line">  - 值为 SYSASM、SYSBACKUP、SYSDBA、SYSDG、SYSOPER、SYSRAC 中的一个</span><br><span class="line"></span><br><span class="line">* _O_VERSION</span><br><span class="line">  - 记录了 Oracle 的版本</span><br><span class="line"></span><br><span class="line">* _O_RELEASE</span><br><span class="line">  - 记录了 Oracle 的 release number</span><br><span class="line"></span><br><span class="line">* _SQLPLUS_RELEASE</span><br><span class="line">  - 记录了 sqlplus 的 release number</span><br><span class="line"></span><br><span class="line">* _EDITOR</span><br><span class="line">  - 记录了使用的 edit 编辑器</span><br></pre></td></tr></table></figure></li>
<li><strong>相关配置参数</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">* SET VERIFY</span><br><span class="line"></span><br><span class="line">* SET CONCAT</span><br><span class="line">  - 定义值与变量名之间的分隔符</span><br><span class="line">  - 默认为 &quot;.&quot; period，hex 2e</span><br><span class="line"></span><br><span class="line">* SET DEFINE</span><br><span class="line">  - 定义引用变量的字符 substitution character</span><br><span class="line">  - 默认为 &quot;&amp;&quot; ampersand，hex 26</span><br><span class="line"></span><br><span class="line">* SET ESCAPE</span><br><span class="line">  - 定义跳脱字符</span><br><span class="line"></span><br><span class="line">* SET NUMFORMAT</span><br><span class="line"></span><br><span class="line">* SET NUMWIDTH</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：DEFINE-指令"><a href="#知识点：DEFINE-指令" class="headerlink" title="知识点：DEFINE 指令"></a>知识点：DEFINE 指令</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 显式的定义替换变量，或为一个已经存在的替换变量赋新值</span><br><span class="line">  - 使用 DEFINE 指令必须指定变量值 Value</span><br><span class="line">  - DEFINE 命令定义的替换变量，保存在 PGA 中，可以重用</span><br><span class="line">  - DEFINE 命令定义的替换变量，不论哪种引用方式，&amp; 或 &amp;&amp;，都不会提示用户输入数值</span><br><span class="line"></span><br><span class="line">* 格式</span><br><span class="line">  DEFINE Variable = Value</span><br><span class="line">  DEFINE</span><br><span class="line">    - 查看当前环境中所有已存在的替换变量</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：UNDEFINE-指令"><a href="#知识点：UNDEFINE-指令" class="headerlink" title="知识点：UNDEFINE 指令"></a>知识点：UNDEFINE 指令</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 删除当前环境中定义的替换变量</span><br><span class="line"></span><br><span class="line">* 格式</span><br><span class="line">  UNDEFINE Variable</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：ACCEPT-指令"><a href="#知识点：ACCEPT-指令" class="headerlink" title="知识点：ACCEPT 指令"></a>知识点：ACCEPT 指令</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 接收用户的输入并储存在替换变量中</span><br></pre></td></tr></table></figure></li>
<li><strong>格式</strong><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ACCEPT Variable Type FORMAT Format_Model <span class="keyword">DEFAULT</span> Default_Value [PROMPT Text]<span class="operator">|</span>[NOPROMPT] [HIDE]</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">* Type</span><br><span class="line">  - 指定变量的类型，如果类型不符合，则返回错误</span><br><span class="line">  - 可选值：NUMBER、CHAR、DATE、BINARY_FLOAT、BINARY_DOUBLE</span><br><span class="line">  - CHAR 型最大为 240 字节，如果使用了 multi-byte character set，可能一个字符会占用多个字节</span><br><span class="line"></span><br><span class="line">* FORMAT Format_Model</span><br><span class="line">  - 指定识别输入的 Format_Model，如字符型的 a90，以及数字型，日期型</span><br><span class="line"></span><br><span class="line">* DEFAULT Default_Value</span><br><span class="line">  - 指定默认值</span><br><span class="line">  - 如果没有输入，则储存 Default_Value</span><br><span class="line"></span><br><span class="line">* PROMPT Text|NOPROMPT</span><br><span class="line">  - 指定提示符</span><br><span class="line"></span><br><span class="line">* HIDE</span><br><span class="line">  - 不显示用户输入的值</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h2 id="2-5-sqlplus-报告"><a href="#2-5-sqlplus-报告" class="headerlink" title="2.5 sqlplus 报告"></a>2.5 sqlplus 报告</h2><hr>
<h3 id="知识点：sqlplus-报告"><a href="#知识点：sqlplus-报告" class="headerlink" title="知识点：sqlplus 报告"></a>知识点：sqlplus 报告</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 在 sqlplus 中，将一次 SELECT 的查询结果，称为 sqlplus Report，或 SELECT Report</span><br><span class="line"></span><br><span class="line">* Report 的格式</span><br><span class="line">  - 报告头 Report Header</span><br><span class="line">  - 内容 Pages</span><br><span class="line">    - Blank Lines           空行，由 NEWPAGE 参数控制</span><br><span class="line">    - Ttitle(Top Title)     页标题</span><br><span class="line">    - Column_Headings       列标题</span><br><span class="line">    - Query Result          查询结果</span><br><span class="line">    - Btitle(Bottom Title)  页尾</span><br><span class="line">  - 报告尾 Report Footer</span><br><span class="line"></span><br><span class="line">* 不属于 Report 的内容</span><br><span class="line">  - feedback</span><br><span class="line">  - Elapsed time</span><br></pre></td></tr></table></figure></li>
<li><strong>sqlplus 报告相关配置</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">* COLSEP</span><br><span class="line">  - 设定列分隔符，默认为 a single space</span><br><span class="line">  - 格式：SET COLSEP Text</span><br><span class="line"></span><br><span class="line">* HEADSEP</span><br><span class="line">  - 设置列标题的换行符，默认为 ascii hex 7c，管道符</span><br><span class="line">  - 格式：SET HEADSEP &#123; &#x27;|&#x27; | Char | ON | OFF&#125;</span><br><span class="line"></span><br><span class="line">* HEADIND</span><br><span class="line">  - 设置 sql report 中是否显示列标题</span><br><span class="line">  - 格式：SET HEADING &#123;ON | OFF&#125;</span><br><span class="line"></span><br><span class="line">* WRAP</span><br><span class="line">  - 设置 sql report 中是否对过长的行进行换行显示</span><br><span class="line">  - ON 表示换行显示</span><br><span class="line">  - OFF 表示截断显示</span><br><span class="line">  - 格式：SET WRAP &#123;ON|OFF&#125;</span><br><span class="line"></span><br><span class="line">* PAGESIZE</span><br><span class="line">  - 设置 sql report 一页所能容纳的行数，默认 14</span><br><span class="line">  - 注意 pagesize 也包括页标题 btitle 、列名 column_name 所占用的行数</span><br><span class="line">  - 0 表示不分页，但同时列标题也会被隐藏</span><br><span class="line">  - 格式：SET PAGESIZE Number</span><br><span class="line"></span><br><span class="line">* LINESIZE</span><br><span class="line">  - 设置 sql report 中一行的字符数，默认 80</span><br><span class="line">  - SET LINESIZE Number</span><br><span class="line"></span><br><span class="line">* FEEDBACK</span><br><span class="line">  - 设置 sql report 中是否显示 &quot;N rows selected&quot; 这句话</span><br><span class="line">  - 格式：SET FEEDBACK &#123; Number | ON | OFF | ONLY&#125;</span><br><span class="line">    - 0、OFF   不显示 &quot;N rows selected&quot; 这句话</span><br><span class="line">    - 1、ON    若查询结果大于等于 1 行，则显示 &quot;N rows selected&quot;，若查询结果为 0 行，则显示 &quot;no rows selected&quot; 这句话</span><br><span class="line">    - Nunmer   若查询结果大于等于 Number 行，显示 &quot;n rows selected&quot;，若查询结果小于 Number 行，则无显示</span><br><span class="line">    - ONLY     不显示检索的结果，只显示 &quot;N rows selected&quot; 这句话</span><br><span class="line"></span><br><span class="line">* NULL</span><br><span class="line">  - 设置对空值的显示文字，默认为空字符串</span><br><span class="line">  - 格式：SET NULL Text</span><br><span class="line"></span><br><span class="line">* 其他配置参数</span><br><span class="line">  - NUMWIDTH</span><br><span class="line">  - 默认的 number 型的宽度</span><br><span class="line"></span><br><span class="line">* NUMFORMAT</span><br><span class="line">  - 默认的 number 型的格式</span><br><span class="line"></span><br><span class="line">* UNDERLINE</span><br><span class="line">  - 列标题的下划线的默认符号</span><br><span class="line"></span><br><span class="line">* SET RECSEP WRAPPED | EACH | OFF</span><br><span class="line">  - 何时显示 record separater</span><br><span class="line">  - warpped 表示分行时显示</span><br><span class="line">  - echo 表示每行都显示</span><br><span class="line"></span><br><span class="line">* SET RECSEPCHAR c</span><br><span class="line">  - 设定 record separater 的符号</span><br><span class="line">  - record separater 的格式另起一行的一整行的 recsepchar</span><br><span class="line"></span><br><span class="line">* NEWPAGE</span><br><span class="line">  - 设定每一页的开始的空行数量</span><br><span class="line">  - 0 也会加一个分页符</span><br><span class="line">  - none 才真的什么都不加</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：COLUMN-指令"><a href="#知识点：COLUMN-指令" class="headerlink" title="知识点：COLUMN 指令"></a>知识点：COLUMN 指令</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 设置 report 中的某一个列的显示格式</span><br><span class="line"></span><br><span class="line">* 替代格式</span><br><span class="line">  - COL</span><br><span class="line">  - COLUMN</span><br><span class="line"></span><br><span class="line">* 格式</span><br><span class="line">  COLUMN                          &lt;== 显示目前的所有设置</span><br><span class="line">  COLUMN column_name              &lt;== 显示某一列的设置</span><br><span class="line">  COLUMN column_name &#123;ON | OFF&#125;               &lt;== 对此列的设置是否生效</span><br><span class="line">  COLUMN &#123;column_name | expr&#125; &#123;option ...&#125;    &lt;== 进行设置，其中 expr 的内容必须要与 SELECT 语句中的内容完全相同</span><br></pre></td></tr></table></figure></li>
<li><strong>option</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">* FOR[MAT] format</span><br><span class="line">  - 指定列的格式</span><br><span class="line">  - 字符型格式</span><br><span class="line">    - 指定列的字符数，n 表示数字</span><br><span class="line">    - COL column_name FORMAT An</span><br><span class="line">  - 数字型格式</span><br><span class="line">    - 指定 number 型列的显示时使用的格式化模型</span><br><span class="line">    - COL column_name FORMAT number_format_model</span><br><span class="line">  - 日期型格式不能通过 col 命令来修改，可以在 SELECT 时使用 to_char 函数，或者修改 session 的相关参数</span><br><span class="line"></span><br><span class="line">* ALIAS alias</span><br><span class="line">  - 设置别名</span><br><span class="line">  - 别名可以在 break 和 compute 命令中使用</span><br><span class="line"></span><br><span class="line">* CLEAR</span><br><span class="line">  - 清除某一列的设置，或清除所有 column 设置</span><br><span class="line"></span><br><span class="line">* FOLD_AFTER</span><br><span class="line">  - 此列的每一行，结束后加一个回车，此列的列标题结束后也加一个回车</span><br><span class="line"></span><br><span class="line">* FOLD_BEFORE</span><br><span class="line">  - 此列的每一行，开始前加一个回车，此列的列标题开始前也加一个回车</span><br><span class="line"></span><br><span class="line">* HEADING text [JUSTIFY &#123;LEFT|CENTER|RIGHT&#125;]</span><br><span class="line">  - 修改列标题的内容和对齐方向，如果 text 放在单引号或双引号中，则可以加上 HEADSEP 代表换行，默认为 vertical bar</span><br><span class="line"></span><br><span class="line">* LIKE &#123;expr alias&#125;</span><br><span class="line">  - 使用其他某个列的设置</span><br><span class="line"></span><br><span class="line">* NEWLINE</span><br><span class="line">  - 相当于 FOLD_BEFORE</span><br><span class="line"></span><br><span class="line">* NOPRINT | PRINT</span><br><span class="line">  - 显示某一列或不显示某一列</span><br><span class="line"></span><br><span class="line">* NULL text</span><br><span class="line">  - 指定 null 值的显示内容</span><br><span class="line"></span><br><span class="line">* WRAPPED | WORD_WRAPPED | TRUNCATED</span><br><span class="line">  - 调整列超出范围的显示方式</span><br><span class="line">  - WRAPPED 单词会跨行</span><br><span class="line">  - WORD_WRAPPED 单词不会跨行</span><br><span class="line"></span><br><span class="line">* NEW_VALUE variable_name</span><br><span class="line">  - 将列的内容储存在变量中，用来创建 masterdetail report</span><br><span class="line"></span><br><span class="line">* OLD_VALUE variable_name</span><br><span class="line">  - 将列的内容储存在变量中，用来创建 masterdetail report</span><br><span class="line"></span><br><span class="line">* ENTMAP &#123;ON | OFF&#125;</span><br><span class="line">  - 与 SET MARKUP HTML 有关</span><br><span class="line">  - 当 SET MARKUP HTML ON 时，COL ENTMAP ON 会将列的内容中的 HTML 功能字符替换为 HTML Entity</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：REPHEADER、REPFOOTER、TTITLE、BTITLE-指令"><a href="#知识点：REPHEADER、REPFOOTER、TTITLE、BTITLE-指令" class="headerlink" title="知识点：REPHEADER、REPFOOTER、TTITLE、BTITLE 指令"></a>知识点：REPHEADER、REPFOOTER、TTITLE、BTITLE 指令</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - REPHEADER，设置报告头，出现在 report 的开头</span><br><span class="line">  - REPFOOTER，设置报告尾，出现在 report 的末尾</span><br><span class="line">  - TTITLE，设置页眉</span><br><span class="line">  - BTITLE，设置页脚</span><br><span class="line"></span><br><span class="line">* 格式</span><br><span class="line">  COMMAND                 &lt;== 查看当前设置</span><br><span class="line">  REPH[EADER] [PAGE] [printspec [text|variable] ...] | [ON | OFF]</span><br><span class="line">  REPF[OOTER] [PAGE] [printspec [text|variable] ...] | [ON | OFF]</span><br><span class="line">  TTI[TLE] [printspec [text|variable] ...] [ON | OFF]</span><br><span class="line">  BTI[TLE] [printspec [text|variable] ...] | [ON | OFF]</span><br><span class="line"></span><br><span class="line">* PAGE</span><br><span class="line">  - 设定报告头或报告尾是否在单独一页中显示</span><br><span class="line"></span><br><span class="line">* text</span><br><span class="line">  - 指定文字内容</span><br><span class="line"></span><br><span class="line">* variable</span><br><span class="line">  - 使用变量的值，注意即使不加引用符 &amp; 也会自动使用变量的值</span><br><span class="line">  - 可以是系统维护变量</span><br><span class="line">  - 可以是 sqlplus 的预定义变量</span><br><span class="line"></span><br><span class="line">* printspec</span><br><span class="line">  - 确定打印格式</span><br><span class="line">  - 每一个 text 可以有多个打印格式</span><br><span class="line">  - 格式</span><br><span class="line">    BOLD | CE[NTER] | COL n | FORMAT text | LE[FT] | R[IGHT] | S[KIP] [n] | TAB n</span><br><span class="line">    - SKIP n，换行</span><br><span class="line">    - FORMAT format_model</span><br><span class="line">    - LEFT | CENTER | RIGHT</span><br><span class="line">    - COL n，缩进 n 个字符，注意实际缩进 n-1 个字符，负数表示反向缩进</span><br><span class="line">    - TAB n，缩进 n 个制表符，实际缩进 n-1 个制表符，负数表示反向缩进</span><br><span class="line">    - BOLD，黑体，注意 sqlplus 显示黑体是重复三行显示</span><br><span class="line"></span><br><span class="line">* 相关系统维护变量 System-Maintained Values</span><br><span class="line">  - SQL.LNO</span><br><span class="line">    - the current line number</span><br><span class="line">  - SQL.PNO</span><br><span class="line">    - the current page number</span><br><span class="line">  - SQL.CODE</span><br><span class="line">    - the current error code</span><br><span class="line">  - SQL.RELEASE</span><br><span class="line">    - the current Oracle Database release number</span><br><span class="line">  - SQL.USER</span><br><span class="line">    - the current username</span><br><span class="line"></span><br><span class="line">* 关于使用系统维护变量 System-Maintained Values 和预定义变量 Predefined Variables</span><br><span class="line">  - 最好显式的添加一个格式，如 LEFT</span><br><span class="line">  - 如果不加格式，直接引用，会出奇怪的打印错误</span><br><span class="line">  - 例如，TTITLE _date 和 TTITLE LEFT _date 意思相同，但前者会出现奇怪的打印错误</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：PAUSE-指令"><a href="#知识点：PAUSE-指令" class="headerlink" title="知识点：PAUSE 指令"></a>知识点：PAUSE 指令</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 设置翻页前暂停功能，用户必须按下回车才能翻页</span><br><span class="line"></span><br><span class="line">* 格式</span><br><span class="line">  PAUSE text</span><br></pre></td></tr></table></figure></li>
<li><strong>PAUSE 配置参数</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 以参数的形式开启或关闭 PAUSE 功能</span><br><span class="line"></span><br><span class="line">* 格式</span><br><span class="line">  SET PAUSE OFF</span><br><span class="line">  SET PAUSE ON      &lt;== 开启 PAUSE 功能，默认提示符为空字符</span><br><span class="line">  SET PAUSE text    &lt;== 设定在 pause on 时的提示字符，不能开关 pause 功能</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：BREAK-指令"><a href="#知识点：BREAK-指令" class="headerlink" title="知识点：BREAK 指令"></a>知识点：BREAK 指令</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 对 order by 后的结果进行分组和隐藏</span><br><span class="line"></span><br><span class="line">* 格式</span><br><span class="line">  - BREAK，查询现在所有的 break 设置</span><br><span class="line">  - BREAK ON report_element action action</span><br><span class="line">  - BREAK ON report_element action aciton ON report_element_2actionaction</span><br><span class="line"></span><br><span class="line">* report_element</span><br><span class="line">  - column_name，expr，ROW，REPORT</span><br><span class="line">  - ON column_name, ON expr，对列进行 break</span><br><span class="line">  - ON ROW，表示对每一行都进行 break action</span><br><span class="line">  - ON REPORT，表示对最终的查询结果进行 break aciton</span><br><span class="line"></span><br><span class="line">* action</span><br><span class="line">  - SKIP n, SKIP PAGE，break 时，空 n 行或另起一页</span><br><span class="line">  - NODUPLICATES, DUPLICATES，break 时，nodup 表示重复值不显示，dup 表示显示重复值</span><br><span class="line"></span><br><span class="line">* 出现在 break 的 column_name 或 expr，称为 break column</span><br><span class="line">  - break column 应该出现在 SELECT list 和 order by list 中</span><br><span class="line">  - break column 如果有多个，则在 SELECT list 和 order by list 中的顺序应该与 break 中的顺序相同</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：COMPUTE-指令"><a href="#知识点：COMPUTE-指令" class="headerlink" title="知识点：COMPUTE 指令"></a>知识点：COMPUTE 指令</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 配合 break 使用，对 break 后的每一个子集进行计算</span><br><span class="line"></span><br><span class="line">* 格式</span><br><span class="line">  - COMPUTE，查看所有的 compute 设置</span><br><span class="line">  - COMPUTE &#123;function LABEL text OF &#123; expr | column | alias ...&#125; ...&#125; &#123;ON &#123;expr column alias REPORT ROW&#125; ...&#125;</span><br><span class="line"></span><br><span class="line">* function，多个函数使用空格间隔</span><br><span class="line">  - AVG</span><br><span class="line">  - COUNT，统计非 null 值</span><br><span class="line">  - MINIMUM</span><br><span class="line">  - MAXIMUM</span><br><span class="line">  - NUMBER，统计行数</span><br><span class="line">  - SUM</span><br><span class="line">  - STD，标准差</span><br><span class="line">  - VARIANCE，方差</span><br><span class="line"></span><br><span class="line">* label</span><br><span class="line">  - 对计算结果设置标签</span><br><span class="line">  - lagel 会放在 break column 上</span><br><span class="line">  - 如果需要引号，则用单引号</span><br><span class="line"></span><br><span class="line">* of</span><br><span class="line">  - 计算子集中的哪一列</span><br><span class="line">  - 计算的列应该出现在 SELECT list 中，如果需要引号，则用单引号</span><br><span class="line"></span><br><span class="line">* on</span><br><span class="line">  - 对应 break 的分组依据，分组依据应该出现在 break on 中</span><br><span class="line">  - COMPUTE ON REPORT，则需要 BREAK ON REPORT</span><br><span class="line">  - COMPUTE ON column，则需要 BREAK ON column</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：dummy-column"><a href="#知识点：dummy-column" class="headerlink" title="知识点：dummy column"></a>知识点：dummy column</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 一个隐藏列的显示的技巧，常用来隐藏 compute label</span><br><span class="line"></span><br><span class="line">* 原理</span><br><span class="line">  - compute label 会放在 break on 列上，只要隐藏 break on 列即可隐藏 compute</span><br><span class="line">  - break column 需要出现在 report 中，则可以 SELECT break column 两次，一个改名为 dummy，将其作为 break 依据并隐藏</span><br><span class="line"></span><br><span class="line">* 操作</span><br><span class="line">  - COLUMN dummy NOPRINT</span><br><span class="line">  - BREAK ON dummy</span><br><span class="line">  - COMPUTE SUM OF salary ON dummy</span><br><span class="line">  - SELECT departmane_id dummy, first_name, salary FROM EMP_DETAILS_VIEW</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：SPOOL-指令"><a href="#知识点：SPOOL-指令" class="headerlink" title="知识点：SPOOL 指令"></a>知识点：SPOOL 指令</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 将屏幕的显示导出到离线文件中</span><br><span class="line"></span><br><span class="line">* 格式</span><br><span class="line">  SPOOL                                               &lt;== 查看 spool 情况</span><br><span class="line">  SPOOL file_name [CREATE | REPLACE | APPEND ] ;      &lt;== 开启 spool 并指定目标文件</span><br><span class="line">  SPOOL ON ;                                          &lt;== 开启 spool 并导出到当前目录下的 on.lst 中</span><br><span class="line">  SPOOL OFF ;                                         &lt;== 关闭 spool</span><br><span class="line">  SPOOL OUT ;                                         &lt;== 关闭 spool 功能并将文件发送到系统默认打印机，此选项在某些操作系统上不支持</span><br><span class="line"></span><br><span class="line">* file_name</span><br><span class="line">  - 绝对路径，直接按照绝对路径进行操作</span><br><span class="line">  - 相对路径</span><br><span class="line">    - CREATE，在 current working directory 进行新建</span><br><span class="line">    - 其他情况，在 ORALCLE_PATH 和 current working directory 进行搜索</span><br><span class="line">  - filename 中有空格，则需要加单引号或双引号</span><br><span class="line">  - 默认扩展名为 lst，可以指定扩展名</span><br></pre></td></tr></table></figure></li>
<li><strong>Flat File</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">* 常用的 SPOOL 格式</span><br><span class="line"></span><br><span class="line">* Flat File</span><br><span class="line">  - sh 脚本</span><br><span class="line">  - csv 文件</span><br><span class="line"></span><br><span class="line">* sh 脚本</span><br><span class="line">  SET ECHO OFF        -- 不显示执行的语句</span><br><span class="line">  SET FEEDBACK OFF    -- 不显示 n rows SELECT 这句话</span><br><span class="line">  SET HEADING OFF     -- 不显示列标题</span><br><span class="line">  SET PAGESIZE 0      -- 不分页</span><br><span class="line">  SET LINESIZE 5000</span><br><span class="line">  SET LONG 5000</span><br><span class="line">  SET VERIFY OFF      -- 不显示替换变量的过程</span><br><span class="line">  SET TIMING OFF      -- 不显示语句的执行时间</span><br><span class="line">  SET TERMOUT OFF     -- 不在屏幕上显示返回行，只影响执行脚本，不影响交互式执行 SQL 语句</span><br><span class="line">  SET TRIMOUT ON      -- 去除每行结尾为了满足 linesize 而追加的空白，只影响交互显示</span><br><span class="line">  SET TRIMSPOOL ON    -- 去除每行结尾为了满足 linesize 而追加的空白，只影响 SPOOL 内容</span><br><span class="line">  SET COLSEP ...      -- 设置列分隔符</span><br><span class="line"></span><br><span class="line">* csv</span><br><span class="line">  SET FEEDBACK OFF</span><br><span class="line">  SET TERMOUT OFF</span><br><span class="line">  SET MARKUP CSV ON QUOTE ON|OFF ;</span><br><span class="line"></span><br><span class="line">* HTML</span><br><span class="line">  SET MARKUP HTML ... ;</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：MARKUP"><a href="#知识点：MARKUP" class="headerlink" title="知识点：MARKUP"></a>知识点：MARKUP</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">* MARKUP</span><br><span class="line">  - 指定 spool 生成文件的格式</span><br><span class="line">  - html 或 csv</span><br><span class="line"></span><br><span class="line">* 开启 markup 格式的两种方式</span><br><span class="line">  - SET MARKUP</span><br><span class="line">  - sqlplus -m</span><br><span class="line"></span><br><span class="line">* CSV</span><br><span class="line">  SET MARKUP CSV &#123;ON|OFF&#125; [DELIMITER delimiter] [QUOTE &#123;ON|OFF&#125;] ;</span><br><span class="line">  - DELIMITER 指定分隔符，默认 comma</span><br><span class="line">  - QUOTE 指定字符型和日期型是否用双引号括起来，默认 OFF</span><br><span class="line"></span><br><span class="line">* HTML</span><br><span class="line">  SET MARKUP HTML &#123;ON|OFF&#125;</span><br><span class="line">  [HEAD &lt;text&gt;]</span><br><span class="line">  [BODY &lt;text&gt;]</span><br><span class="line">  [TABLE &lt;text&gt;]</span><br><span class="line">  [ENTMAP &#123;ON|OFF&#125;]</span><br><span class="line">  [SPOOL &#123;ON|OFF&#125;]</span><br><span class="line">  [PREFORMAT &#123;ON|OFF&#125;]</span><br><span class="line">  ;</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h2 id="2-6-sqlplus-普通指令"><a href="#2-6-sqlplus-普通指令" class="headerlink" title="2.6 sqlplus 普通指令"></a>2.6 sqlplus 普通指令</h2><hr>
<h3 id="知识点：HELP-指令"><a href="#知识点：HELP-指令" class="headerlink" title="知识点：HELP 指令"></a>知识点：HELP 指令</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 查看 sqlplus 的内置帮助</span><br><span class="line"></span><br><span class="line">* 格式</span><br><span class="line">  HELP Topic            &lt;== 查看某项主题的帮助</span><br><span class="line">  HELP INDEX            &lt;== 查看内置帮助中包含哪些主体</span><br><span class="line">  HELP RESERVED WORDS   &lt;== 查看 ORACLE 数据库的 SQL 保留字和 PL/SQL 保留字</span><br><span class="line"></span><br><span class="line">* 替换格式</span><br><span class="line">  - &#x27;?&#x27;</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：EXIT-指令"><a href="#知识点：EXIT-指令" class="headerlink" title="知识点：EXIT 指令"></a>知识点：EXIT 指令</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 断开连接并退出 sqlplus 环境并返回一个值</span><br><span class="line"></span><br><span class="line">* 替换格式</span><br><span class="line">  - QUIT</span><br><span class="line"></span><br><span class="line">* 格式</span><br><span class="line">  EXIT [SUCCESS|FAILURE|WARNING|n|Variable|:BindVariable] [COMMIT|ROLLBACK]</span><br><span class="line"></span><br><span class="line">* SUCCESS</span><br><span class="line">  - 退出并 return 0，默认</span><br><span class="line"></span><br><span class="line">* FAILURE</span><br><span class="line">  - 退出并 return failure，一般为 1</span><br><span class="line"></span><br><span class="line">* WARNING</span><br><span class="line">  - 退出并 return warning，一般为 2</span><br><span class="line"></span><br><span class="line">* n</span><br><span class="line">  - 退出并 return n</span><br><span class="line"></span><br><span class="line">* Variable</span><br><span class="line">  - 退出并 return 相应的替换变量的值</span><br><span class="line"></span><br><span class="line">* :BindVariable</span><br><span class="line">  - 退出并 return 相应的绑定变量的值</span><br><span class="line"></span><br><span class="line">* COMMIT</span><br><span class="line">  - 退出并提交所有未提交内容，默认</span><br><span class="line"></span><br><span class="line">* ROLLBACK</span><br><span class="line">  - 退出并回退所有未提交内容</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：PROMPT-指令"><a href="#知识点：PROMPT-指令" class="headerlink" title="知识点：PROMPT 指令"></a>知识点：PROMPT 指令</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 输出一行 Text</span><br><span class="line"></span><br><span class="line">* 格式</span><br><span class="line">  PROMPT        &lt;== 输出一个空行</span><br><span class="line">  PROMPT Text   &lt;== 输出一行文字</span><br><span class="line"></span><br><span class="line">* 注意</span><br><span class="line">  - PROMPT 指令不能断行，多行输出需要多个 PROMPT 指令</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：HOST-指令"><a href="#知识点：HOST-指令" class="headerlink" title="知识点：HOST 指令"></a>知识点：HOST 指令</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">* 作用</span><br><span class="line">  - 在 sqlplus 环境下执行操作系统命令</span><br><span class="line"></span><br><span class="line">* 格式</span><br><span class="line">  HOST OS_Command</span><br><span class="line">  HOST                &lt;== 不加任何命令，则开启一个子 shell，为操作系统的 shell</span><br><span class="line"></span><br><span class="line">* 替换形式</span><br><span class="line">  - 在 Linux 平台，替换形式为 &#x27;!&#x27;</span><br><span class="line">  - 在 Windows 平台，替换形式为 &#x27;$&#x27;</span><br><span class="line"></span><br><span class="line">* 注意</span><br><span class="line">  - HOST 指令如果修改了系统环境变量，则不会影响当前 session，但会影响之后开启的 session</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：HISTORY-指令"><a href="#知识点：HISTORY-指令" class="headerlink" title="知识点：HISTORY 指令"></a>知识点：HISTORY 指令</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 查看历史命令</span><br><span class="line"></span><br><span class="line">* 格式</span><br><span class="line">  HIST LIST       &lt;== 查看所有历史命令</span><br><span class="line">  HIST n RUN      &lt;== 重新运行历史命令中序号为 n 的命令</span><br><span class="line">  HIST n EDIT     &lt;== 编辑历史命令中序号为 n 的命令</span><br><span class="line">  HIST n DEL      &lt;== 删除历史命令中序号为 n 的命令</span><br><span class="line">  HIST CLEAR      &lt;== 清空历史命令</span><br><span class="line"></span><br><span class="line">* 注意</span><br><span class="line">  - HIST LIST 会在某一条前显示一个星号，表示上一次执行的命令，但只能是通过 history entry 执行的命令，即 hist n run</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：TIMING-指令"><a href="#知识点：TIMING-指令" class="headerlink" title="知识点：TIMING 指令"></a>知识点：TIMING 指令</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 创建计时器 timer，可以用来记录 SQL statement 的执行时间</span><br><span class="line"></span><br><span class="line">* 格式</span><br><span class="line">  TIMING                    &lt;== 查看现在有几个 timer</span><br><span class="line">  TIMING START timer_name   &lt;== 创建一个 timer</span><br><span class="line">  TIMING SHOW               &lt;== 显示 current timer 已经持续的时间</span><br><span class="line">  TIMING STOP               &lt;== 停止 current timer</span><br><span class="line"></span><br><span class="line">* 关于多个 timer</span><br><span class="line">  - 可以同时创建多个 timer</span><br><span class="line">  - 后创建的 timer 会被嵌套在先创建的 timer 中，所有 timer 都正常的记录持续的时间</span><br><span class="line">  - 最后一个创建的 timer 成为 current timer</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：PASSWORD-指令"><a href="#知识点：PASSWORD-指令" class="headerlink" title="知识点：PASSWORD 指令"></a>知识点：PASSWORD 指令</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 修改密码</span><br><span class="line">  - 出现一个交互界面，在交互界面中修改密码</span><br><span class="line"></span><br><span class="line">* 格式</span><br><span class="line">  PASSWORD UserName</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：EXEC-指令"><a href="#知识点：EXEC-指令" class="headerlink" title="知识点：EXEC 指令"></a>知识点：EXEC 指令</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 执行一个 single PL/SQL statement</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h2 id="2-7-sql-buffer"><a href="#2-7-sql-buffer" class="headerlink" title="2.7 sql buffer"></a>2.7 sql buffer</h2><hr>
<h3 id="知识点：sql-buffer-介绍"><a href="#知识点：sql-buffer-介绍" class="headerlink" title="知识点：sql buffer 介绍"></a>知识点：sql buffer 介绍</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 储存最近一次输入的 SQL statement 或 PL/SQL block 的内存区块</span><br><span class="line">  - 一条 SQL statement 可以分多行编写，在 sql buffer 中也是分多行储存</span><br><span class="line">  - sql buffer 只能保存一条 SQL 语句，或一个 PL/SQL 块，否则执行时会报错</span><br><span class="line">  - sql buffer 只接受 slash 来表示语句结束，分号会被转换为 slash 的方式</span><br><span class="line"></span><br><span class="line">* sql buffer 的相关命令</span><br><span class="line">  - LIST</span><br><span class="line">  - EDIT</span><br><span class="line">  - RUN</span><br><span class="line">  - GET</span><br><span class="line">  - SAVE</span><br><span class="line">  - CHANGE</span><br><span class="line">  - APPEND</span><br><span class="line">  - INPUT</span><br><span class="line">  - DEL</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：LIST-指令"><a href="#知识点：LIST-指令" class="headerlink" title="知识点：LIST 指令"></a>知识点：LIST 指令</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 查看 sql buffer 中的内容</span><br><span class="line">  - 指定 current line 焦点行</span><br><span class="line"></span><br><span class="line">* 替代格式</span><br><span class="line">  - ;</span><br><span class="line">  - L</span><br><span class="line">  - LIST</span><br><span class="line"></span><br><span class="line">* 用法</span><br><span class="line">  LIST            &lt;== 查看整个 sql buffer 的内容</span><br><span class="line">  LIST n          &lt;== 查看第 n 行</span><br><span class="line">  LIST n m        &lt;== 查看第 n 行到第 m 行</span><br><span class="line">  LIST n *        &lt;== 查看第 n 行到 current line</span><br><span class="line">  LIST n LAST     &lt;== 查看第 n 行到最后</span><br><span class="line">  LIST *          &lt;== 查看 current line</span><br><span class="line">  LIST * LAST     &lt;== 查看 current line 到最后</span><br><span class="line">  LIST LAST       &lt;== 查看最后一行</span><br><span class="line"></span><br><span class="line">* 焦点行</span><br><span class="line">  - LIST 的显示内容中，星号表示 current line 焦点行</span><br><span class="line">  - 执行以下指令后，第 n 行变为 current line</span><br><span class="line">    - LIST n，</span><br><span class="line">  - 执行以下指令后，第 m 行变为 current line</span><br><span class="line">    - LIST n m</span><br><span class="line">  - 执行以下指令后，LAST 行变为 current line</span><br><span class="line">    - LIST</span><br><span class="line">    - LIST n LAST</span><br><span class="line">    - LIST * last</span><br><span class="line">    - LIST LAST</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：EDIT-指令"><a href="#知识点：EDIT-指令" class="headerlink" title="知识点：EDIT 指令"></a>知识点：EDIT 指令</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 编辑 sql buffer，或编辑某个脚本文件</span><br><span class="line">  - 会打开默认的文本编辑工具进行编辑，linux 默认为 vim</span><br><span class="line"></span><br><span class="line">* 替代格式</span><br><span class="line">  - ED</span><br><span class="line">  - EDIT</span><br><span class="line"></span><br><span class="line">* 用法</span><br><span class="line">  EDIT              &lt;== 编辑 sql buffer</span><br><span class="line">  EDIT file_name    &lt;== 编辑某个脚本文件</span><br><span class="line"></span><br><span class="line">* 注意事项</span><br><span class="line">  - EDIT 如果没有搜索到相关文件，则 edit 会在 current working directory 新建一个脚本文件</span><br><span class="line"></span><br><span class="line">* afiedt.buf</span><br><span class="line">  - EDIT 命令会在 current working directory 中创建一个 afiedt.buf 文件</span><br><span class="line">  - EDIT 会将 sql buffer 中的内容移到 afiedt.buf 中</span><br><span class="line">  - EDIT 编辑也就是编辑 afiedt.buf 文件</span><br><span class="line">  - 编辑结束后，按照用户指定，将 afiedt.buf 的内容复制到文件中或者加载到 sql buffer 中</span><br><span class="line">  - afiedt.buf 不会删除</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：RUN-指令"><a href="#知识点：RUN-指令" class="headerlink" title="知识点：RUN 指令"></a>知识点：RUN 指令</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 运行储存在 sql buffer 中内容</span><br><span class="line"></span><br><span class="line">* 替代格式</span><br><span class="line">  - /</span><br><span class="line">  - R</span><br><span class="line">  - RUN</span><br><span class="line"></span><br><span class="line">* RUN 和 / 的区别</span><br><span class="line">  - / 不会显示执行的语句的内容</span><br><span class="line">  - run 会显示执行的语句的内容</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：GET-指令"><a href="#知识点：GET-指令" class="headerlink" title="知识点：GET 指令"></a>知识点：GET 指令</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 将某个脚本文件的内容加载到 sql buffer 中</span><br><span class="line">  - GET 通常可以和 SAVE 配合使用</span><br><span class="line"></span><br><span class="line">* 格式</span><br><span class="line">  GET file_name</span><br><span class="line">  GET file_name NOLIST      &lt;== 加载到 sql buffer 中但不显示内容</span><br><span class="line"></span><br><span class="line">* 注意事项</span><br><span class="line">  - 文件中，应该只包含一个 sql statment 或者 PL/SQL block，否则在接下来 run 时就会报错</span><br><span class="line">  - 文件中，SQL 语句应该以 slash 表示语句结束</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：SAVE-指令"><a href="#知识点：SAVE-指令" class="headerlink" title="知识点：SAVE 指令"></a>知识点：SAVE 指令</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 将 sql buffer 中的内容储存在脚本文件中</span><br><span class="line"></span><br><span class="line">* 格式</span><br><span class="line">  SAVE file_name CREATE       &lt;== 新创建一个脚本文件</span><br><span class="line">  SAVE file_name REPLACE      &lt;== 替换文件原内容</span><br><span class="line">  SAVE file_name APPEND       &lt;== 追加内容</span><br><span class="line"></span><br><span class="line">* 注意事项</span><br><span class="line">  - file_name 默认扩展名为 sql</span><br><span class="line">  - 如果想保存到其他扩展名的文件，则必须在 file_name 上指定扩展名</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：CHANGE-指令"><a href="#知识点：CHANGE-指令" class="headerlink" title="知识点：CHANGE 指令"></a>知识点：CHANGE 指令</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 替换 current line 中第一次出现的某字符串</span><br><span class="line"></span><br><span class="line">* 替代格式</span><br><span class="line">  - C</span><br><span class="line">  - CHANGE</span><br><span class="line"></span><br><span class="line">* 格式</span><br><span class="line">  CHANGE /old_string[/new_string]</span><br><span class="line"></span><br><span class="line">* 注意</span><br><span class="line">  - 如果省略 new_string，相当于将第一次出现的 old_string 删除</span><br><span class="line">  - 如果 old_string 以 ... 开头，代表从 current line 的开头开始替换</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：APPEND-指令"><a href="#知识点：APPEND-指令" class="headerlink" title="知识点：APPEND 指令"></a>知识点：APPEND 指令</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 将文本添加到 current line 的末尾</span><br><span class="line"></span><br><span class="line">* 替代格式</span><br><span class="line">  - A</span><br><span class="line">  - APPEND</span><br><span class="line"></span><br><span class="line">* 用法</span><br><span class="line">  APPEND text</span><br><span class="line">  APPEND ;;         &lt;== 追加一个分号到 current line 结尾</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：INPUT-指令"><a href="#知识点：INPUT-指令" class="headerlink" title="知识点：INPUT 指令"></a>知识点：INPUT 指令</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 将文本添加到 current line 的下一行</span><br><span class="line"></span><br><span class="line">* 格式</span><br><span class="line">  INPUT text</span><br><span class="line"></span><br><span class="line">* 注意</span><br><span class="line">  - text 可以是一行，也可以是多行</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：DEL-指令"><a href="#知识点：DEL-指令" class="headerlink" title="知识点：DEL 指令"></a>知识点：DEL 指令</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 删除 sql buffer 中的语句</span><br><span class="line"></span><br><span class="line">* 用法</span><br><span class="line">  DEL           &lt;== 删除 current line</span><br><span class="line">  DEL *         &lt;== 删除 current line</span><br><span class="line">  DEL n         &lt;== 删除第 n 行</span><br><span class="line">  DEL LAST      &lt;== 删除最后一行</span><br><span class="line">  DEL * LAST    &lt;== 删除从 current line 到最后一行</span><br><span class="line">  DEL n LAST    &lt;== 删除从第 n 行到最后一行</span><br><span class="line">  DEL n *       &lt;== 删除从第 n 行到 current line</span><br><span class="line">  DEL * n       &lt;== 删除从 current line 到第 n 行</span><br><span class="line">  DEL m n       &lt;== 删除从第 m 行到第 n 行</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h1 id="Chapter03-数据库体系"><a href="#Chapter03-数据库体系" class="headerlink" title="Chapter03 数据库体系"></a>Chapter03 数据库体系</h1><hr>
<h2 id="3-1-数据库体系介绍"><a href="#3-1-数据库体系介绍" class="headerlink" title="3.1 数据库体系介绍"></a>3.1 数据库体系介绍</h2><hr>
<h2 id="3-2-数据字典"><a href="#3-2-数据字典" class="headerlink" title="3.2 数据字典"></a>3.2 数据字典</h2><hr>
<h2 id="3-3-参数"><a href="#3-3-参数" class="headerlink" title="3.3 参数"></a>3.3 参数</h2><hr>
<h2 id="3-4-控制文件"><a href="#3-4-控制文件" class="headerlink" title="3.4 控制文件"></a>3.4 控制文件</h2><hr>
<h2 id="3-5-redo"><a href="#3-5-redo" class="headerlink" title="3.5 redo"></a>3.5 redo</h2><hr>
<h2 id="3-6-undo"><a href="#3-6-undo" class="headerlink" title="3.6 undo"></a>3.6 undo</h2><hr>
<h2 id="3-7-多租户"><a href="#3-7-多租户" class="headerlink" title="3.7 多租户"></a>3.7 多租户</h2><hr>
<h1 id="Chapter04-数据库实例"><a href="#Chapter04-数据库实例" class="headerlink" title="Chapter04 数据库实例"></a>Chapter04 数据库实例</h1><hr>
<h2 id="4-1-数据库实例概述"><a href="#4-1-数据库实例概述" class="headerlink" title="4.1 数据库实例概述"></a>4.1 数据库实例概述</h2><hr>
<h2 id="4-2-启动和停止实例"><a href="#4-2-启动和停止实例" class="headerlink" title="4.2 启动和停止实例"></a>4.2 启动和停止实例</h2><hr>
<h2 id="4-3-内存结构"><a href="#4-3-内存结构" class="headerlink" title="4.3 内存结构"></a>4.3 内存结构</h2><hr>
<h2 id="4-4-进程结构"><a href="#4-4-进程结构" class="headerlink" title="4.4 进程结构"></a>4.4 进程结构</h2><hr>
<h1 id="Chapter05-数据库存储"><a href="#Chapter05-数据库存储" class="headerlink" title="Chapter05 数据库存储"></a>Chapter05 数据库存储</h1><hr>
<h2 id="5-1-数据库存储概述"><a href="#5-1-数据库存储概述" class="headerlink" title="5.1 数据库存储概述"></a>5.1 数据库存储概述</h2><hr>
<h2 id="5-2-表空间和数据文件"><a href="#5-2-表空间和数据文件" class="headerlink" title="5.2 表空间和数据文件"></a>5.2 表空间和数据文件</h2><hr>
<h2 id="5-3-段"><a href="#5-3-段" class="headerlink" title="5.3 段"></a>5.3 段</h2><hr>
<h2 id="5-4-区"><a href="#5-4-区" class="headerlink" title="5.4 区"></a>5.4 区</h2><hr>
<h2 id="5-5-块"><a href="#5-5-块" class="headerlink" title="5.5 块"></a>5.5 块</h2><hr>
<h1 id="Chapter06-数据库管理"><a href="#Chapter06-数据库管理" class="headerlink" title="Chapter06 数据库管理"></a>Chapter06 数据库管理</h1><h2 id="6-6-diag"><a href="#6-6-diag" class="headerlink" title="6.6 diag"></a>6.6 diag</h2><hr>
<h1 id="Chapter07-数据库安全"><a href="#Chapter07-数据库安全" class="headerlink" title="Chapter07 数据库安全"></a>Chapter07 数据库安全</h1><hr>
<h2 id="7-1-账号"><a href="#7-1-账号" class="headerlink" title="7.1 账号"></a>7.1 账号</h2><hr>
<h2 id="7-2-权限"><a href="#7-2-权限" class="headerlink" title="7.2 权限"></a>7.2 权限</h2><hr>
<h2 id="7-3-配额"><a href="#7-3-配额" class="headerlink" title="7.3 配额"></a>7.3 配额</h2><hr>
<h1 id="Chapter08-数据库网络"><a href="#Chapter08-数据库网络" class="headerlink" title="Chapter08 数据库网络"></a>Chapter08 数据库网络</h1><hr>
<h2 id="8-1-Oracle-网络介绍"><a href="#8-1-Oracle-网络介绍" class="headerlink" title="8.1 Oracle 网络介绍"></a>8.1 Oracle 网络介绍</h2><hr>
<h3 id="知识点：Oracle-网络介绍"><a href="#知识点：Oracle-网络介绍" class="headerlink" title="知识点：Oracle 网络介绍"></a>知识点：Oracle 网络介绍</h3><ol start="2">
<li><strong>Oracle 网络的组成</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">* 监听 listener</span><br><span class="line"></span><br><span class="line">* 服务 service</span><br><span class="line"></span><br><span class="line">* 连接字符串 tnsname</span><br><span class="line"></span><br><span class="line">* 验证方式</span><br><span class="line"></span><br><span class="line">* 数据库进程</span><br><span class="line"></span><br><span class="line">* 用户进程</span><br><span class="line">  - 运行在用户的主机上的进程</span><br><span class="line">  - 包括，数据库客户端、数据库驱动(JDBC、ODBC 等)</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
<li><strong>Oracle 网络相关配置文件</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">* $ORACLE_HOME/network/admin/Listener.ora</span><br><span class="line"></span><br><span class="line">* $ORACLE_HOME/network/admin/Tnsnames.ora</span><br><span class="line"></span><br><span class="line">* $ORACLE_HOME/network/admin/Sqlnet.ora</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h2 id="8-2-连接"><a href="#8-2-连接" class="headerlink" title="8.2 连接"></a>8.2 连接</h2><hr>
<h3 id="知识点：连接"><a href="#知识点：连接" class="headerlink" title="知识点：连接"></a>知识点：连接</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 连接 connection，指数据库服务进程与用户进程之间的网络连接，对应了 OSI 架构的网络层和运输层</span><br></pre></td></tr></table></figure></li>
<li><strong>本地连接</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 以 sqlplus / as sysdba 的方式建立的到数据库的连接</span><br><span class="line">  - 需要 ORACLE_SID 变量</span><br><span class="line">  - 不使用监听</span><br><span class="line">  - 查看是否是本地连接</span><br><span class="line">    - 从 v$sesison 中获得服务器进程的 paddr</span><br><span class="line">    - 从 v$process 中获得服务器进程的 spid</span><br><span class="line">    - 通过查看服务器进程在 os 上的描述，查看 ps aux 的描述中 local=yes 还是 local=no</span><br></pre></td></tr></table></figure></li>
<li><strong>远程连接</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 使用监听建立的连接</span><br><span class="line">  - 可以使用两种协议，TCP/IP 或 IPC，支持的连接方式记录在 listener.ora 文件中</span><br><span class="line"></span><br><span class="line">* TCP/IP 协议建立连接</span><br><span class="line">  - 用户进程和监听进行通信，监听分配服务器进程</span><br><span class="line">  - 用户进程和服务器进程通过 TCP/IP 三次握手建立连接</span><br><span class="line">  - 建立连接之后，相应的信息保存在 PGA 中，继而建立会话</span><br><span class="line"></span><br><span class="line">* IPC 协议建立连接</span><br><span class="line">  - 客户端与服务器位于一个主机上</span><br><span class="line">  - 用户进程采用操作系统认证的方式，建立会话</span><br><span class="line">  - 相比 TCP/IP，IPC 的数据传输效率更快</span><br><span class="line">  - ipc 通常由 oracle 的内部组件使用，如 rman</span><br><span class="line">  - 只能使用 tnsname 来建立连接</span><br><span class="line">    - 在 tnsname 中指定 ipc_key，要与 listener 配置的 ipc_key 相同</span><br><span class="line">    - ipc_key 相当于进程间通信的秘钥</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：专有连接"><a href="#知识点：专有连接" class="headerlink" title="知识点：专有连接"></a>知识点：专有连接</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - dedicated，一个服务器进程只和一个用户进程建立连接</span><br><span class="line">  - 服务器进程的生命期与连接的生命期相同，在建立连接时拉起服务器进程，在断开连接时结束服务器进程</span><br><span class="line"></span><br><span class="line">* 专有连接的优点</span><br><span class="line">  - 适合于 PGA 更高的操作，如数据仓库操作</span><br><span class="line">  - 有一些操作只能用专有连接方式，如备份恢复，如 dba 操作</span><br></pre></td></tr></table></figure></li>
<li><strong>相关参数</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">* processes</span><br><span class="line">  - 限制了数据库的进程数</span><br><span class="line">  - 在专有连接模式下，间接限制了数据库可以建立的连接</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：共享连接"><a href="#知识点：共享连接" class="headerlink" title="知识点：共享连接"></a>知识点：共享连接</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 将对用户的请求的处理的过程进行了解构，分解为了两个部分：与用户进程交互、与数据库实例交互</span><br><span class="line"></span><br><span class="line">* 共享连接的优点</span><br><span class="line">  - 资源利用率更高，更适合大量请求的情况</span><br></pre></td></tr></table></figure></li>
<li><strong>共享连接方式中的组件</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 组件包括，调度进程、共享服务器进程、请求列表、响应列表</span><br><span class="line">  - 请求列表、相应列表默认放在 large pool 中，如果 large pool 没有设置，则放在 shared pool 中</span><br><span class="line"></span><br><span class="line">* 调度进程 dispatcher</span><br><span class="line">  - 负责与用户进程交互，并不与数据库实例交互</span><br><span class="line">    - 与用户进程建立连接</span><br><span class="line">    - 接收用户进程的请求</span><br><span class="line">    - 返回用户进程所需要的数据</span><br><span class="line">  - 数据库可以运行多个 dispatcher</span><br><span class="line">    - oracle 自动根据业务情况增加或减少 dispatcher 的数量</span><br><span class="line">    - 可以设定起始数量，也是最低数量</span><br><span class="line">    - 可以设定峰值数量</span><br><span class="line">  - 进程名</span><br><span class="line">    - ora_dNNN_InstanceName，N 代表数字</span><br><span class="line"></span><br><span class="line">* 共享连接服务器进程 shared server</span><br><span class="line">  - 负责与数据库实例交互，执行用户进程发出的 sql，并不与用户进程交互</span><br><span class="line">  - ora_SNNN_InstanceName，N 代表数字</span><br><span class="line"></span><br><span class="line">* 请求列表 request_list</span><br><span class="line">  - 负责缓存用户的请求</span><br><span class="line">  - 调度进程在收到用户的请求后，将请求缓存在 request_list 中</span><br><span class="line">  - 服务器进程会监视 request_list，从其中摘取请求后，即进行处理</span><br><span class="line"></span><br><span class="line">* 响应列表 respond_list</span><br><span class="line">  - 负责缓存处理结果</span><br><span class="line">  - 服务器进程在 sql 处理结束后，将处理结果缓存在 respond_list 中</span><br><span class="line">  - 调度进程会监视 respond_list，从其中摘取对应的结果，然后返回给用户进程</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
<li><strong>共享连接的工作流程</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">* 建立连接过程</span><br><span class="line">  - 用户进程建立连接到监听</span><br><span class="line">  - 监听分配一个 dispatcher 给此用户进程</span><br><span class="line">  - dispatcher 与用户进程建立连接</span><br><span class="line"></span><br><span class="line">* 数据处理过程</span><br><span class="line">  - 用户进程发送请求给 dispatcher</span><br><span class="line">  - dispatcher 将用户请求缓存到 request_list，request_list 中记录的请求与 dispatcher 一一对应</span><br><span class="line">  - 空闲的 server 进程看到 resquest_list 中的请求，摘取下来，并进行处理</span><br><span class="line"></span><br><span class="line">* 返回数据过程</span><br><span class="line">  - server 进程处理结束，将处理结果缓存到 respond_list，并且其中会记录此请求是源自于哪一个 dispatcher</span><br><span class="line">  - dispatcher 在 respond_list 中看到自己对应的处理结果，将其摘取下来，并返回给用户</span><br></pre></td></tr></table></figure></li>
<li><strong>相关参数</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">* dispatchers</span><br><span class="line">  - 设定共享连接的服务名</span><br><span class="line">  - 设定调度进程的属性</span><br><span class="line">  - 格式；&#x27;(PROTOCOL=TCP)(SERVICE=&lt;service_name&gt;)(dispatchers=3)&#x27;[, ...] ;</span><br><span class="line">  - (PROTOCOL=TCP)  ，指定连接协议</span><br><span class="line">  - (SERVICE=&lt;service_name&gt; [, ...])，指定共享连接的服务名</span><br><span class="line">  - (dispatchers=3)  ，指定初始调度程序进程的数量</span><br><span class="line"></span><br><span class="line">* max_dispatchers</span><br><span class="line">  - 设定最大调度程序进程的数量</span><br><span class="line"></span><br><span class="line">* shared_servers</span><br><span class="line">  - 设定初始共享连接服务器进程的数量</span><br><span class="line"></span><br><span class="line">* max_shared_servers</span><br><span class="line">  - 设定最大共享连接服务器进程的数量</span><br><span class="line"></span><br><span class="line">* shared_server_sessions</span><br><span class="line">  - 设定最大的共享连接的会话数量</span><br></pre></td></tr></table></figure></li>
<li><strong>相关数据字典</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">* v$shared_server</span><br><span class="line">  - 记录所有共享连接服务器进程的信息</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h2 id="8-3-会话"><a href="#8-3-会话" class="headerlink" title="8.3 会话"></a>8.3 会话</h2><hr>
<h3 id="知识点：会话"><a href="#知识点：会话" class="headerlink" title="知识点：会话"></a>知识点：会话</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 会话 session，指用户和数据库之间建立的通信链接，，对应了 OSI 架构的会话层</span><br><span class="line">  - 用户和数据库之间的数据交互，都是基于来会话实现</span><br><span class="line">  - 会话建立在连接之上</span><br><span class="line">  - 专有连接的会话信息存放在 PGA 中，共享连接的会话信息存放在 SGA 中</span><br></pre></td></tr></table></figure></li>
<li><strong>相关参数</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">* sessions</span><br><span class="line">  - 数据库的最大会话数，共享方式和专有方式的总和</span><br></pre></td></tr></table></figure></li>
<li><strong>相关数据字典</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">* v$mystat</span><br><span class="line">  - 记录当前会话的统计信息</span><br><span class="line"></span><br><span class="line">* v$session_connect_info</span><br><span class="line">  - 记录每个会话的连接的信息</span><br><span class="line"></span><br><span class="line">* v$session_longops</span><br><span class="line">  - 记录每个会话的长操作的情况</span><br><span class="line"></span><br><span class="line">* v$sess_io</span><br><span class="line">  - 记录每个会话的 IO 实时情况</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：会话操作"><a href="#知识点：会话操作" class="headerlink" title="知识点：会话操作"></a>知识点：会话操作</h3><ol>
<li><strong>踢会话</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">* SELECT s.sid, s.serial#, s.* FROM v$session s WHERE XXXX ;</span><br><span class="line"></span><br><span class="line">* ALTER SYSTEM KILL SESSION &#x27;&lt;s.sid&gt;, &lt;s.serial#&gt;&#x27; ;</span><br></pre></td></tr></table></figure></li>
<li><strong>查看当前会话的会话 ID</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT DISTINCT sid FROM v$mystat ;</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：v-session"><a href="#知识点：v-session" class="headerlink" title="知识点：v$session"></a>知识点：v$session</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 记录了所有会话的基本信息</span><br><span class="line">  - 是 oracle 中最常用的数据字典之一</span><br></pre></td></tr></table></figure></li>
<li><strong>常用字段</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">* 会话信息</span><br><span class="line">  SADDR         会话地址</span><br><span class="line">  SID           会话 ID</span><br><span class="line">  SERIAL#       会话序列号</span><br><span class="line">  SERVER        建立连接的类型，DEDICATED 或 SHARED</span><br><span class="line">  SERVICE_NAME  建立会话所使用的服务名</span><br><span class="line">  STATUS        会话的状态，ACTIVE 表示正在执行 SQL，INACTIVE 表示空闲中，KILLED 已被标记要踢掉</span><br><span class="line"></span><br><span class="line">* 服务器进程信息</span><br><span class="line">  PADDR         服务器进程地址，对应了 v$process 的 addr 字段</span><br><span class="line"></span><br><span class="line">* 用户进程信息</span><br><span class="line">  OSUSER        客户端上的用户</span><br><span class="line">  MACHINE       客户端主机的主机名</span><br><span class="line">  PORT          客户端进程的端口</span><br><span class="line">  PROCESS       用户进程的进程号</span><br><span class="line">  TERMINAL      linux 客户端的终端号</span><br><span class="line">  PROGRAM       客户端的程序名</span><br><span class="line"></span><br><span class="line">* 数据库用户信息</span><br><span class="line">  USER#         登录的用户 ID</span><br><span class="line">  USERNAME      登录的用户名</span><br><span class="line">  SCHEMA#       模式用户的 ID</span><br><span class="line">  SCHEMANAME    模式用户的用户名</span><br><span class="line"></span><br><span class="line">* 事务信息</span><br><span class="line">  TADDR         事务的地址</span><br><span class="line">  LOCKWAIT      事务被锁住的时间</span><br><span class="line"></span><br><span class="line">* sql 信息</span><br><span class="line">  SQL_ID        SQL 语句 ID</span><br><span class="line">  COMMAND       正在执行的 SQL 的类型，值为 v$sqlcommand 视图中的 command_tpye 字段</span><br><span class="line"></span><br><span class="line">* 阻断会话信息</span><br><span class="line">  BLOCKING_SESSION    此会话正在被哪个会话所阻断，阻断会话的 ID</span><br><span class="line">  EVENT#              等待时间的 ID</span><br><span class="line">  EVENT               等待事件类型</span><br><span class="line">  SECONDS_IN_WAIT</span><br><span class="line">  WAIT_TIME_MICRO</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h2 id="8-4-监听"><a href="#8-4-监听" class="headerlink" title="8.4 监听"></a>8.4 监听</h2><hr>
<h3 id="知识点：监听"><a href="#知识点：监听" class="headerlink" title="知识点：监听"></a>知识点：监听</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 监听 listener，用来接受用户的请求，建立数据库与用户进程之间的连接</span><br><span class="line">  - 监听本身并不负责与用户进程进行数据交互，而仅是指导服务器进程，与哪个用户进程建立连接</span><br><span class="line">  - 监听只是在建立连接时会被用到，当连接已经建立后，监听是否存在不会影响到连接的正常运行</span><br><span class="line"></span><br><span class="line">* 默认监听 listener</span><br><span class="line">  - oracle 数据库指定名为 &quot;lisntner&quot; 的监听为默认监听</span><br><span class="line">  - 通常情况下，默认监听运行在 1521 端口</span><br></pre></td></tr></table></figure></li>
<li><strong>配置文件</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">* ORACLE_HOME/network/admin/listener.ora</span><br><span class="line"></span><br><span class="line">* ORACLE_HOME/network/admin/sqlnet.ora</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：listener-ora"><a href="#知识点：listener-ora" class="headerlink" title="知识点：listener.ora"></a>知识点：listener.ora</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 数据库监听的默认启动配置文件</span><br><span class="line">  - 文件位置，ORACLE_HOME/network/admin/listener.ora</span><br><span class="line">  - 模板文件，ORACLE_HOME/network/admin/samples/listener.ora</span><br><span class="line"></span><br><span class="line">* 可配置内容</span><br><span class="line">  - 监听的名字</span><br><span class="line">  - 监听的协议</span><br><span class="line">  - 监听的端口</span><br><span class="line">  - 监听的静态注册</span><br></pre></td></tr></table></figure></li>
<li><strong>监听配置</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"># 一个代码块就代表一个监听配置</span><br><span class="line"># 支持使用井号 &quot;#&quot; 表示注释</span><br><span class="line"># 允许空行</span><br><span class="line"># 断行、缩进不影响语义</span><br><span class="line"></span><br><span class="line">Listener_Name =</span><br><span class="line">    (DESCRIPTION_LIST =</span><br><span class="line">        (DESCRIPTION =</span><br><span class="line">            (ADDRESS = (PROTOCOL = TCP)(HOST = Host_Name)(PORT = Port))</span><br><span class="line">            (ADDRESS = (PROTOCOL = IPC)(KEY = EXTPROC1521))</span><br><span class="line">        )</span><br><span class="line">    )</span><br></pre></td></tr></table></figure></li>
<li><strong>默认监听</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">LISTENER =</span><br><span class="line">    (DESCRIPTION_LIST =</span><br><span class="line">        (DESCRIPTION =</span><br><span class="line">            (ADDRESS = (PROTOCOL = TCP)(HOST = ol7b)(PORT = 1521))</span><br><span class="line">            (ADDRESS = (PROTOCOL = IPC)(KEY = EXTPROC1521))</span><br><span class="line">        )</span><br><span class="line">    )</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：lsnrctl"><a href="#知识点：lsnrctl" class="headerlink" title="知识点：lsnrctl"></a>知识点：lsnrctl</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - os 提供的，用于操作监听的指令</span><br></pre></td></tr></table></figure></li>
<li><strong>格式</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">* lsnrctl start</span><br><span class="line">* lsnrctl start Listener_Name</span><br><span class="line">  - 启动监听</span><br><span class="line"></span><br><span class="line">* lsnrctl status Listener_Name</span><br><span class="line">  - 查看监听信息</span><br><span class="line"></span><br><span class="line">* lsnrctl service Service_Name</span><br><span class="line">  - 查看 service 信息</span><br><span class="line">  - established，表示已经建立过几次连接，而不是现在有多少个连接</span><br><span class="line">  - 反馈的信息只是一个粗粒度的信息，详细信息需要看 V$SESSION</span><br><span class="line"></span><br><span class="line">* lsnrctl reload Listener_Name</span><br><span class="line">  - 重启监听</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h2 id="8-5-服务"><a href="#8-5-服务" class="headerlink" title="8.5 服务"></a>8.5 服务</h2><hr>
<h3 id="知识点：服务"><a href="#知识点：服务" class="headerlink" title="知识点：服务"></a>知识点：服务</h3><ol>
<li><strong>服务</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">* 服务 service</span><br><span class="line">  - 相当于 listener 的入口 entity</span><br><span class="line">  - 用于指导 listener 应该与哪个数据库实例建立连接，以及建立连接的方式为共享或专有</span><br><span class="line"></span><br><span class="line">* 注册 register</span><br><span class="line">  - 在监听中添加其关注的服务，称为注册</span><br><span class="line">  - 分为静态注册和动态注册</span><br><span class="line"></span><br><span class="line">* 服务名的格式</span><br><span class="line">  - 在数据库中指定 service_name</span><br><span class="line">  - 在监听中注册时，服务名 service_name[.db_domain]</span><br><span class="line"></span><br><span class="line">* 默认服务</span><br><span class="line">  - 数据库默认会创建一个名为 db_name 的服务，可以连接传统架构数据库或 CDB</span><br><span class="line">  - 对于 PDB，数据库默认会对每个 PDB 创建一个名为 pdb_name 的服务，可以连接到此 PDB</span><br><span class="line"></span><br><span class="line">* 服务的意义</span><br><span class="line">  - 一个数据库实例，可以配置多个服务，针对不同类型的应用，分别连接相应的服务，从而实现对用户和应用的资源的管控</span><br><span class="line"></span><br><span class="line">* 服务的限制</span><br><span class="line">  - 一个数据库最多创建 512 个服务</span><br><span class="line">  - 每一个 PDB 的 service 数量都要小于 cdb 的 service 数量</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
<li><strong>相关参数</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">* service_names</span><br><span class="line">  - 指定动态注册的 service</span><br><span class="line">  - 只对 cdb 生效，不能连接 pdb</span><br><span class="line">  - 已废弃</span><br><span class="line"></span><br><span class="line">* db_domain</span><br><span class="line">  - 记录了数据库的域名</span><br></pre></td></tr></table></figure></li>
<li><strong>相关数据字典</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">* dba_services</span><br><span class="line"></span><br><span class="line">* v$services</span><br><span class="line"></span><br><span class="line">* v$service_stats</span><br><span class="line"></span><br><span class="line">* v$statname</span><br><span class="line"></span><br><span class="line">* v$service_event</span><br><span class="line"></span><br><span class="line">* v$servicemetric</span><br><span class="line"></span><br><span class="line">* v$active_services</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：静态注册"><a href="#知识点：静态注册" class="headerlink" title="知识点：静态注册"></a>知识点：静态注册</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 静态注册，在监听的配置文件 listener.ora 中的 SID_LIST_ListenerName 中，写死服务的配置</span><br><span class="line">  - 监听在启动时，会自动注册此服务</span><br><span class="line">  - SID_LIST_ListenerName 中的 ListenerName，指明配置的静态注册服务是针对的哪一个监听</span><br><span class="line">  - 静态注册的服务的配置信息保留在监听的配置中，在监听的配置文件中添加相应的代码就视为创建静态注册的服务</span><br><span class="line">  - 数据库中并不保存静态监听的服务，实际上即使数据库实例并没有启动，sys 用户也可以通过静态注册服务连接到数据库实例</span><br><span class="line">  - 静态注册的服务，状态都是 unknown</span><br></pre></td></tr></table></figure></li>
<li><strong>添加静态注册</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># vim listener.ora</span><br><span class="line"># ServiceName 和 DatabaseSID 都必须使用小写</span><br><span class="line"></span><br><span class="line">SID_LIST_ListenerName=</span><br><span class="line">    (SID_LIST=</span><br><span class="line">        (SID_DESC = (GLOBAL_DBNAME = ServiceName) (SID_NAME = DatabaseSID) (ORACLE_HOME=OracleHome))</span><br><span class="line">        (SID_DESC = (GLOBAL_DBNAME = ServiceName_2) (SID_NAME = DatabaseSID_2) (ORACLE_HOME=OracleHome))</span><br><span class="line">    )</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：动态注册"><a href="#知识点：动态注册" class="headerlink" title="知识点：动态注册"></a>知识点：动态注册</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 动态注册 dynamic registration，在数据库中保存相关的服务的配置信息，在数据库实例的运行过程中，动态的在监听中注册服务</span><br><span class="line">  - 数据库中只会保存动态注册的服务的信息</span><br><span class="line">  - 通过 DBMS_SERVICE 包中的程序来创建和管理动态注册的服务</span><br><span class="line">  - LREG 进程进行动态注册，11G 及以前由 PMON 进行注册</span><br><span class="line">  - 动态注册的服务，状态是 ready</span><br><span class="line"></span><br><span class="line">* 动态注册的频率</span><br><span class="line">  - 数据库启动到 mount 时，对 CDB 进行注册</span><br><span class="line">  - 数据库启动到 open 时，对 PDB 进行注册</span><br><span class="line">  - 数据库运行时，每隔一分钟进行一次注册</span><br><span class="line">  - 数据库关闭时，将 service 进行撤销</span><br><span class="line"></span><br><span class="line">* 配置动态注册</span><br><span class="line">  - dbms_service</span><br><span class="line">  - netca</span><br></pre></td></tr></table></figure></li>
<li><strong>相关参数</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">* local_listener</span><br><span class="line">  - 指定动态注册时使用的 tnsname，继而确认动态注册的目标监听</span><br><span class="line">  - 内容为指向 tnsname.ora 中配置的一个 tnsname，里面记录了本地的一个监听的端口</span><br><span class="line">  - oracle 在进行动态注册时，将服务注册到此监听上</span><br><span class="line">  - local_listener 是静态参数，若启动数据库时，tnsname.ora 的内容无效，则数据库运行过程中无法进行动态注册</span><br><span class="line">  - 多监听注册</span><br><span class="line">    - 在 local_listener 中配置多个 tnsname，使用逗号分隔</span><br><span class="line">    - 默认在进行动态注册时，会在 local_listener 指向的所有监听的上注册数据库的所有服务</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：动态注册操作"><a href="#知识点：动态注册操作" class="headerlink" title="知识点：动态注册操作"></a>知识点：动态注册操作</h3><ol>
<li><strong>添加动态注册 service</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">* 进入相应的环境，如 CDB、PDB</span><br><span class="line"></span><br><span class="line">* 创建 service: EXEC DBMS_SERVICE.CREATE_SERVICE(&#x27;Service_Name&#x27;, &#x27;Network_Name&#x27;) ;</span><br><span class="line">  - Network_Name 和 Service_Name 相同</span><br><span class="line"></span><br><span class="line">* 启动 service: EXEC DBMS_SERVICE.START_SERVICE(&#x27;Service_Name&#x27;) ;</span><br><span class="line"></span><br><span class="line">* 注册 service: ALTER SYSTEM REGISTER ;</span><br><span class="line"></span><br><span class="line">* 将修改持久化</span><br><span class="line">  - ALTER PLUGGABLE DATABASE SAVE STATE ;</span><br><span class="line">  - ALTER PLUGGABLE DATABASE Pdb_Name SAVE STATE ;</span><br><span class="line">  - ALTER PLUGGABLE DATABASE CDB$ROOT SAVE STATE ;</span><br></pre></td></tr></table></figure></li>
<li><strong>删除动态注册 service</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">* 进入相应的环境，如 CDB、PDB</span><br><span class="line"></span><br><span class="line">* 停用 service: EXEC DBMS_SERVICE.STOP_SERVICE(&#x27;Service_Name&#x27;) ;</span><br><span class="line"></span><br><span class="line">* 删除 service: EXEC DBMS_SERVICE.DELETE_SERVICE(&#x27;Service_Name&#x27;) ;</span><br><span class="line"></span><br><span class="line">* 保存修改: ALTER PLUGGABLE DATABASE SAVE STATE ;</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h2 id="8-6-tnsname"><a href="#8-6-tnsname" class="headerlink" title="8.6 tnsname"></a>8.6 tnsname</h2><hr>
<h3 id="知识点：tnsname-介绍"><a href="#知识点：tnsname-介绍" class="headerlink" title="知识点：tnsname 介绍"></a>知识点：tnsname 介绍</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 本地命名方法 Local Naming Method</span><br><span class="line">  - 在 tnsname.ora 中配置 tnsname，用来代表一个连接描述符 connect descriptor</span><br><span class="line"></span><br><span class="line">* tnsname 的优点</span><br><span class="line">  - tnsname 支持加密传输，支持高级网络功能，支持除 TCP 以外的其他连接协议</span><br><span class="line">  - 高级网络功能包括</span><br><span class="line">    - connect-time failover 连接故障转移</span><br><span class="line">    - load balancing 负载均衡</span><br><span class="line">    - source routing 源原地址转移</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：tnsname-ora-语法"><a href="#知识点：tnsname-ora-语法" class="headerlink" title="知识点：tnsname.ora 语法"></a>知识点：tnsname.ora 语法</h3><ol>
<li><strong>基础语法</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">Tns_Name =</span><br><span class="line">    (DESCRIPTION =</span><br><span class="line">        (ADDRESS =</span><br><span class="line">            (PROTOCOL = TCP)</span><br><span class="line">            (HOST = Host_Name)</span><br><span class="line">            (PORT = Port)</span><br><span class="line">        )</span><br><span class="line">        (CONNECT_DATA =</span><br><span class="line">            [(SERVER = DEDICATED|SHARED)]</span><br><span class="line">            (SERVICE_NAME = Service_Name)</span><br><span class="line">            [(INSTANCE_NAME=Instance_Name)]</span><br><span class="line">        )</span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line">Tns_Ipc_Name =</span><br><span class="line">    (DESCRIPTION =</span><br><span class="line">        (ADDRESS =</span><br><span class="line">            (PROTOCOL = IPC)</span><br><span class="line">            (HOST = Host_Name)</span><br><span class="line">            (PORT = Port) )</span><br><span class="line">        (CONNECT_DATA =</span><br><span class="line">            [(SERVER = DEDICATED|SHARED)]</span><br><span class="line">            (SERVICE_NAME = Service_Name)</span><br><span class="line">            [(INSTANCE_NAME=Instance_Name)]</span><br><span class="line">        )</span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line"># 默认内容，进行动态注册的 tnsname</span><br><span class="line"># tnsname 需要与数据库的 local_listener 参数值的配置相同</span><br><span class="line">Tns_Name =</span><br><span class="line">    (ADDRESS =</span><br><span class="line">        (PROTOCOL = TCP)</span><br><span class="line">        (HOST = Host)</span><br><span class="line">        (PORT = Port)</span><br><span class="line">    )</span><br></pre></td></tr></table></figure></li>
<li><strong>配置监听故障转移</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">PDB1=</span><br><span class="line">    (DESCRIPTION=</span><br><span class="line">        (ADDRESS_LIST=</span><br><span class="line">            (ADDRESS=(PROTOCOL=tcp)(HOST=ocm1.example.com)(PORT=1521))    # 故障转移需要配置多个监听端口</span><br><span class="line">            (ADDRESS=(PROTOCOL=tcp)(HOST=ocm1.example.com)(PORT=1525))</span><br><span class="line">        )</span><br><span class="line">        (CONNECT_DATA=</span><br><span class="line">            (SERVICE_NAME=PROD1.example.com)</span><br><span class="line">            (SERVER=DEDICATED)</span><br><span class="line">        )</span><br><span class="line">        (failover = on)  # 开启故障转移</span><br><span class="line">    )</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：tnsping"><a href="#知识点：tnsping" class="headerlink" title="知识点：tnsping"></a>知识点：tnsping</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - os 指令，测试 tnsname 的物理联通性</span><br><span class="line">  - 只能测试物理联通性</span><br><span class="line">    - 网络是否连通</span><br><span class="line">    - 端口是否开启</span><br><span class="line">    - 不能代表 service 已经注册</span><br></pre></td></tr></table></figure></li>
<li><strong>用法</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">* tnsping tnsname</span><br><span class="line"></span><br><span class="line">* tnsping Host:Port/Service</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h2 id="8-7-dblink"><a href="#8-7-dblink" class="headerlink" title="8.7 dblink"></a>8.7 dblink</h2><hr>
<h3 id="知识点：dblink-介绍"><a href="#知识点：dblink-介绍" class="headerlink" title="知识点：dblink 介绍"></a>知识点：dblink 介绍</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 单向的指针，定义从 remote oracle 到 local oracle 的单向通信路径</span><br><span class="line">  - 本地用户通过 dblink 可以访问远程数据库中的数据</span><br><span class="line">  - 在远程数据库上自动变成远程数据库用户的权限</span><br><span class="line"></span><br><span class="line">* 前提</span><br><span class="line">  - 分布式环境中的每个数据库必须具有唯一的全局数据库名 DB_UNIQUE_NAME</span><br><span class="line"></span><br><span class="line">* PUBLIC DATABASE LINK</span><br><span class="line">  - 非常危险，不建议创建</span><br><span class="line">  - 数据库连接无法进行授权</span><br><span class="line">  - 要么为用户创建私有的数据库连接，要么创建 PUBLIC DATABASE LINK</span><br></pre></td></tr></table></figure></li>
<li><strong>相关参数</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">* global_names</span><br><span class="line">  - 设置数据库是否允许 dblink 随便命名</span><br><span class="line">  - 如果为 ture，则 dblink 必须与指向的远程数据库的 global database name 同名</span><br></pre></td></tr></table></figure></li>
<li><strong>相关数据字典</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">* DBA_DB_LINKS</span><br><span class="line">  - 记录当前创建的 dblink</span><br><span class="line"></span><br><span class="line">* DBA_DB_LINK_SOURCES</span><br><span class="line">  - 记录所有指向本地数据库的数据库连接</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：CREATE-DATABASE-LINK"><a href="#知识点：CREATE-DATABASE-LINK" class="headerlink" title="知识点：CREATE DATABASE LINK"></a>知识点：CREATE DATABASE LINK</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 创建 dblink</span><br></pre></td></tr></table></figure></li>
<li><strong>语法</strong><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> [SHARED] [PUBLIC] DATABASE LINK Dblink_Name</span><br><span class="line">  <span class="keyword">CONNECT</span> <span class="keyword">TO</span> Remote_User_Name</span><br><span class="line">  IDENTIFIED <span class="keyword">BY</span> &quot;Remote_User_Password&quot;</span><br><span class="line">  <span class="keyword">USING</span> <span class="string">&#x27;tnsname|Host:Port/Service&#x27;</span></span><br><span class="line">  ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> [SHARED] [PUBLIC] DATABASE LINK Dblink_Name</span><br><span class="line">  <span class="keyword">CONNECT</span> <span class="keyword">TO</span> <span class="built_in">CURRENT_USER</span></span><br><span class="line">  <span class="keyword">USING</span> <span class="string">&#x27;tnsname|Host:Port/Service&#x27;</span></span><br><span class="line">  ;</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：DROP-DATABASE-LINK"><a href="#知识点：DROP-DATABASE-LINK" class="headerlink" title="知识点：DROP DATABASE LINK"></a>知识点：DROP DATABASE LINK</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 删除 dblink</span><br></pre></td></tr></table></figure></li>
<li><strong>语法</strong><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> [PUBLIK] DATABASE LINK Dblink_Name ;</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：ALTER-DATABASE-LINK"><a href="#知识点：ALTER-DATABASE-LINK" class="headerlink" title="知识点：ALTER DATABASE LINK"></a>知识点：ALTER DATABASE LINK</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 修改 dblink 的目标用户或密码</span><br><span class="line">  - 比较鸡肋，dblink 完全可以删了重建</span><br></pre></td></tr></table></figure></li>
<li><strong>语法</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ALTER [SHARED] [PUBLIC] DATABASE LINK dblink</span><br><span class="line">  CONNECT TO Remote_User_Name</span><br><span class="line">  IDENTIFIED BY &quot;Remote_User_Password&quot;</span><br><span class="line">  ;</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h2 id="8-8-netca"><a href="#8-8-netca" class="headerlink" title="8.8 netca"></a>8.8 netca</h2><hr>
<h3 id="知识点：netca"><a href="#知识点：netca" class="headerlink" title="知识点：netca"></a>知识点：netca</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - oracle 提供的，支持图形化的监听管理工具</span><br><span class="line"></span><br><span class="line">* 响应文档</span><br><span class="line">  - $ORACLE_HOME/assistants/netca/netca.rsp</span><br></pre></td></tr></table></figure></li>
<li><strong>netca 指令</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netca [-silent] Command Options</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：netca-创建默认监听"><a href="#知识点：netca-创建默认监听" class="headerlink" title="知识点：netca 创建默认监听"></a>知识点：netca 创建默认监听</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netca -silent -responsefile $ORACLE_HOME/assistants/netca/netca.rsp</span><br></pre></td></tr></table></figure>

<hr>
<h1 id="Chapter09-安装和建库"><a href="#Chapter09-安装和建库" class="headerlink" title="Chapter09 安装和建库"></a>Chapter09 安装和建库</h1><hr>
<h2 id="9-1-安装"><a href="#9-1-安装" class="headerlink" title="9.1 安装"></a>9.1 安装</h2><hr>
<h3 id="知识点：Oracle-安装介绍"><a href="#知识点：Oracle-安装介绍" class="headerlink" title="知识点：Oracle 安装介绍"></a>知识点：Oracle 安装介绍</h3><ol>
<li><strong>硬件要求</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">* 内存</span><br><span class="line">  - 软限制，不小于 4G</span><br><span class="line"></span><br><span class="line">* SWAP</span><br><span class="line">  - 软限制，不小于物理内存</span><br></pre></td></tr></table></figure></li>
<li><strong>zip 包的解压</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">* 18c 以前</span><br><span class="line">  - zip 包解压后，解压的文件仅用作安装</span><br><span class="line"></span><br><span class="line">* 18c 及以后</span><br><span class="line">  - zip 包解压后，解压出的文件应当作为数据库软件的一部分</span><br></pre></td></tr></table></figure></li>
<li><strong>preinstall</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - oracle 提供的，进行数据库安装前准备的 rpm 包，会自动创建用户和组、安全依赖包、修改内核配置，等</span><br><span class="line">  - 仅适用于 OracleLinux 和 RedHat</span><br><span class="line">  - 不建议在 Centos 上使用</span><br><span class="line"></span><br><span class="line">* centos7 安装 oracle7 yum 源</span><br><span class="line">  wget http://public-yum.oracle.com/public-yum-ol7.repo</span><br><span class="line">  wget http://public-yum.oracle.com/RPM-GPG-KEY-oracle-ol7 -O /etc/pki/rpm-gpg/RPM-GPG-KEY-oracle</span><br><span class="line">  yum -y install oracle-epel-release-el7.x86_64</span><br><span class="line">  cp oracle-epel-ol7.repo.incomplete oracle-epel-ol7.repo</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：Oracle-安装准备操作"><a href="#知识点：Oracle-安装准备操作" class="headerlink" title="知识点：Oracle 安装准备操作"></a>知识点：Oracle 安装准备操作</h3><ol>
<li><strong>处理防火墙和 selinux</strong></li>
<li><strong>建立用户和组</strong><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">useradd oracle</span><br><span class="line">groupadd oinstall</span><br><span class="line">groupadd dba</span><br><span class="line">groupadd oper</span><br><span class="line">groupadd asmdba</span><br><span class="line">groupadd backupdba</span><br><span class="line">groupadd dgdba</span><br><span class="line">groupadd kmdba</span><br><span class="line">groupadd racdba</span><br><span class="line">usermod -aG oinstall,dba,oper,asmdba,backupdba,dgdba,kmdba,racdba,wheel oracle</span><br><span class="line">usermod -g oinstall oracle</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
<li><strong>配置环境变量</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">export ORACLE_BASE=/u01/app/oracle/product</span><br><span class="line">export ORACLE_HOME=/u01/app/oracle/product/database/19c</span><br><span class="line">export ORACLE_SID=test</span><br><span class="line">export PATH=$PATH:$ORACLE_HOME/bin</span><br><span class="line">export NLS_LANG=&#x27;simplified chinese_china.al32utf8&#x27;</span><br><span class="line"></span><br><span class="line">alias sqlplus=&#x27;rlwrap sqlplus&#x27;</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
<li><strong>创建目录</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mkdir -p /u01/app/oracle/product/database/19c</span><br><span class="line">chown -R oracle:oinstall /u01/app/oracle</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
<li><strong>安装依赖包</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">yum -y install bc mlocate unzip vim bash-completion epel-release \</span><br><span class="line">  binutils compat-libcap1 compat-libstdc++-33 elfutils-libelf \</span><br><span class="line">  elfutils-libelf-devel fontconfig-devel gcc-c++ glibc glibc-devel ksh \</span><br><span class="line">  libaio libaio-devel libXrender libXrender-devel libX11 libXau libXi libXtst \</span><br><span class="line">  libgcc libstdc++ libstdc++-devel libxcb \</span><br><span class="line">  make \</span><br><span class="line">  policycoreutils policycoreutils-python \</span><br><span class="line">  smartmontools \</span><br><span class="line">  sysstat \</span><br><span class="line">  ;</span><br><span class="line"></span><br><span class="line">yum -y install rlwrap ;</span><br><span class="line"></span><br><span class="line">yum -y groupinstall &#x27;GNOME Desktop&#x27; ;</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
<li><strong>修改内核参数</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">* kernel.shmmax、kernel.shmall、kernel.shmmni</span><br><span class="line">  - kernel.shmmax</span><br><span class="line">    - 定义了 OS 级别共享内存段的最大尺寸，单位为字节</span><br><span class="line">    - 应当大于物理内存的一半，小于物理内存</span><br><span class="line">    - 应当大于 sag_max_size</span><br><span class="line">    - 默认值 2G</span><br><span class="line">    - 通常都需要进行修改</span><br><span class="line">    - 推荐值，物理内存 - 1 byte</span><br><span class="line">  - kernel.shmall</span><br><span class="line">    - 定义了 OS 全局设置系统范围内共享内存段的最大数量，单位为 page(4KB)</span><br><span class="line">    - shmall * 4KB 应当大于 shmmax</span><br><span class="line">    - 推荐值，物理内存/4KB</span><br><span class="line">  - kernel.shmmni</span><br><span class="line">    - 定义 OS 全局共享内存段的最大数量，单位为个数</span><br><span class="line">    - 默认值 4096</span><br><span class="line">    - 通常不需要修改</span><br><span class="line"></span><br><span class="line">* fs.file-max</span><br><span class="line">  - 表示一个进程可以打开的文件句柄的最大数量</span><br><span class="line">  - Oracle 规定的最小值 6815744</span><br><span class="line"></span><br><span class="line">* fs.aio-max-nr</span><br><span class="line">  - 同时可以拥有的异步 IO 请求数</span><br><span class="line">  - Oracle 规定的最小值 1048576</span><br><span class="line"></span><br><span class="line">* kernel.sem</span><br><span class="line">  - 设置信号量，分别对应 semmsl、semmns、semopm、semmni</span><br><span class="line"></span><br><span class="line">* net.ipv4.ip_local_port_range</span><br><span class="line">  - 专用服务器模式下，与用户进程通信时分配给用户的端口区间</span><br><span class="line">  - Oracle 规定，最小不能低于 9000，最大不能高于 65500</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"># vim /etc/sysctl.conf，追加以下内容</span><br><span class="line"># 除了 kernel.shmmax 和 kernel.shmall，其他基本不需要修改</span><br><span class="line"></span><br><span class="line"># oracle</span><br><span class="line">kernel.shmmax = 8318771200          # 按照实际情况进行修改</span><br><span class="line">kernel.shmall = 2097152             # 安装实际情况进行修改</span><br><span class="line">kernel.shmmni = 4096</span><br><span class="line">kernel.sem = 250 32000 100 128</span><br><span class="line">fs.aio-max-nr = 1048576</span><br><span class="line">fs.file-max = 6815744</span><br><span class="line">net.ipv4.ip_local_port_range = 9000 65500</span><br><span class="line">net.core.rmem_default = 262144</span><br><span class="line">net.core.rmem_max = 4194304</span><br><span class="line">net.core.wmem_default = 262144</span><br><span class="line">net.core.wmem_max = 1048576</span><br><span class="line"></span><br><span class="line"># 编辑完成后，执行 sysctl -p 使参数生效</span><br></pre></td></tr></table></figure></li>
<li><strong>修改系统资源限制</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">* nproc</span><br><span class="line">  - 单个用户的最大进程数</span><br><span class="line">  - Oracle 规定，Soft Limit 不低于 2047，Hard Limit 不低于 16384</span><br><span class="line"></span><br><span class="line">* nofile</span><br><span class="line">  - 单个用户的最大 Open file descriptor 数</span><br><span class="line">  - Oracle 规定，Soft Limit 不低于 1024，Hard Limit 不低于 65536</span><br><span class="line"></span><br><span class="line">* stack</span><br><span class="line">  - 进程的 stack segment 大小，单位为 KB</span><br><span class="line">  - Oracle 规定，Soft Limit 不低于 10240，Hard Limit 不低于 10240，不高于 32768</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"># vim /etc/security/limits.conf，追加以下内容</span><br><span class="line"></span><br><span class="line"># oracle</span><br><span class="line">oracle            soft    nproc   2047</span><br><span class="line">oracle            hard    nproc   16384</span><br><span class="line">oracle            soft    nofile  1024</span><br><span class="line">oracle            hard    nofile  65536</span><br><span class="line">oracle            soft    stack   10240</span><br><span class="line">oracle            hard    stack   32768</span><br></pre></td></tr></table></figure></li>
<li><strong>配置验证方式</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># vim /etc/pam.d/login，追加以下内容</span><br><span class="line"></span><br><span class="line"># oracle</span><br><span class="line">session    required     pam_limits.so</span><br></pre></td></tr></table></figure></li>
<li><strong>配置图形化界面</strong><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 查看显示器的名称</span></span><br><span class="line">[root@localhost ~]# xdpyinfo | grep name</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 启用普通用户对显示器的访问权限</span></span><br><span class="line">[root@localhost ~]# export DISPLAY=$(xdpyinfo |grep name | awk &#x27;&#123;print $NF&#125;&#x27;)</span><br><span class="line">[root@localhost ~]# xhost +</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 复制 Xserver 的认证</span></span><br><span class="line">[root@localhost ~]# cp ~/.Xauthority /home/oracle/</span><br><span class="line">[root@localhost ~]# chown oracle:oinstall /home/oracle/.Xauthority</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> oracle 配置显示器</span></span><br><span class="line">[oracle@localhost ~]$ export DISPLAY=&#x27;localhost:11.0&#x27;</span><br><span class="line">[oracle@localhost ~]$ xdpyinfo</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：runInstaller-介绍"><a href="#知识点：runInstaller-介绍" class="headerlink" title="知识点：runInstaller 介绍"></a>知识点：runInstaller 介绍</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - Oracle 默认的数据库软件安装升级工具</span><br><span class="line"></span><br><span class="line">* runInstaller 的日志</span><br><span class="line">  - 安装过程中，安装日志会被放在 /tmp 中</span><br><span class="line">  - 安装完成后，安装日志会移动到 orainventory 中</span><br><span class="line"></span><br><span class="line">* runInstaller 的两个 root 脚本</span><br><span class="line">  - $ORACLE_Inventory/orainstRoot.sh，在 orainventory 中注册数据库</span><br><span class="line">  - $ORACLE_HOME/root.sh ，创建 /etc/oratab 文件</span><br><span class="line">  - 19c 以前，需要手动切换到 root 用户进行执行</span><br><span class="line">  - 19c 及以后，可以在安装时指定 root 密码，runInstaller 在安装过程中会自动执行这两个脚本</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：runInstaller-运行参数"><a href="#知识点：runInstaller-运行参数" class="headerlink" title="知识点：runInstaller 运行参数"></a>知识点：runInstaller 运行参数</h3><ol>
<li><strong>格式</strong><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./runInstaller [Flags [Option] ]</span><br></pre></td></tr></table></figure></li>
<li><strong>基本 Flag</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">* -help</span><br><span class="line">  - 显示帮助内容</span><br></pre></td></tr></table></figure></li>
<li><strong>静默 Flag</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">* -silent</span><br><span class="line">  - 静默运行</span><br><span class="line"></span><br><span class="line">* -ignorePrereqFailure</span><br><span class="line">  - &quot;-silent&quot; Flag 的选项，忽略检查时发现的错误</span><br><span class="line"></span><br><span class="line">* -responseFile</span><br><span class="line">  - 指定使用的响应文档</span><br><span class="line"></span><br><span class="line">* -noconfig</span><br><span class="line">  - 仅安装软件，不运行配置助手建库</span><br></pre></td></tr></table></figure></li>
<li><strong>日志 Flag</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">* -logLevel</span><br><span class="line">  - 指定 runInstaller 的日志消息的级别</span><br><span class="line">  - 可选值包括 severe、warning、info、config、fine、finer、finest</span><br><span class="line"></span><br><span class="line">* -debug</span><br><span class="line">  - 运行在 debug mode</span><br><span class="line"></span><br><span class="line">* -printdiskusage</span><br><span class="line">* -printmemory</span><br><span class="line">* -printtime</span><br><span class="line">  - 打印相关内容的 debug 信息</span><br></pre></td></tr></table></figure></li>
<li><strong>其他</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">* -executePrereqs | -executeConfigTools | -createGoldImage</span><br><span class="line">  -executePrereqs     - execute the prerequisite checks only.</span><br><span class="line">  -executeConfigTools - execute the config tools for an installed home.</span><br><span class="line">      [-all - execute all the config tools for an installed home, including the config tools that have already succeeded.]</span><br><span class="line">  -createGoldImage    - create a gold image from the current Oracle home.</span><br><span class="line">      -destinationLocation - specify the complete path to where the created gold image will be located.</span><br><span class="line">      [-exclFiles - specify the complete paths to the files to be excluded from the new gold image.]</span><br><span class="line"></span><br><span class="line">* -waitForCompletion</span><br><span class="line">  - wait for the completion of the installation, instead of spawning the installer and returning the console prompt.</span><br><span class="line"></span><br><span class="line">* -noconsole</span><br><span class="line">  - suppress the display of messages in the console. The console is not allocated.</span><br><span class="line"></span><br><span class="line">* -ignoreInternalDriverError</span><br><span class="line">  - ignore any internal driver errors.</span><br><span class="line"></span><br><span class="line">* -noCopy</span><br><span class="line">  - perform the configuration without copying the software on to the remote nodes.</span><br><span class="line"></span><br><span class="line">* -applyRU</span><br><span class="line">  - apply release update to the Oracle home.</span><br><span class="line"></span><br><span class="line">* -applyOneOffs</span><br><span class="line">  - apply one-off patch to the Oracle home. Multiple one-off patches can be passed as a comma separated list of locations.</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：runinstaller-响应文档"><a href="#知识点：runinstaller-响应文档" class="headerlink" title="知识点：runinstaller 响应文档"></a>知识点：runinstaller 响应文档</h3><ol>
<li><p><strong>介绍</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 响应文档 respond file，记录对数据库软件的安装的详细要求</span><br><span class="line">  - 相应文档必须以 &quot;.rsp&quot; 结尾</span><br><span class="line">  - 相应文档模板放在 $ORACLE_HOME/install/response/db_install.rsp</span><br><span class="line">  - 相应文档中的项，可以没有值，但不能整行删除</span><br></pre></td></tr></table></figure></li>
<li><p><strong>基础配置</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">* oracle.install.responseFileVersion=/oracle/install/rspfmt_dbinstall_response_schema_v18.0.0</span><br><span class="line">  - 基础参数，必须加，也不能改</span><br><span class="line"></span><br><span class="line">* oracle.install.option</span><br><span class="line">  - 安装的方式</span><br><span class="line">  - INSTALL_DB_SWONLY 表示仅安装软件</span><br><span class="line">  - INSTALL_DB_AND_CONFIG 表示安装软件并建库</span><br><span class="line"></span><br><span class="line">* UNIX_GROUP_NAME</span><br><span class="line">  - 指定安装组，即 oinstall</span><br><span class="line"></span><br><span class="line">* INVENTORY_LOCATION</span><br><span class="line">  - 指定注册目录的位置，即 oraInventory 的位置</span><br><span class="line"></span><br><span class="line">* ORACLE_HOME</span><br><span class="line">  - 指定 ORACLE_HOME 的位置</span><br><span class="line"></span><br><span class="line">* ORACLE_BASE</span><br><span class="line">  - 指定 ORACLE_BASE 的位置</span><br><span class="line"></span><br><span class="line">* oracle.install.db.InstallEdition</span><br><span class="line">  - 指定软件的安装版本</span><br><span class="line">  - EE 表示 Enterprise Edition</span><br><span class="line">  - SE2 表示Standard Edition 2</span><br><span class="line"></span><br><span class="line">* oracle.install.db.OSDBA_GROUP=dba</span><br><span class="line">* oracle.install.db.OSOPER_GROUP=oper</span><br><span class="line">* oracle.install.db.OSBACKUPDBA_GROUP=backupdba</span><br><span class="line">* oracle.install.db.OSDGDBA_GROUP=dgdba</span><br><span class="line">* oracle.install.db.OSKMDBA_GROUP=kmdba</span><br><span class="line">* oracle.install.db.OSRACDBA_GROUP=racdba</span><br><span class="line">  - 指定 Oracle 软件的各种组</span><br></pre></td></tr></table></figure></li>
<li><p><strong>Root 配置</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 19c 新增，用于配置 runInstaller 自动执行那两个 root 脚本</span><br><span class="line">  - 如果开启自动执行 root 脚本的功能，则在安装过程中会提示在 console 上输入 root 密码</span><br><span class="line"></span><br><span class="line">* oracle.install.db.rootconfig.executeRootScript=true</span><br><span class="line">  - 设置 runInstaller 是否开启自动执行 root 脚本的功能</span><br><span class="line"></span><br><span class="line">* oracle.install.db.rootconfig.configMethod</span><br><span class="line">  - 设置 runInstaller 自动执行 root 脚本的方式</span><br><span class="line">  - 可选值，ROOT、SUDO</span><br><span class="line">  - 推荐 ROOT</span><br><span class="line"></span><br><span class="line">* oracle.install.db.rootconfig.sudoPath</span><br><span class="line">* oracle.install.db.rootconfig.sudoUserName</span><br><span class="line">  - SUDO 方式相关</span><br></pre></td></tr></table></figure></li>
<li><p><strong>GRID 配置</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">* oracle.install.db.config.asm.diskGroup</span><br><span class="line">* oracle.install.db.config.asm.ASMSNMPPassword</span><br><span class="line">* oracle.install.db.CLUSTER_NODES</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>starterdb 配置</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 用于配置在安装时指定创建一个初始数据库</span><br><span class="line">  - 若 oracle.install.option=INSTALL_DB_SWONLY，则这些配置会被自动忽略</span><br><span class="line"></span><br><span class="line">* oracle.install.db.config.starterdb.type</span><br><span class="line">* oracle.install.db.config.starterdb.globalDBName</span><br><span class="line">* oracle.install.db.config.starterdb.SID</span><br><span class="line">* oracle.install.db.ConfigureAsContainerDB</span><br><span class="line">* oracle.install.db.config.PDBName</span><br><span class="line">* oracle.install.db.config.starterdb.characterSet</span><br><span class="line">* oracle.install.db.config.starterdb.memoryOption</span><br><span class="line">* oracle.install.db.config.starterdb.memoryLimit</span><br><span class="line">* oracle.install.db.config.starterdb.installExampleSchemas</span><br><span class="line">  - 指定初始库的基本配置</span><br><span class="line"></span><br><span class="line">* oracle.install.db.config.starterdb.password.ALL</span><br><span class="line">* oracle.install.db.config.starterdb.password.SYS</span><br><span class="line">* oracle.install.db.config.starterdb.password.SYSTEM</span><br><span class="line">* oracle.install.db.config.starterdb.password.DBSNMP</span><br><span class="line">* oracle.install.db.config.starterdb.password.PDBADMIN</span><br><span class="line">  - 指定初始库的密码</span><br><span class="line"></span><br><span class="line">* oracle.install.db.config.starterdb.managementOption</span><br><span class="line">* oracle.install.db.config.starterdb.omsHost</span><br><span class="line">* oracle.install.db.config.starterdb.omsPort</span><br><span class="line">* oracle.install.db.config.starterdb.emAdminUser</span><br><span class="line">* oracle.install.db.config.starterdb.emAdminPassword</span><br><span class="line">  - 指定初始库的 EM</span><br><span class="line"></span><br><span class="line">* oracle.install.db.config.starterdb.enableRecovery</span><br><span class="line">* oracle.install.db.config.starterdb.storageType</span><br><span class="line">* oracle.install.db.config.starterdb.fileSystemStorage.dataLocation</span><br><span class="line">* oracle.install.db.config.starterdb.fileSystemStorage.recoveryLocation</span><br><span class="line">  - 指定初始库的存储配置</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：runinstaller-静默安装-19c-操作"><a href="#知识点：runinstaller-静默安装-19c-操作" class="headerlink" title="知识点：runinstaller 静默安装 19c 操作"></a>知识点：runinstaller 静默安装 19c 操作</h3><ol>
<li><strong>准备响应文档 vim &#x2F;home&#x2F;oracle&#x2F;db.rsp</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">oracle.install.responseFileVersion=/oracle/install/rspfmt_dbinstall_response_schema_v19.0.0</span><br><span class="line">oracle.install.option=INSTALL_DB_SWONLY</span><br><span class="line">UNIX_GROUP_NAME=oinstall</span><br><span class="line">ORACLE_BASE=/u01/app/oracle/product</span><br><span class="line">ORACLE_HOME=/u01/app/oracle/product/database/19c</span><br><span class="line">INVENTORY_LOCATION=/u01/app/oracle/oraInventory</span><br><span class="line"># PRIVILEGED OPERATING SYSTEM GROUPS #</span><br><span class="line">oracle.install.db.InstallEdition=EE</span><br><span class="line">oracle.install.db.OSDBA_GROUP=dba</span><br><span class="line">oracle.install.db.OSOPER_GROUP=oper</span><br><span class="line">oracle.install.db.OSBACKUPDBA_GROUP=backupdba</span><br><span class="line">oracle.install.db.OSDGDBA_GROUP=dgdba</span><br><span class="line">oracle.install.db.OSKMDBA_GROUP=kmdba</span><br><span class="line">oracle.install.db.OSRACDBA_GROUP=racdba</span><br><span class="line"># Root script execution configuration #</span><br><span class="line">oracle.install.db.rootconfig.executeRootScript=true</span><br><span class="line">oracle.install.db.rootconfig.configMethod=ROOT</span><br><span class="line"># Grid Options #</span><br><span class="line">oracle.install.db.CLUSTER_NODES=</span><br><span class="line"># Database Configuration Options #</span><br><span class="line">oracle.install.db.config.starterdb.type=</span><br><span class="line">oracle.install.db.config.starterdb.globalDBName=</span><br><span class="line">oracle.install.db.config.starterdb.SID=</span><br><span class="line">oracle.install.db.ConfigureAsContainerDB=</span><br><span class="line">oracle.install.db.config.PDBName=</span><br><span class="line">oracle.install.db.config.starterdb.characterSet=</span><br><span class="line">oracle.install.db.config.starterdb.memoryOption=</span><br><span class="line">oracle.install.db.config.starterdb.memoryLimit=</span><br><span class="line">oracle.install.db.config.starterdb.installExampleSchemas=</span><br><span class="line">oracle.install.db.config.starterdb.password.ALL=</span><br><span class="line">oracle.install.db.config.starterdb.password.SYS=</span><br><span class="line">oracle.install.db.config.starterdb.password.SYSTEM=</span><br><span class="line">oracle.install.db.config.starterdb.password.DBSNMP=</span><br><span class="line">oracle.install.db.config.starterdb.password.PDBADMIN=</span><br><span class="line">oracle.install.db.config.starterdb.managementOption=</span><br><span class="line">oracle.install.db.config.starterdb.omsHost=</span><br><span class="line">oracle.install.db.config.starterdb.omsPort=</span><br><span class="line">oracle.install.db.config.starterdb.emAdminUser=</span><br><span class="line">oracle.install.db.config.starterdb.emAdminPassword=</span><br><span class="line">oracle.install.db.config.starterdb.enableRecovery=</span><br><span class="line">oracle.install.db.config.starterdb.storageType=</span><br><span class="line">oracle.install.db.config.starterdb.fileSystemStorage.dataLocation=</span><br><span class="line">oracle.install.db.config.starterdb.fileSystemStorage.recoveryLocation=</span><br><span class="line">oracle.install.db.config.asm.diskGroup=</span><br><span class="line">oracle.install.db.config.asm.ASMSNMPPassword=</span><br></pre></td></tr></table></figure></li>
<li><strong>修改环境变量</strong><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">export ORACLE_BASE=/u01/app/oracle/product</span><br><span class="line">export ORACLE_HOME=/u01/app/oracle/product/database/19c</span><br></pre></td></tr></table></figure></li>
<li><strong>运行 runinstaller</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd $ORACLE_HOME</span><br><span class="line">sh runInstaller -silent -ignorePrereqFailure -noconfig -responseFile /home/oracle/db.rsp</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h2 id="9-2-DBCA"><a href="#9-2-DBCA" class="headerlink" title="9.2 DBCA"></a>9.2 DBCA</h2><hr>
<h3 id="知识点：DBCA-介绍"><a href="#知识点：DBCA-介绍" class="headerlink" title="知识点：DBCA 介绍"></a>知识点：DBCA 介绍</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - Database Configuration Assistant，Oracle 提供的建库工具</span><br><span class="line">  - 支持图形化方式，也支持纯命令行方式</span><br><span class="line"></span><br><span class="line">* DBCA 帮助</span><br><span class="line">  - 21c 以前，官方文档没有记录 dbca</span><br><span class="line">  - 21c 中，dbca 有关的帮助记录在 Multitenant Administrator&#x27;s Guide 中</span><br><span class="line">  - DBCA 图形化启动后，可以点击 &quot;Help&quot; 按钮查看相应的页面的帮助</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
<li><strong>DBCA 指令格式</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">* 21c 以前格式</span><br><span class="line">  dbca [Flag] [Ccommand Option]</span><br><span class="line"></span><br><span class="line">* 21c 开始的格式</span><br><span class="line">  dbca [-silent] [Command [Options]] [-h|-help]</span><br><span class="line"></span><br><span class="line">* -silent</span><br><span class="line">  - 静默模式</span><br><span class="line"></span><br><span class="line">* -h|-help</span><br><span class="line">  - 查看 Command 帮助，如 dbca -createDatabase -help</span><br></pre></td></tr></table></figure></li>
<li><strong>DBCA 指令 Flag</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - Flag 相当于 DBCA 指令的选项，只在 21C 以前的版本存在</span><br><span class="line"></span><br><span class="line">* -contextId RAC | SI</span><br><span class="line">  - 指定实例的方式，是否 RAC 实例</span><br><span class="line">  - 默认 SI，SingleInstance</span><br><span class="line"></span><br><span class="line">* -ignorePreReqs</span><br><span class="line">  - 不进行安装前检查</span><br><span class="line"></span><br><span class="line">* -ignorePrereqFailure</span><br><span class="line">  - 忽略安装前检查中的失败情况</span><br></pre></td></tr></table></figure></li>
<li><strong>DBCA Command</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">* -createDatabase</span><br><span class="line">  - 创建数据库，Command to Create a database.</span><br><span class="line"></span><br><span class="line">* -createPluggableDatabase</span><br><span class="line">  - 创建 PDB，Command to Create a pluggable database.</span><br><span class="line"></span><br><span class="line">* -configureDatabase</span><br><span class="line">  - 修改数据库的配置，Command to Configure a database.</span><br><span class="line"></span><br><span class="line">* -configurePluggableDatabase</span><br><span class="line">  - 修改 pdb 的配置，Command to Configure a pluggable database.</span><br><span class="line"></span><br><span class="line">* -deleteDatabase</span><br><span class="line">  - 删除数据库，Command to Delete a database.</span><br><span class="line"></span><br><span class="line">* -deletePluggableDatabase</span><br><span class="line">  - 删除 PDB，Command to Delete a pluggable database.</span><br><span class="line"></span><br><span class="line">* 其他</span><br><span class="line">  -addInstance                - Add an instance to an admin managed cluster database.</span><br><span class="line">  -createCloneTemplate        - Create a clone template from an existing database.</span><br><span class="line">  -createDuplicateDB          - Duplicate a database.</span><br><span class="line">  -createTemplateFromDB       - Create a template from an existing database.</span><br><span class="line">  -createTemplateFromTemplate - Create a template from an existing template.</span><br><span class="line">  -deleteInstance             - Delete an instance from an admin managed cluster database.</span><br><span class="line">  -deleteTemplate             - delete a template.</span><br><span class="line">  -executePrereqs             - execute prerequisite checks.</span><br><span class="line">  -generateScripts            - Generate scripts which can be used to create database.</span><br><span class="line">  -relocatePDB                - Relocate a pluggable database.</span><br><span class="line">  -unplugDatabase             - Unplug a pluggable database.</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：DBCA-createDatabase"><a href="#知识点：DBCA-createDatabase" class="headerlink" title="知识点：DBCA createDatabase"></a>知识点：DBCA createDatabase</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 创建数据库</span><br><span class="line"></span><br><span class="line">* dbca createDatabase 响应文档 response file</span><br><span class="line">  - 与 runInstaller 响应文档相同，也是必须以 &quot;.rsp&quot; 结尾</span><br><span class="line">  - dbca createDatabase 的选项都可以加入到响应文档中</span><br><span class="line">  - dbca createDatabase 命令行上指定的选项会覆盖响应文档中的配置</span><br><span class="line">  - 响应文档模板：$ORACLE_HOME/assistants/dbca/dbca.rsp</span><br><span class="line"></span><br><span class="line">* 指令格式</span><br><span class="line">  dbca -help -createDatabase</span><br><span class="line">  dbca -silent -createDatabase -Options</span><br><span class="line"></span><br><span class="line">* 选项格式</span><br><span class="line">  命令行:    OptionName Value</span><br><span class="line">  响应文档:  OptionName=Value</span><br></pre></td></tr></table></figure></li>
<li><strong>基础选项</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">* responseFileVersion</span><br><span class="line">  - 相应文档的版本</span><br><span class="line">  - 不要改</span><br><span class="line"></span><br><span class="line">* -responseFile File_Location</span><br><span class="line">  - 必要选项，指定使用的响应文档，必须使用绝对路径</span><br><span class="line"></span><br><span class="line">* -gdbName GlobalDatabaseName</span><br><span class="line">  - 必要选项，指定数据库的 Global_Database_Name</span><br><span class="line"></span><br><span class="line">* -templateName FileLocation</span><br><span class="line">  - 必要选项，指定使用的 template 文件，必须使用绝对路径</span><br><span class="line">  - 默认的 template 文件放在 $ORACLE_HOME/assistants/dbca/templates 目录中</span><br><span class="line"></span><br><span class="line">* -sid SID</span><br><span class="line">  - 必要选项，指定实例名 SID</span><br><span class="line"></span><br><span class="line">* -databaseType MULTIPURPOSE|DATA_WAREHOUSING|OLTP</span><br><span class="line">  - 必要选项，指定数据库的类型</span><br><span class="line"></span><br><span class="line">* -databaseConfigType SINGLE|RAC|RACONENODE</span><br><span class="line">  - 必要选项，指定数据库的建立方式</span><br><span class="line"></span><br><span class="line">* -sysPassword PASSWORD</span><br><span class="line">* -systemPassword PASSWORD</span><br><span class="line">  - 必要选项，指定 sys 用户和 system 用户的密码</span><br><span class="line"></span><br><span class="line">* -redoLogFileSize Size</span><br><span class="line">  - 指定 redo 日志的文件大小，单位为 M</span><br><span class="line">  - 如不指定，则默认为 128M</span><br><span class="line"></span><br><span class="line">* -characterSet AL32UTF8</span><br><span class="line">  - 指定数据库的字符集</span><br><span class="line"></span><br><span class="line">* -nationalCharacterSet AL16UTF16</span><br><span class="line">  - 指定数据库的国家字符集</span><br><span class="line"></span><br><span class="line">* -listeners Listener_Name [, ...]</span><br><span class="line">  - 指定数据库使用的监听</span><br><span class="line"></span><br><span class="line">* -createListener Listener_Name:Port</span><br><span class="line">  - 指定同时创建一个新的监听</span><br><span class="line">  - 测试此选项不好用</span><br><span class="line"></span><br><span class="line">* -sampleSchema true|false</span><br><span class="line">  - 指定启用 SAMPLE SCHEMA</span><br></pre></td></tr></table></figure></li>
<li><strong>内存选项</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">* -memoryMgmtType AUTO|AUTO_SGA|CUSTOM_SGA</span><br><span class="line">  - 指定内存管理方式</span><br><span class="line">  - AUTO 表示 AMM</span><br><span class="line">  - AUTO_SGA 表示 ASMM</span><br><span class="line"></span><br><span class="line">* -memoryPercentage Percentage | -totalMemory Size</span><br><span class="line">  - 两个选项只有一个会生效</span><br><span class="line">  - memoryPercentage，指定数据库内存占总物理内存的百分比</span><br><span class="line">  - totalMemory，指定数据库内存的总量，单位为 MB</span><br></pre></td></tr></table></figure></li>
<li><strong>存储选项</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">* -storageType=FS|ASM</span><br><span class="line">  - 指定存储方式，默认为 FS</span><br><span class="line"></span><br><span class="line">* -datafileDestination Location</span><br><span class="line">  - 指定存储位置</span><br><span class="line">  - 如果省略，FS 默认值为 $ORACLE_BASE/oradata/$ORACLE_SID</span><br><span class="line"></span><br><span class="line">* diskGroupName ASMDiskGroupName</span><br><span class="line">  - 指定 ASM 磁盘组</span><br><span class="line"></span><br><span class="line">* asmsnmpPassword Password</span><br><span class="line">  - 指定 ASM 密码</span><br><span class="line"></span><br><span class="line">* -recoveryAreaDestination Dir</span><br><span class="line">  - 指定 FRA 的位置</span><br><span class="line">  - 省略则默认为 $ORACLE_BASE/fast_recovery_area/$ORACLE_SID</span><br><span class="line">  - NONE 表示禁用 FRA</span><br><span class="line"></span><br><span class="line">* -recoveryAreaSize Size</span><br><span class="line">  - 指定 FRA 的最大空间，单位为 MB</span><br><span class="line"></span><br><span class="line">* recoveryGroupName ASMDiskGroupName</span><br><span class="line">  - 指定 FRA 使用的 ASM 磁盘组</span><br><span class="line"></span><br><span class="line">* -useOMF true|false</span><br><span class="line">  - Specify true to use Oracle-Managed Files</span><br></pre></td></tr></table></figure></li>
<li><strong>归档选项</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">* -enableArchive true|false</span><br><span class="line">  - 启用/禁用归档模式</span><br><span class="line"></span><br><span class="line">* -archiveLogMode AUTO|MANUAL</span><br><span class="line">  - 自动归档或手动归档</span><br><span class="line">  - 默认自动</span><br><span class="line"></span><br><span class="line">* -archiveLogDest File_Location [, ...]]</span><br><span class="line">  - 指定归档日志的位置，默认为 FRA</span><br></pre></td></tr></table></figure></li>
<li><strong>多租户选项</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 除 &quot;-createAsContainerDatabase&quot; 外，其他选项均为 &quot;-createAsContainerDatabase&quot; 的子选项，必须放在其之后</span><br><span class="line"></span><br><span class="line">* -createAsContainerDatabase true|false</span><br><span class="line">  - 是否创建为多租户结构</span><br><span class="line"></span><br><span class="line">* -numberOfPDBs N</span><br><span class="line">  - 指定创建 PDB 的数量，默认为 0</span><br><span class="line"></span><br><span class="line">* -pdbName Pdb_Name_Prefix</span><br><span class="line">  - 指定 PDB 名子的前缀，新创建的 PDB 会按照 Pdb_Name_Prefix01、Pdb_Name_Prefix02 的方式进行命名</span><br><span class="line"></span><br><span class="line">* -useLocalUndoForPDBs true|false</span><br><span class="line">  - 指定 PDB 是否使用 LOCAL UNDO</span><br><span class="line"></span><br><span class="line">* -pdbAdminPassword Pdb_Admin_Password</span><br><span class="line">  - 指定 PDB ADMIN 用户的密码</span><br><span class="line"></span><br><span class="line">* -pdbStorageMAXSizeInMB Value</span><br><span class="line">* -pdbStorageMAXTempSizeInMB Value</span><br><span class="line">  - 设置 PDB 的存储相关</span><br><span class="line"></span><br><span class="line">* -pdbOptions</span><br><span class="line">  - A comma separated list of name:value pairs with database options to enable/disable.</span><br><span class="line">  - For example JSERVER:true,DV:false</span><br></pre></td></tr></table></figure></li>
<li><strong>其他选项</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">* -initParams List</span><br><span class="line">  - 指定数据库的初始化参数</span><br><span class="line">  - 列表中的元素为 &quot;Name=Value&quot; 格式</span><br><span class="line"></span><br><span class="line">* -initParamsEscapeChar</span><br><span class="line">  - Specify escape character for comma when a specific initParam has multiple values.</span><br><span class="line">  - If the escape character is not specified backslash is the default escape character</span><br><span class="line"></span><br><span class="line">* -customScripts List</span><br><span class="line">  - 指定在建库成功后，执行的 sql 脚本</span><br><span class="line">  - A comma separated list of SQL scripts which needs to be run post db creation.</span><br><span class="line">  - The scripts are run in order they are listed</span><br><span class="line"></span><br><span class="line">* -oracleHomeUserPassword PassWord</span><br><span class="line">  - Specify Oracle Home User Password</span><br><span class="line"></span><br><span class="line">* -variables List</span><br><span class="line">  - Comma separated list of name=value pairs of location variables</span><br><span class="line"></span><br><span class="line">* -variablesFile FileName</span><br><span class="line">  - File name of the name=value pairs for location variables in the template</span><br><span class="line"></span><br><span class="line">* -dbOptions List</span><br><span class="line">  - A comma separated list of name:value pairs with database options to enable/disable.</span><br><span class="line">  - For example JSERVER:true,DV:false</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
<li><strong>未整理选项</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">* 存储选项</span><br><span class="line">  - datafileJarLocation Location    - For database creation, pass the absolute path of the datafile backup and for template creation, pass the directory to place the datafiles in compressed format</span><br><span class="line"></span><br><span class="line">* Wallet 选项</span><br><span class="line">  -useWalletForDBCredentials true|false       - Specify true to load database credentials from wallet</span><br><span class="line">    -dbCredentialsWalletLocation Location     - Path of the directory containing the wallet files</span><br><span class="line">    [-dbCredentialsWalletPassword PassWord]   - Password to open wallet with auto login disabled</span><br><span class="line"></span><br><span class="line">* Vault 选项</span><br><span class="line">  -dvConfiguration true|false             - Specify true to configure and enable database vault.</span><br><span class="line">    -dvUserName UserName                  - Specify database vault owner user name</span><br><span class="line">    -dvUserPassword PassWord              - Specify database vault owner password</span><br><span class="line">    [-dvAccountManagerPassword PassWord]  - Specify database vault account manager password</span><br><span class="line">    [-dvAccountManagerName UserName]      - Specify separate database vault account manager</span><br><span class="line"></span><br><span class="line">* em 选项</span><br><span class="line">  -emConfiguration DBEXPRESS|CENTRAL|BOTH|NONE</span><br><span class="line">    [-dbsnmpPassword &lt;DBSNMP user password&gt;]</span><br><span class="line">    [-emPassword &lt;EM Admin user password&gt;]</span><br><span class="line">    [-emUser &lt;EM Admin username to add or modify targets&gt;]</span><br><span class="line">    [-emExpressPort &lt;EM database express port number. Generally used during createDatabase&gt;]</span><br><span class="line">    [-omsHost &lt;EM management server host name&gt;]</span><br><span class="line">    [-omsPort &lt;EM management server port number&gt;]</span><br><span class="line">    [-emExpressPortAsGlobalPort &lt;value&gt;]</span><br><span class="line"></span><br><span class="line">* RAC 选项</span><br><span class="line">  -runCVUChecks           - Specify &quot;true&quot; in order to run Cluster Verification Utility checks periodically for RAC databases.</span><br><span class="line">  -RACOneNodeServiceName  - Service name for the service to be created for RAC One Node database. This option is mandatory when the databaseConfigType is RACONENODE</span><br><span class="line">  -nodelist List          - Node names separated by comma for the database</span><br><span class="line">  -adminManaged | -policyManaged</span><br><span class="line">  -adminManaged           - Admin managed database, this is default option</span><br><span class="line">  -policyManaged          - Policy managed database, default option is Admin managed database</span><br><span class="line">    -serverPoolName Name    - Specify the single server pool name in case of create server pool or comma separated list in case of existing server pools&gt;</span><br><span class="line">    [-pqPoolName Value]</span><br><span class="line">    [-createServerPool]     - Create a new server pool, which will be used by the database</span><br><span class="line">      [-pqPoolName Value]</span><br><span class="line">      [-forceServerPoolCreation]    - To create server pool by force when adequate free servers are not available. This may affect the database which is already in running mode</span><br><span class="line">      [-pqCardinality Value]</span><br><span class="line">      [-cardinality Cardinality]    - Specify the cardinality of the new server pool that is to be created, default is the number of qualified nodes</span><br><span class="line"></span><br><span class="line">* dir service 选项</span><br><span class="line">  -registerWithDirService true|false</span><br><span class="line">    -dirServiceUserName UserName            - User name for directory service</span><br><span class="line">    [-databaseCN DatabaseCommonName]</span><br><span class="line">    [-dirServiceCertificatePath Locatiion]  - Path to the certificate file to use when configuring SSL between database and directory service</span><br><span class="line">    [-dirServicePassword PassWord]          - Password for directory service</span><br><span class="line">    [-dirServiceUser UserName]              - SamAccountName in case of configuring Active Directory</span><br><span class="line">    [-ldapDirectoryAccessType PASSWORD|SSL]</span><br><span class="line">    [-useSYSAuthForLDAPAccess true|false]</span><br><span class="line">    [-walletPassword PassWord]              - Password for database wallet</span><br><span class="line"></span><br><span class="line">* Oracle Label Security 选项</span><br><span class="line">  -olsConfiguration true|false      - Specify true to configure and enable Oracle Label Security.</span><br><span class="line">    [-configureWithOID]             - This flag configures Oracle Label Security with OID.</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：DBCA-静默创建-19c-单实例传统数据库"><a href="#知识点：DBCA-静默创建-19c-单实例传统数据库" class="headerlink" title="知识点：DBCA 静默创建 19c 单实例传统数据库"></a>知识点：DBCA 静默创建 19c 单实例传统数据库</h3><ol>
<li><strong>准备环境变量</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">* ORACLE_BASE=/u01/app/oracle/product</span><br><span class="line"></span><br><span class="line">* ORACLE_HOME=/u01/app/oracle/product/database/19c</span><br><span class="line"></span><br><span class="line">* ORACLE_SID=test</span><br></pre></td></tr></table></figure></li>
<li><strong>创建 listener</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netca -silent -responsefile $ORACLE_HOME/assistants/netca/netca.rsp</span><br></pre></td></tr></table></figure></li>
<li><strong>准备响应文档 vim &#x2F;home&#x2F;oracle&#x2F;test.rsp</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">responseFileVersion=/oracle/assistants/rspfmt_dbca_response_schema_v19.0.0</span><br><span class="line">templateName=/u01/app/oracle/product/database/19c/assistants/dbca/templates/General_Purpose.dbc</span><br><span class="line">gdbName=test</span><br><span class="line">sid=test</span><br><span class="line">databaseConfigType=SI</span><br><span class="line">sysPassword=123456</span><br><span class="line">systemPassword=123456</span><br><span class="line">emConfiguration=NONE</span><br><span class="line">storageType=FS</span><br><span class="line">datafileDestination=/data/oracle/oradata/test</span><br><span class="line">recoveryAreaDestination=/data/oracle/fast_recoery_area/test</span><br><span class="line">recoveryAreaSize=204800</span><br><span class="line">characterSet=AL32UTF8</span><br><span class="line">nationalCharacterSet=AL16UTF16</span><br><span class="line">listeners=listener</span><br><span class="line">sampleSchema=true</span><br><span class="line">memoryMgmtType=auto_sga</span><br><span class="line">memoryPercentage=50</span><br><span class="line">databaseType=MULTIPURPOSE</span><br><span class="line">redoLogFileSize=512</span><br><span class="line">enableArchive=false</span><br><span class="line">initParams=control_files=&#x27;/u01/app/oracle/product/controlfiles/TEST/control01.ctl&#x27;\,&#x27;/u01/app/oracle/product/controlfiles/TEST/control02.ctl&#x27;\,&#x27;/u01/app/oracle/product/controlfiles/TEST/control03.ctl&#x27;</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
<li><strong>运行 dbca 静默安装</strong><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dbca -ignorePreReqs -ignorePrereqFailure -silent -createDatabase -responseFile /home/oracle/test.rsp ;</span><br></pre></td></tr></table></figure></li>
<li><strong>监听添加静态注册 vim $ORACLE_HOME&#x2F;network&#x2F;admin&#x2F;listener.ora</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">SID_LIST_LISTENER =</span><br><span class="line">    ( SID_LIST =</span><br><span class="line">        (SID_DESC =</span><br><span class="line">            (GLOBAL_DBNAME = test)</span><br><span class="line">            (SID_NAME = test)</span><br><span class="line">            (ORACLE_HOME = /u01/app/oracle/product/database/19c)</span><br><span class="line">        )</span><br><span class="line">    )</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：DBCA-静默创建-19c-单实例多租户数据库"><a href="#知识点：DBCA-静默创建-19c-单实例多租户数据库" class="headerlink" title="知识点：DBCA 静默创建 19c 单实例多租户数据库"></a>知识点：DBCA 静默创建 19c 单实例多租户数据库</h3><ol>
<li><strong>准备环境变量</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">* ORACLE_BASE=/u01/app/oracle</span><br><span class="line"></span><br><span class="line">* ORACLE_HOME=ORACLE_HOME=/u01/app/oracle/product/database/19c</span><br><span class="line"></span><br><span class="line">* ORACLE_SID=test</span><br></pre></td></tr></table></figure></li>
<li><strong>创建 listener</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netca -silent -responsefile $ORACLE_HOME/assistants/netca/netca.rsp</span><br></pre></td></tr></table></figure></li>
<li><strong>准备响应文档 vim &#x2F;home&#x2F;oracle&#x2F;test.rsp</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">responseFileVersion=/oracle/assistants/rspfmt_dbca_response_schema_v19.0.0</span><br><span class="line">templateName=/u01/app/oracle/product/database/19c/assistants/dbca/templates/General_Purpose.dbc</span><br><span class="line">gdbName=test</span><br><span class="line">sid=test</span><br><span class="line">databaseConfigType=SI</span><br><span class="line">createAsContainerDatabase=ture</span><br><span class="line">numberOfPDBs=2</span><br><span class="line">pdbName=testpdb</span><br><span class="line">useLocalUndoForPDBs=true</span><br><span class="line">sysPassword=123456</span><br><span class="line">systemPassword=123456</span><br><span class="line">pdbAdminPassword=123456</span><br><span class="line">emConfiguration=none</span><br><span class="line">storageType=FS</span><br><span class="line">datafileDestination=/data/oracle/oradata/test</span><br><span class="line">recoveryAreaDestination=/data/oracle/fast_recoery_area/test</span><br><span class="line">recoveryAreaSize=204800</span><br><span class="line">characterSet=AL32UTF8</span><br><span class="line">nationalCharacterSet=AL16UTF16</span><br><span class="line">listeners=listener</span><br><span class="line">sampleSchema=true</span><br><span class="line">memoryMgmtType=auto_sga</span><br><span class="line">memoryPercentage=50</span><br><span class="line">databaseType=MULTIPURPOSE</span><br><span class="line">redoLogFileSize=512</span><br><span class="line">enableArchive=false</span><br><span class="line">initParams=control_files=&#x27;/u01/app/oracle/product/controlfiles/TEST/control01.ctl&#x27;\,&#x27;/u01/app/oracle/product/controlfiles/TEST/control02.ctl&#x27;\,&#x27;/u01/app/oracle/product/controlfiles/TEST/control03.ctl&#x27;</span><br></pre></td></tr></table></figure></li>
<li><strong>运行 dbca 静默安装</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dbca -ignorePreReqs -ignorePrereqFailure -silent -createDatabase -responseFile /home/oracle/test.rsp ;</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：DBCA-deleteDatabase"><a href="#知识点：DBCA-deleteDatabase" class="headerlink" title="知识点：DBCA deleteDatabase"></a>知识点：DBCA deleteDatabase</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 删除数据库</span><br><span class="line">  - 要求要提供 sysdba 权限的凭证</span><br><span class="line"></span><br><span class="line">* 格式</span><br><span class="line">  dbca -deleteDatabase Options</span><br></pre></td></tr></table></figure></li>
<li><strong>选项</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">* -sourceDB</span><br><span class="line">  - 必须选项</span><br><span class="line">  - SI 环境的数据库名</span><br><span class="line">  - RAC 环境的数据库唯一名</span><br><span class="line"></span><br><span class="line">* -sysDBAUserName UserName</span><br><span class="line">  - 指定数据库中具有 sysdba 权限的用户的用户名</span><br><span class="line">  - 如不指定，则默认为 sys</span><br><span class="line"></span><br><span class="line">* -sysDBAPassword Password</span><br><span class="line">  - 指定 sysdba 用户的密码</span><br><span class="line">  - 如不指定，则会在终端中提示输入</span><br><span class="line"></span><br><span class="line">* -forceArchiveLogDeletion</span><br><span class="line">  - 指定同时删除数据库的归档</span><br><span class="line"></span><br><span class="line">* -sid SID</span><br><span class="line">  - Database system identifier</span><br></pre></td></tr></table></figure></li>
<li><strong>其他选项</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">* Wallet 选项</span><br><span class="line">  [-useWalletForDBCredentials &lt;true | false&gt; Specify true to load database credentials from wallet]</span><br><span class="line">    -dbCredentialsWalletLocation &lt;Path of the directory containing the wallet files&gt;</span><br><span class="line">    [-dbCredentialsWalletPassword &lt;Password to open wallet with auto login disabled&gt;]</span><br><span class="line"></span><br><span class="line">* DirService 选项</span><br><span class="line">  [-unregisterWithDirService &lt;true | false&gt;]</span><br><span class="line">    -dirServiceUserName &lt;User name for directory service&gt;</span><br><span class="line">    [-dirServicePassword &lt;Password for directory service&gt;]</span><br><span class="line">    [-walletPassword &lt;Password for database wallet&gt;]</span><br><span class="line"></span><br><span class="line">* EMCC 选项</span><br><span class="line">  [-deRegisterEMCloudControl ]</span><br><span class="line">    -emUser &lt;EM Admin username to add or modify targets&gt;</span><br><span class="line">    -omsHost &lt;EM management server host name&gt;</span><br><span class="line">    -omsPort &lt;EM management server port number&gt;</span><br><span class="line">    [-emPassword &lt;EM Admin user password&gt;]</span><br></pre></td></tr></table></figure></li>
<li><strong>范例</strong><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 删除 SI 方式的数据库 <span class="built_in">test</span></span></span><br><span class="line">dbca -silent -deleteDatabase -sourceDB test -sysDBAUserName sys -sysDBAPassword 123456 ;</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h2 id="9-3-创建-PDB"><a href="#9-3-创建-PDB" class="headerlink" title="9.3 创建 PDB"></a>9.3 创建 PDB</h2><hr>
<h3 id="知识点：创建-PDB-介绍"><a href="#知识点：创建-PDB-介绍" class="headerlink" title="知识点：创建 PDB 介绍"></a>知识点：创建 PDB 介绍</h3><ol>
<li><strong>CREATE PLUGGABLE DATABASE</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">* 种子容器</span><br><span class="line"></span><br><span class="line">* 克隆 PDB，本地或远程</span><br><span class="line"></span><br><span class="line">* 插入 non-CDB</span><br><span class="line"></span><br><span class="line">* 插入 plugged PDB</span><br></pre></td></tr></table></figure></li>
<li><strong>DBCA</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">* 种子容器</span><br><span class="line"></span><br><span class="line">* RMAN 备份</span><br><span class="line"></span><br><span class="line">* 已拔下的 PDB</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：CREATE-PLUGGABLE-DATABASE"><a href="#知识点：CREATE-PLUGGABLE-DATABASE" class="headerlink" title="知识点：CREATE PLUGGABLE DATABASE"></a>知识点：CREATE PLUGGABLE DATABASE</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">* 语法简单，效率高</span><br><span class="line"></span><br><span class="line">* 自动创建 PDB 的存储目录</span><br></pre></td></tr></table></figure></li>
<li><strong>使用种子容器创建 PDB</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">* 注意</span><br><span class="line">  1. 必须指定 ADMIN USER</span><br><span class="line">    - 通常就叫 PDBADMIN</span><br><span class="line">    - 不能是 SYS 或 SYSTEM</span><br><span class="line">    - 为 PDB 创建的本地用户，并会被赋予 PDB_DBA 角色</span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> PLUGGABLE DATABASE pdb_name</span><br><span class="line">  [STORAGE (MAXSIZE <span class="number">3</span>G MAX_SHARED_TEMP_SIZE <span class="number">100</span>M)]              <span class="comment">-- 设定 PDB 的最大数据量和最大共享临时区</span></span><br><span class="line">  [<span class="keyword">DEFAULT</span> TABLESPACE tablespace_name ]</span><br><span class="line">  ADMIN <span class="keyword">USER</span> pdb_admin_user_name IDENTIFIED <span class="keyword">BY</span> pass_word</span><br><span class="line">  [PATH_PREFIX<span class="operator">=</span><span class="string">&#x27;dir_path&#x27;</span>]                                      <span class="comment">-- 限制 PDB 创建目录对象时的位置，所有的目录对象只能基于此位置的子目录的相对路径</span></span><br><span class="line">  FILE_NAME_CONVERT<span class="operator">=</span>(<span class="string">&#x27;pdbseed_file_directory&#x27;</span>，<span class="string">&#x27;new_pdb_file_directory&#x27;</span>)  <span class="comment">-- 文件转换，将种子容器的路径转换为 pdb 的目标存储路径，都要使用绝对路径</span></span><br><span class="line">  ;</span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 范例</span></span><br><span class="line"><span class="keyword">CREATE</span> PLUGGABLE DATABASE testpdb01</span><br><span class="line">  ADMIN <span class="keyword">USER</span> pdb_admin IDENTIFIED <span class="keyword">BY</span> <span class="number">123456</span></span><br><span class="line">  FILE_NAME_CONVERT<span class="operator">=</span>(<span class="string">&#x27;/u01/app/oracle/oradata/test/seed&#x27;</span>，<span class="string">&#x27;/u01/app/oracle/oradata/test/testpdb01&#x27;</span>)</span><br><span class="line">  ;</span><br></pre></td></tr></table></figure></li>
<li><strong>使用本地 PDB 创建 PDB</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">* 注意</span><br><span class="line">  1. 源 PDB 需要处于 READ ONLY 状态</span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> PLUGGABLE DATABASE pdb_name <span class="keyword">FROM</span> source_pdb_name</span><br><span class="line">  FILE_NAME_CONVERT<span class="operator">=</span>(<span class="string">&#x27;old_pdb_file_dir&#x27;</span>，<span class="string">&#x27;new_pdb_file_dir&#x27;</span>)</span><br><span class="line">  ;</span><br></pre></td></tr></table></figure></li>
<li><strong>使用远程 PDB 创建 PDB</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">* 权限</span><br><span class="line">  - 本地用户需要拥有 CREATE PLUGGABLE DATABASE 权限</span><br><span class="line">  - dblink 指向的远程用户需要拥有 CREATE PLUGGABLE DATABASE 权限</span><br><span class="line">  - dblink 通常使用 system 用户</span><br><span class="line">    SOURCE_PDB &gt; GRANT CREATE PLUGGABLE DATABASE TO system ;</span><br><span class="line">    TARGET_CDB &gt; CREATE DATABASE LINK db_link_name CONNECT TO user_name IDENTIFIED BY passwd USING &#x27;tnsname&#x27; ;</span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> PLUGGABLE DATABASE pdb_name <span class="keyword">FROM</span> source_pdb_name<span class="variable">@dblink</span></span><br><span class="line">[FILE_NAME_CONVERT<span class="operator">=</span>(<span class="string">&#x27;old_pdb_file_dir&#x27;</span>，<span class="string">&#x27;new_pdb_file_dir&#x27;</span>)]</span><br><span class="line">;</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：DROP-PLUGGABLE-DATABASE"><a href="#知识点：DROP-PLUGGABLE-DATABASE" class="headerlink" title="知识点：DROP PLUGGABLE DATABASE"></a>知识点：DROP PLUGGABLE DATABASE</h3><ol>
<li><strong>语法</strong><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 仅删除 CDB 中保留的 PDB 的注册信息，保留 PDB 的数据文件</span></span><br><span class="line"><span class="comment">-- 只有将 PDB 拔出后才可以使用此语句</span></span><br><span class="line"><span class="keyword">DROP</span> PLUGGABLE DATABASE pdb_name ;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 从 CDB 中删除 PDB 的同时，一起删除 PDB 的数据文件</span></span><br><span class="line"><span class="keyword">DROP</span> PLUGGABLE DATABASE pdb_name INCLUDING DATAFILES ;  </span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h1 id="Chapter10-数据迁移"><a href="#Chapter10-数据迁移" class="headerlink" title="Chapter10 数据迁移"></a>Chapter10 数据迁移</h1><hr>
<h2 id="10-1-spool"><a href="#10-1-spool" class="headerlink" title="10.1 spool"></a>10.1 spool</h2><hr>
<h3 id="知识点：oracle-数据保存为-csv"><a href="#知识点：oracle-数据保存为-csv" class="headerlink" title="知识点：oracle 数据保存为 csv"></a>知识点：oracle 数据保存为 csv</h3><ol>
<li><strong>三种方法</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">1. sqldeveloper 中进行保存</span><br><span class="line"></span><br><span class="line">2. sqlplus spool 导出</span><br><span class="line"></span><br><span class="line">3. 编写 plsql 程序</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h2 id="10-2-datapump"><a href="#10-2-datapump" class="headerlink" title="10.2 datapump"></a>10.2 datapump</h2><hr>
<h3 id="知识点：datapump-介绍"><a href="#知识点：datapump-介绍" class="headerlink" title="知识点：datapump 介绍"></a>知识点：datapump 介绍</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 数据泵 datapump，Oracle 提供的，用于 oracle 数据库之间进行数据传输的工具</span><br><span class="line">  - 通常使用 system 用户来进行操作</span><br><span class="line">  - 用于取代原有的 exp、imp 工具</span><br><span class="line">  - 相关文档记录在 Database Utilities 中</span><br><span class="line"></span><br><span class="line">* datapump 的工具</span><br><span class="line">  - expdp</span><br><span class="line">  - impdp</span><br><span class="line"></span><br><span class="line">* datapumo 的数据级别</span><br><span class="line">  - database</span><br><span class="line">  - tablespace</span><br><span class="line">  - schema</span><br><span class="line">  - table</span><br><span class="line"></span><br><span class="line">* 目录对象 directory</span><br><span class="line">  - datapump 的使用依赖于目录对象</span><br><span class="line">  - 数据库用户要具有对目录对象的 READ WRITE 权限</span><br><span class="line">  - 操作系统用户需要拥有对相应操作系统目录的 r w 权限</span><br></pre></td></tr></table></figure></li>
<li><strong>其他</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">* datapump 的优势</span><br><span class="line">  - 可以进行细粒度的操作，进行数据选择</span><br><span class="line">  - 可以指定数据库版本</span><br><span class="line">  - 可以并行</span><br><span class="line">  - 可以进行作业评估</span><br><span class="line">  - 可以进行重映射</span><br><span class="line">  - 可以进行采样</span><br><span class="line">  - 可以压缩和加密，但是要付钱</span><br><span class="line">  - 可以使用直接路径，来直接操作数据文件，绕过共享内存，而传统方式则是先从数据文件中查询到共享内存中，再从共享内存中导出</span><br><span class="line">  - 可以通过 dblink，直接在数据库之间进行数据的传输</span><br><span class="line"></span><br><span class="line">* datapump 的底层工作流程</span><br><span class="line">  - 在相应用户下建立临时表，来记录相应的数据</span><br><span class="line">  - 当导入导出操作结束时，自动删除临时表</span><br></pre></td></tr></table></figure></li>
<li><strong>相关数据字典</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">* DBA_DATAPUMP_JOBS</span><br><span class="line"></span><br><span class="line">* DBA_DATAPUMP_SESSIONS</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：expdp-指令"><a href="#知识点：expdp-指令" class="headerlink" title="知识点：expdp 指令"></a>知识点：expdp 指令</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - expdp，datapump 的导出工具，将数据库中的数据导出为 dump 文件</span><br><span class="line"></span><br><span class="line">* expdp 的导出内容</span><br><span class="line">  - 对于所有对象，会导出对象的元数据、数据、统计信息</span><br><span class="line">  - 对于表，除了表中的数据，还会关联导出表的约束、索引、触发器等对象</span><br></pre></td></tr></table></figure></li>
<li><strong>指令格式</strong><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">expdp LogOn directory=DirDame Mode [Options]</span><br></pre></td></tr></table></figure></li>
<li><strong>LogOn</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 指定连接数据库时使用的账号密码等</span><br><span class="line"></span><br><span class="line">* 格式</span><br><span class="line">  UserName/PassWord</span><br><span class="line">  UserName/PassWord@HostName:Port/Service</span><br><span class="line">  UserName/PassWord@TnsName</span><br><span class="line">  \&#x27;sys/sys_password@HostName:Port/Service as sysdba\&#x27;</span><br><span class="line">  \&#x27;sys/sys_password@TnsName as sysdba\&#x27;</span><br></pre></td></tr></table></figure></li>
<li><strong>Mode</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 指定导出模式，用来确定导出的数据级别，以及指定导出的数据</span><br><span class="line"></span><br><span class="line">* full=Y|N</span><br><span class="line">  - 进行全库导出</span><br><span class="line">  - 要求执行的数据库用户具有 DATAPUMP_EXP_FULL_DATABASE 角色</span><br><span class="line"></span><br><span class="line">* tablespaces=TablespaceName [, ...]</span><br><span class="line">  - 导出指定的表空间</span><br><span class="line"></span><br><span class="line">* schemas=SchemaName [, ...]</span><br><span class="line">  - 导出指定的用户的数据</span><br><span class="line"></span><br><span class="line">* tables=TableName [, ...]</span><br><span class="line">  - 导出指定的表</span><br><span class="line">  - 表名的格式为 UserName.TableName</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
<li><strong>options</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">* dumpfile=DumpfileName</span><br><span class="line">  - 指定 dump 文件，习惯上以 .dmp 结尾</span><br><span class="line">  - 支持多种格式符，自动进行替换</span><br><span class="line">    - %U        在生成多个文件时，以数字进行编号，从 01 开始</span><br><span class="line">    - %t, %T    日期，格式为 YYYYMMDD</span><br><span class="line">    - %d, %D    day of month</span><br><span class="line">    - %m, %M    month</span><br><span class="line">    - %y, %Y    year</span><br><span class="line"></span><br><span class="line">* logfile=LogFileName</span><br><span class="line">  - 指定日志文件，记录 expdp 执行过程的输出日志</span><br><span class="line"></span><br><span class="line">* filesize=Size</span><br><span class="line">  - 控制单个 dmp 文件的大小</span><br><span class="line"></span><br><span class="line">* parallel=N</span><br><span class="line">  - 控制并行度</span><br><span class="line"></span><br><span class="line">* job_name=JobName</span><br><span class="line">  - 为导出操作起个名子</span><br><span class="line"></span><br><span class="line">* network_link=DbLinkName</span><br><span class="line">  - 指定使用的 dblink</span><br><span class="line">  - 对于 expdp，dblink 的作用只是在目标数据库上生成 dmp 文件，并不能直接进行数据导入</span><br><span class="line"></span><br><span class="line">* estimate_only=y</span><br><span class="line">  - 不进行导出工作，仅进行估算</span><br><span class="line"></span><br><span class="line">* compression</span><br><span class="line">  - 指定压缩，需要付费</span><br><span class="line"></span><br><span class="line">* views_as_tables=ViewName [, ...]</span><br><span class="line">  - 视图转表</span><br><span class="line"></span><br><span class="line">* version=Version</span><br><span class="line">  - 进行版本转换，指定目标数据库的版本</span><br><span class="line"></span><br><span class="line">* transport_full_check=y</span><br><span class="line">  - 进行可传输表空间时进行自包含检查</span><br><span class="line"></span><br><span class="line">* parfile=ParFileName</span><br><span class="line">  - 指定参数文件</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：expdp-范例"><a href="#知识点：expdp-范例" class="headerlink" title="知识点：expdp 范例"></a>知识点：expdp 范例</h3><ol>
<li><strong>创建目录对象</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">mkdir /data/expdp</span><br><span class="line"></span><br><span class="line">sqlplus system/123456</span><br><span class="line"></span><br><span class="line">CREATE OR REPLACE DIRECTORY mydir AS &#x27;/data/app/oracle/exp&#x27; ;</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
<li><strong>expdp 进行导出</strong><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 进行全库导出</span></span><br><span class="line">expdp system/123456@192.168.31.101:1521/test directory=mydir dumpfile=dump.%U.dmp logfile=dump.log full=y ;</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 只导出指定的表空间</span></span><br><span class="line">expdp system/123456@192.168.31.101:1521/test directory=mydir dumpfile=dump.%U.dmp logfile=dump.log tablespaces=users, test ;</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 只导出指定的 schema</span></span><br><span class="line">expdp system/123456@192.168.31.101:1521/test directory=mydir dumpfile=dump.%U.dmp logfile=dump.log schemas=hr, test ;</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 只导出指定的表</span></span><br><span class="line">expdp system/123456@192.168.31.101:1521/test directory=mydir dumpfile=dump.%U.dmp logfile=dump.log tables=hr.employees, hr.departments ;</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：expdp-参数文件和高级选项"><a href="#知识点：expdp-参数文件和高级选项" class="headerlink" title="知识点：expdp 参数文件和高级选项"></a>知识点：expdp 参数文件和高级选项</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">* expdp 参数文件</span><br><span class="line">  - 参数文件，用来包含 expdp 的选项，这样可以省略在命令行上指定选项</span><br><span class="line">  - 参数文件的优先级要低于命令行选项</span><br><span class="line">  - expdp 的所有选项均可以写在参数文件中</span><br><span class="line">  - 部分高级配置只能写在配置文件中</span><br><span class="line">  - 参数文件不能嵌套指定</span><br><span class="line">  - 使用井号进行注释</span><br><span class="line"></span><br><span class="line">* expdp 在执行时，可以仅指定参数文件，如：expdp parfile=ParFileName</span><br></pre></td></tr></table></figure></li>
<li><strong>高级选项</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">* exclude</span><br><span class="line">  - 不导出某些对象</span><br><span class="line">  - 例如：</span><br><span class="line">    - exclued=table:&quot;like &#x27;EMPLOYEES%&#x27;&quot;</span><br><span class="line">    - exclued=table:&quot;=&#x27;EMPLOYEES%&#x27;&quot;</span><br><span class="line">    - exclued=table:&quot;in(&#x27;EMPLOYEES&#x27;,&#x27;DEPARTMENTS&#x27;)&quot;</span><br><span class="line">    - exclude=statistics    不导出统计信息，可以使导出工作快一点，统计信息可以在导入到新的数据库后重新收集</span><br><span class="line"></span><br><span class="line">* include</span><br><span class="line">  - 仅导出某些对象</span><br><span class="line">  - exclude 和 include 不能同时出现</span><br><span class="line">  - 例如：</span><br><span class="line">    - include=procedure</span><br><span class="line">    - include=table:&quot;= &#x27;EMPLOYEES%&#x27;&quot;</span><br><span class="line"></span><br><span class="line">* query</span><br><span class="line">  - 对表中的行先进行筛选再导出</span><br><span class="line">  - 例如：</span><br><span class="line">    - query=employees:&quot;where department_id=40 order by employee_id&quot;</span><br><span class="line"></span><br><span class="line">* content</span><br><span class="line">  - 指定导出的数据的内容</span><br><span class="line">  - 例如</span><br><span class="line">    - content=all                 -- 默认情况</span><br><span class="line">    - content=metadata_only       -- 仅导出对象的元数据</span><br><span class="line">    - content=data_only           -- 仅导出对象所包含的数据</span><br><span class="line"></span><br><span class="line">* sample</span><br><span class="line">  - 仅导出采样数据</span><br><span class="line">  - 如果有 query 参数，则是先经过 query 参数筛选，再进行采样</span><br><span class="line">  - 例如：</span><br><span class="line">    - sample=10                           -- 所有对象都仅导出 10% 的采样数据</span><br><span class="line">    - sample=employees:10,departmets:30   -- employees 表导出 10% 的采样数据，departments 导出 30% 的采样数据</span><br></pre></td></tr></table></figure></li>
<li><strong>范例</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"># 导出 hr 下的所有数据</span><br><span class="line"># 1. 编写参数文件，vim /home/oracle/1.par</span><br><span class="line">SCHEMAS=HR</span><br><span class="line">DUMPFILE=exp.dmp</span><br><span class="line">DIRECTORY=mydir</span><br><span class="line">LOGFILE=exp.log</span><br><span class="line"></span><br><span class="line"># 2. 执行 expdp</span><br><span class="line">expdp system/123456 PARFILE=/home/oracle/1.par</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：impdp-指令"><a href="#知识点：impdp-指令" class="headerlink" title="知识点：impdp 指令"></a>知识点：impdp 指令</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - datapump 中的导入工具，从 dump 文件中将数据导入到数据库</span><br><span class="line">  - 与 expdp 一样，推荐使用 system 用户进行执行</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">* impdp 的优点</span><br><span class="line">  - impdp 可以从高级别的 dmp 文件中导入低级别的数据</span><br><span class="line">    - 如从 schema dmp 文件中导入 table</span><br><span class="line">    - 如从 full dmp 文件中导入 schema</span><br><span class="line">  - impdp 可以从表中仅导入部分行，使用 query 参数</span><br><span class="line">  - impdp 可以使用 dblink，直接在数据库之间传输数据，不生成 dmp 文件，使用 networl_link 参数</span><br><span class="line">  - impdp 可以进行重映射，使用 remap_* 参数</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">* impdp 的局限</span><br><span class="line">  - impdp 严格按照对象的元数据进行导入，除非使用 remap_*</span><br><span class="line">  - 导入表，只能导入到原来的用户下，并且导入到原来的表空间</span><br><span class="line">  - impdp 不能自动建立用户和表空间，必须手动提前将用户和表空间建立好，或使用 remap_*</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">* impdp 的底层执行</span><br><span class="line">  - 本质上，impdp 仍然是通过 INSERT 语句进行插入，来将数据添加到数据库中，因此在执行过程中会产生大量 undo</span><br><span class="line">  - 以表为单位进行 commit</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
<li><strong>指令格式</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">impdp LogOn directory=DirName Mode Options [RemapOptions] [TranformAction] [ParFile]</span><br></pre></td></tr></table></figure></li>
<li><strong>LogOn</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 指定 impdp 登录数据库的凭证</span><br><span class="line"></span><br><span class="line">* 格式</span><br><span class="line">  UserName/PassWord</span><br><span class="line">  UserName/PassWord@HostName:Port/Service</span><br><span class="line">  UserName/PassWord@Tnsname</span><br><span class="line">  \&#x27;sys/sys_password@HostName:Port/Service as sysdba\&#x27;</span><br><span class="line">  \&#x27;sys/sys_password@Tnsname as sysdba\&#x27;</span><br></pre></td></tr></table></figure></li>
<li><strong>Mode</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">* full=Y|N</span><br><span class="line">  - 指定全库导入</span><br><span class="line"></span><br><span class="line">* tables=TableName [, ...]</span><br><span class="line">  - 指定导入的表</span><br><span class="line"></span><br><span class="line">* schemas=SchemaName [, ...]</span><br><span class="line">  - 指定导入的方案</span><br><span class="line"></span><br><span class="line">* tablespaces=TableSpaceName [, ...]</span><br><span class="line">  - 指定导入的表空间</span><br></pre></td></tr></table></figure></li>
<li><strong>Option</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">* dumpfile=DumpFileName [,...]</span><br><span class="line">  - 指定读取的 dump 文件</span><br><span class="line">  - 支持 &quot;%U&quot; 格式符</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">* logfile=LogFileName</span><br><span class="line">  - 指定日志文件</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">* parallel=N</span><br><span class="line">  - 指定并行度</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">* network_link=DbLinkName</span><br><span class="line">  - 指定使用的 dblink</span><br><span class="line">  - 直接将远程数据库中的数据导入到目标数据库中</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">* table_exists_action=skip|append|replace|truncate</span><br><span class="line">  - 指定当目标库中表已经存在时，该执行什么操作</span><br><span class="line">  - skip          默认操作</span><br><span class="line">  - append        将新数据追加到表的末尾</span><br><span class="line">  - replace       先对表进行 drop，再导入数据</span><br><span class="line">  - truncate      先对表进行 truncate，再导入数据</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">* parfile=ParFileName</span><br><span class="line">  - 指定参数文件</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">* job_name=JobName</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">* sqlfile=SqlFileName</span><br><span class="line">  - 不进行数据导入，而是将指定的对象的 DDL 语句写入到 SqlFileName 中，SqlFileName 是目录对象下的相对路径</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
<li><strong>RemapOptions</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 进行重映射</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">* remap_table=old_table_name:new_table_name [, ...]</span><br><span class="line">  - 对表进行重映射</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">* remap_schema=old_schema:new_schema [, ...]</span><br><span class="line">  - 对 schema 进行重映射</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">* remap_tablespace=old_tablespace:new_tablespace [, ...]</span><br><span class="line">  - 对表空间进行重映射</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：impdp-参数文件和高级配置"><a href="#知识点：impdp-参数文件和高级配置" class="headerlink" title="知识点：impdp 参数文件和高级配置"></a>知识点：impdp 参数文件和高级配置</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - impdp 的参数文件与 expdp 的参数文件的用法类似</span><br><span class="line">  - 支持 impdp 所有的普通选项和高级选项，高级选项只能写在参数文件中</span><br><span class="line">  - 参数文件不能嵌套指定</span><br><span class="line">  - 使用井号进行注释</span><br></pre></td></tr></table></figure></li>
<li><strong>高级选项</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">* query</span><br><span class="line">  - 仅导入表中符合条件的行</span><br><span class="line">  - 例如：</span><br><span class="line">    query=employees:&quot;where department_id=40 order by employee_id&quot;</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：impdp-范例"><a href="#知识点：impdp-范例" class="headerlink" title="知识点：impdp 范例"></a>知识点：impdp 范例</h3><ol>
<li><strong>创建目录对象</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sqlplus system/123456</span><br><span class="line"></span><br><span class="line">CREATE OR REPLACE DIRECTORY mydir AS &#x27;/data/app/oracle/exp&#x27; ;</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
<li><strong>impdp 进行数据导入</strong><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 进行全库导入，并且如果表已存在则进行 append</span></span><br><span class="line">impdp system/123456 directory=mydir dumpfile=user1.dmp full=y table_exists_action=append</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 只导入指定的表，并对 schema 和 tablespace 进行重映射</span></span><br><span class="line">impdp system/123456 directory=mydir dumpfile=dump.dmp tables=user1.table1, user1.table2 remap_schema=user1:user2 remap_tablespace=tablespace1:tablespace2</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h2 id="10-3-sqlldr"><a href="#10-3-sqlldr" class="headerlink" title="10.3 sqlldr"></a>10.3 sqlldr</h2><hr>
<h3 id="知识点：sqlldr-介绍（不全）"><a href="#知识点：sqlldr-介绍（不全）" class="headerlink" title="知识点：sqlldr 介绍（不全）"></a>知识点：sqlldr 介绍（不全）</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - oracle 提供的数据导入工具，用于将 txt、excel、csv 等格式的数据导入到数据库中</span><br><span class="line"></span><br><span class="line">* 控制文件 ControlFile</span><br><span class="line">  - 相当于 expdp/impdp 的参数文件，在里面指定对 sqlldr 的要求</span><br></pre></td></tr></table></figure></li>
<li><strong>sqlldr 命令格式</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlldr LogOn control=ControlFile</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h1 id="Chapter11-备份恢复"><a href="#Chapter11-备份恢复" class="headerlink" title="Chapter11 备份恢复"></a>Chapter11 备份恢复</h1><hr>
<h2 id="11-1-数据安全"><a href="#11-1-数据安全" class="headerlink" title="11.1 数据安全"></a>11.1 数据安全</h2><hr>
<h3 id="知识点：数据安全介绍"><a href="#知识点：数据安全介绍" class="headerlink" title="知识点：数据安全介绍"></a>知识点：数据安全介绍</h3><ol>
<li><strong>RPO 和 RTO</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - RPO 和 RTO 用于量化对故障恢复操作的需求</span><br><span class="line">  - 在规划备份策略和修复策略之前，需要首先确定 RPO 和 RTO，然后再根据情况来制定合适的策略</span><br><span class="line"></span><br><span class="line">* RPO</span><br><span class="line">  - Recovery Point Objective</span><br><span class="line">  - 一次故障所能承受的最大数据丢失量</span><br><span class="line"></span><br><span class="line">* RTO</span><br><span class="line">  - Recovery Time Objective</span><br><span class="line">  - 一次故障所能接收的最大停机时间</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
<li><strong>关键性文件和非关键性文件</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">* 关键性文件</span><br><span class="line">  - 丢失后会导致数据库宕机的文件</span><br><span class="line">  - 包括：</span><br><span class="line">    - 系统表空间</span><br><span class="line">    - UNDO 表空间</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">* 非关键性文件</span><br><span class="line">  - 丢失后不会造成数据库宕机</span><br><span class="line">  - 非关键性丢失的修复可以直接在线完成</span><br><span class="line">  - 包括：</span><br><span class="line">    - 用户表空间</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
<li><strong>数据库的可恢复性</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">* 控制文件多路复用</span><br><span class="line">  - OS 文件存储：</span><br><span class="line">    - 配置 control_files 参数，添加控制文件数量</span><br><span class="line">    - 控制文件分别放在不同的物理存储上</span><br><span class="line">  - ASM 存储：</span><br><span class="line">    - 每个 disk_group 上都放一个控制文件副本</span><br><span class="line"></span><br><span class="line">* 日志文件多路复用</span><br><span class="line">  - 每个日志组至少有两个成员</span><br><span class="line"></span><br><span class="line">* 数据库为归档模式</span><br><span class="line"></span><br><span class="line">* 数据库有备份</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：Oracle-的数据安全体系"><a href="#知识点：Oracle-的数据安全体系" class="headerlink" title="知识点：Oracle 的数据安全体系"></a>知识点：Oracle 的数据安全体系</h3><ol>
<li><strong>MAA</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - Maximum Availability Architecture</span><br><span class="line">  - Oracle 的高可用体系</span><br><span class="line">  - 针对生产节点 Production Site，使用 DRA、FLASHBACK、RMAN 等进行保护</span><br><span class="line">  - 针对后备节点 Standby Site，使用 DG、ADG 实现与 Production Site 同步</span><br><span class="line">  - 当 Production Site 崩溃时，业务立刻切换到 Standby Site</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
<li><strong>数据库的保护级别</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">   - 保护级别 data protection solutions</span><br><span class="line">   - 级别越高，价格越贵</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> * RMAN 和 OSB</span><br><span class="line">   - 物理数据级别保护</span><br><span class="line">   - RPO 能力为 hours 或 days</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> * 闪回</span><br><span class="line">   - 逻辑数据级别保护</span><br><span class="line">   - RPO 能力为 minutes 或 hours</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> * DG，ADG</span><br><span class="line">   - RPO 保护级别为 secones 或 minutes</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h2 id="11-2-备份"><a href="#11-2-备份" class="headerlink" title="11.2 备份"></a>11.2 备份</h2><hr>
<h3 id="知识点：备份文件"><a href="#知识点：备份文件" class="headerlink" title="知识点：备份文件"></a>知识点：备份文件</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 备份文件，本质上就是原有数据的拷贝</span><br><span class="line">  - 备份文件的基础信息，记录在控制文件中，称为 Repository</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">* 备份文件可以涵盖的文件</span><br><span class="line">  - 数据文件</span><br><span class="line">  - 控制文件</span><br><span class="line">  - 参数文件</span><br><span class="line">  - 归档日志</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">* 备份文件的打包</span><br><span class="line">  - 控制文件单独打包</span><br><span class="line">  - 自动备份控制文件和控制文件分开打包</span><br><span class="line">  - 同一个 pdb 内的数据文件整合打包，不同的 pdb 之前分开打包</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">* 备份文件的存放位置</span><br><span class="line">  - 不指定 Format：FRA_HOME/Hash_Value/BackupSet</span><br><span class="line">  - 指定 Format：FRA_HOME/BackupSet</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
<li><strong>备份文件的种类</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">* 备份卷 volume</span><br><span class="line">  - 一次备份操作所创作的所有备份文件</span><br><span class="line">  - 使用 TAG 来标识备份卷</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">* 备份集 BackupSet</span><br><span class="line">  - 将数据库原有的文件经过打包、压缩而构成二进制备份文件，一个备份集就对应一个备份文件</span><br><span class="line">  - 使用 BACKUPSET KEY 来标识备份集</span><br><span class="line">  - 备份集的创建</span><br><span class="line">    - 数据库的数据文件占据一个备份集</span><br><span class="line">    - 控制文件单独占据一个备份集</span><br><span class="line">    - 参数文件单独占据一个备份集</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">* 备份片 BackupSet Piece</span><br><span class="line">  - 当一个备份集太大时，就需要对备份级进行分片，此时一个备份集对应多个备份文件，每个备份文件就是一个备份片</span><br><span class="line">  - BACKUP 命令中的 SECTION SIZE 指定备份片</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">* 镜像拷贝 Image Copy</span><br><span class="line">  - 直接在 OS 层对数据文件进行复制</span><br><span class="line">  - 归档日志也是以镜像拷贝的方式操作和保存</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
<li><strong>备份文件的状态</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">* AVALIABLE</span><br><span class="line">  - 有效备份，活跃备份</span><br><span class="line">  - 当进行恢复时，首先使用此备份</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">* UNAVALIABLE</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">* OBSOLETE</span><br><span class="line">  - 废弃备份，因为保留策略而失效的备份文件</span><br><span class="line">  - 可以放心删除</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">* EXPIREED</span><br><span class="line">  - 过期备份，因为物理文件被删除而导致的无效记录</span><br><span class="line">  - 可以放心删除</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
<li><strong>备份文件的保留策略 Retention Policy</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">* 冗余 Redundancy</span><br><span class="line">  - 最近 N 个备份视为有效备份，其他视为无效备份</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">* 恢复窗口 Recovery Window</span><br><span class="line">  - 恢复窗口，是指从现在当前开始计算，向后的一段时间</span><br><span class="line">  - 对备份文件的保留，要求是可以恢复到恢复窗口中的任意一个时间点</span><br><span class="line">  - 很久以前的备份文件，如果在进行恢复时会用到，也会进行保留</span><br><span class="line">  - 例如：</span><br><span class="line">    - 恢复窗口为 10 天，第一份备份为 20 天前生成，第二份备份为 3 天前生成，所有归档日志和 redo 日志均存在</span><br><span class="line">    - 第一份备份文件不会被视为 OBSOLETE，因为恢复到过去第 10 到第 7 天需要用到第一份备份文件</span><br><span class="line">    - 第一份备份和第二份备份之间的所有归档日志都不会视为 OBSOLETE</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
<li><strong>备份文件相关数据字典</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">* V$BACKUP_FILES</span><br><span class="line">  - 记录备份文件和归档日志的信息</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">* V$BACKUP_SET</span><br><span class="line">* V$BACKUP_SET_DETAILS</span><br><span class="line">* V$BACKUP_SET_SUMMARY</span><br><span class="line">  - 记录备份集的信息</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">* V$BACKUP_PIECE</span><br><span class="line">* V$BACKUP_PIECE_DETAILS</span><br><span class="line">  - 记录备份片的信息</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">* V$BACKUP_COPY_DETAILS</span><br><span class="line">* V$BACKUP_COPY_SUMMARY</span><br><span class="line">  - 记录镜像副本的信息</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">* V$BACKUP_DEVICE</span><br><span class="line">  - 记录备份设备的信息</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">* V$BACKUP_DATAFILE</span><br><span class="line">* V$BACKUP_DATAFILE_SUMMARY</span><br><span class="line">  - 记录备份集中包含的数据文件和控制文件情况</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">* V$BACKUP_CORRUPTION</span><br><span class="line">  - 记录数据文件的备份集中的坏块信息</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">* V$BACKUP</span><br><span class="line">* V$BACKUP_DATAFILE_DETAILS</span><br><span class="line">* V$DATAFILE_COPY</span><br><span class="line">  - 记录数据文件的备份情况</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">* V$BACKUP_CONTROLFILE_DETAILS</span><br><span class="line">* V$BACKUP_CONTROLFILE_SUMMARY</span><br><span class="line">  - 记录控制文件的备份情况</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">* V$BACKUP_SPFILE</span><br><span class="line">* V$BACKUP_SPFILE_DETAILS</span><br><span class="line">* V$BACKUP_SPFILE_SUMMARY</span><br><span class="line">  - 记录参数文件的备份情况</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">* V$BACKUP_REDOLOG</span><br><span class="line">* V$BACKUP_ARCHIVELOG_DETAILS</span><br><span class="line">* V$BACKUP_ARCHIVELOG_SUMMARY</span><br><span class="line">  - 记录归档日志的备份情况</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">* V$BACKUP_NONLOGGED</span><br><span class="line">  - displays information about nonlogged block ranges in data file backups</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：备份方式"><a href="#知识点：备份方式" class="headerlink" title="知识点：备份方式"></a>知识点：备份方式</h3><ol>
<li><strong>整体备份和部分备份</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">* 整体备份 Whole Backup</span><br><span class="line">  - 备份整个数据库</span><br><span class="line">  - 包含全部数据文件和至少一个控制文件</span><br><span class="line"></span><br><span class="line">* 部分备份 Partial Backup</span><br><span class="line">  - 部分数据文件</span><br><span class="line">  - 可能包含控制文件</span><br></pre></td></tr></table></figure></li>
<li><strong>冷备和热备</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">* 冷备份 Cold Backup</span><br><span class="line">  - 在数据库一致性关闭的状态下所做的备份，备份的数据库是一致的</span><br><span class="line">  - 冷备不需要归档</span><br><span class="line">  - 冷备份只能还原到备份的时间点，会有数据丢失</span><br><span class="line">  - 只适用于小型不重要的业务，不适用于 OLTP 类型的对连续运行要求高的场景</span><br><span class="line"></span><br><span class="line">* 热备份 Hot Backup</span><br><span class="line">  - 在数据库打开的状态下所做的备份，备份的数据库可以是不一致的</span><br><span class="line">  - 热备需要开启归档模式</span><br><span class="line">  - 热备文件 + 归档日志 + redo，可以恢复到故障时刻，不会数据丢失</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：增量备份"><a href="#知识点：增量备份" class="headerlink" title="知识点：增量备份"></a>知识点：增量备份</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">* 全量备份 Full Backup</span><br><span class="line">  - 备份数据文件的全部 block，亦即 level 0 级备份</span><br><span class="line"></span><br><span class="line">* 增量备份</span><br><span class="line">  - 只备份数据文件发生变动的 block</span><br><span class="line">  - 增量备份要在全备份的基础上进行</span><br><span class="line"></span><br><span class="line">* 累计增量 cumulative incremental</span><br><span class="line">  - 从最近的一次 &lt;=n-1 级的增量备份备份以来变化的数据</span><br><span class="line"></span><br><span class="line">* 差异增量 differenti incremental</span><br><span class="line">  - 从最近的一次 &lt;=n 级的增量备份以来变化的数据</span><br><span class="line"></span><br><span class="line">* 增量备份的级别</span><br><span class="line">  - 旧版本，需要先创建 level 0，才能创建其他 level 的备份</span><br><span class="line">  - 新版本，可以直接创建 level n 的备份，会自动创建 level 0 级备份</span><br><span class="line">  - 差异增量，level 为 n，如 1、2、3</span><br><span class="line">  - 累计增量，level 为 nc，如 1c、2c、3c</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h2 id="11-3-恢复"><a href="#11-3-恢复" class="headerlink" title="11.3 恢复"></a>11.3 恢复</h2><hr>
<h3 id="知识点：还原和恢复"><a href="#知识点：还原和恢复" class="headerlink" title="知识点：还原和恢复"></a>知识点：还原和恢复</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">* 还原 Restore</span><br><span class="line">  - 物理意义上的恢复，文件级的恢复</span><br><span class="line">  - 将物理文件 copy back</span><br><span class="line">  - 恢复后，数据库的时间前进至备份时的时刻</span><br><span class="line"></span><br><span class="line">* 恢复 Recover</span><br><span class="line">  - 逻辑意义上的恢复，数据级的恢复</span><br><span class="line">  - 利用日志进行重做数据文件，读取归档日志和在线日志，将备份时刻点到故障时刻点之间的数据加载回数据文件</span><br><span class="line">  - 恢复后，数据库的时间前进至故障发生的时刻点</span><br></pre></td></tr></table></figure></li>
<li><strong>相关数据字典</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">* V$RECOVER_FILE</span><br><span class="line">  -- 记录需要进行恢复的数据文件</span><br><span class="line">  - 只要字典中有记录，则数据库就无法正常开启或关闭</span><br><span class="line"></span><br><span class="line">* V$RECOVERY_LOG</span><br><span class="line"></span><br><span class="line">* V$RECOVERY_PROGRESS</span><br><span class="line"></span><br><span class="line">* V$RECOVERY_SLAVE</span><br><span class="line"></span><br><span class="line">* V$RECOVERY_STATUS</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：完全恢复和不完全恢复"><a href="#知识点：完全恢复和不完全恢复" class="headerlink" title="知识点：完全恢复和不完全恢复"></a>知识点：完全恢复和不完全恢复</h3><ol>
<li><strong>完全恢复</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 完全恢复 Complete Recovery</span><br><span class="line">  - 数据库可以恢复到发生故障的时间点</span><br><span class="line">  - 已提交的数据不会丢失</span><br><span class="line">  - 不需要进行 resetlog</span><br><span class="line"></span><br><span class="line">* 需要</span><br><span class="line">  - 备份文件，归档日志，日志文件</span><br></pre></td></tr></table></figure></li>
<li><strong>不完全恢复</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 不完全恢复 Incomplete Recovery</span><br><span class="line">  - 数据库只能恢复到发生故障的时间点之前的某个时刻</span><br><span class="line">  - 从恢复时间点到故障时间点的操作全部丢失</span><br><span class="line">  - 可以指定恢复到的时间点、还原点、SCN、日志序列号</span><br><span class="line">  - 需要 resetlog</span><br><span class="line">  - 通常因为某个归档日志错误，或在线日志错误</span><br></pre></td></tr></table></figure></li>
<li><strong>三种不完全恢复</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 在 12C 版本的情况下，三种不完全恢复在 PDB 中已经不适用了，因为 12C 强调的是 PDB 的恢复，CDB 不过是 PDB 的容器</span><br><span class="line"></span><br><span class="line">* 基于用户控制的不完全恢复</span><br><span class="line">  - 指令：RECOVER DATABASE UNTIL CANCEL ;</span><br><span class="line"></span><br><span class="line">* 基于 SCN 的不完全恢复</span><br><span class="line">  - 指令：RECOVER DATABASE UNTIL CHANGE Scn ;</span><br><span class="line"></span><br><span class="line">* 基于时间的不完全恢复</span><br><span class="line">  - 指令：RECOVER DATABASE UNTIL TIME &#x27;Date_Time&#x27; ;</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h2 id="11-4-FRA"><a href="#11-4-FRA" class="headerlink" title="11.4 FRA"></a>11.4 FRA</h2><hr>
<h3 id="知识点：FRA-介绍"><a href="#知识点：FRA-介绍" class="headerlink" title="知识点：FRA 介绍"></a>知识点：FRA 介绍</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - fast recovery area</span><br><span class="line">  - oracle 默认用来存放备份文件、归档日志、闪回日志、冗余文件的目录</span><br><span class="line"></span><br><span class="line">* FRA 的空间管理</span><br><span class="line">  - FRA 的空间使用量到达限制后，会给出提醒</span><br><span class="line">  - 会自动根据 RETENTION POLICY 删除 OBSOLETE 的备份文件</span><br><span class="line">  - 也可以手动删除相关文件</span><br><span class="line">    - DELETE OBSOLETE</span><br><span class="line">    - DELETE EXPIRED</span><br></pre></td></tr></table></figure></li>
<li><strong>FRA 的目录结构</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">* FRA/&lt;control_file&gt;</span><br><span class="line">  - 控制文件冗余</span><br><span class="line"></span><br><span class="line">* FRA/&lt;instance_name&gt;/onlinelog</span><br><span class="line">  - redo 日志冗余</span><br><span class="line"></span><br><span class="line">* FRA/&lt;instance_name&gt;/archivelog</span><br><span class="line">  - 归档日志</span><br><span class="line"></span><br><span class="line">* FRA/&lt;instance_name&gt;/flashback</span><br><span class="line">  - 闪回日志</span><br><span class="line"></span><br><span class="line">* FRA/&lt;instance_name&gt;/autobackup</span><br><span class="line">  - 控制文件自动备份</span><br><span class="line"></span><br><span class="line">* FRA/&lt;instance_name&gt;/backupset</span><br><span class="line">  - CDB 备份文件和归档日志备份</span><br><span class="line"></span><br><span class="line">* FRA/&lt;instance_name&gt;/&lt;pdb_guid&gt;/backupset</span><br><span class="line">  - PDB 备份文件</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
<li><strong>相关参数</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">* DB_RECOVERY_FILE_DEST</span><br><span class="line">  - 指定 FRA 的路径</span><br><span class="line"></span><br><span class="line">* DB_RECOVERY_FILE_DEST_SIZE</span><br><span class="line">  - 指定 FRA 的大小</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
<li><strong>相关数据字典</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">* V$RECOVERY_FILE_DEST</span><br><span class="line"></span><br><span class="line">* V$RECOVERY_FILE_STATUS</span><br><span class="line"></span><br><span class="line">* V$FLASH_RECOVERY_AREA_USAGE</span><br><span class="line">  - 记录 FRA 的使用情况</span><br><span class="line"></span><br><span class="line">* V$RECOVERY_AREA_USAGE</span><br><span class="line">  - 记录 FRA 的使用情况</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h2 id="11-5-归档"><a href="#11-5-归档" class="headerlink" title="11.5 归档"></a>11.5 归档</h2><hr>
<h3 id="知识点：归档日志介绍"><a href="#知识点：归档日志介绍" class="headerlink" title="知识点：归档日志介绍"></a>知识点：归档日志介绍</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 在切换 redo 日志时，将 redo 日志进行保存</span><br><span class="line">  - 归档日志按日期存放</span><br><span class="line"></span><br><span class="line">* 归档模式的切换，只能在 MOUNT 阶段进行</span><br><span class="line"></span><br><span class="line">* 归档日志的存放位置</span><br><span class="line">  - 如果 LOG_ARCHIVE_DEST 和 LOG_ARCHIVE_DEST_n 均为空，则存放在 FRA 中</span><br></pre></td></tr></table></figure></li>
<li><strong>相关参数</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">* LOG_ARCHIVE_DEST</span><br><span class="line">* LOG_ARCHIVE_DUPLEX_DEST</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">* LOG_ARCHIVE_DEST_n</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># LOG_ARCHIVE_FORMAT</span><br><span class="line">  - 指定归档日志的命名，其中必须包含 %s %t %r</span><br><span class="line">  - &lt;string&gt;  -- 直接指定的字符串</span><br><span class="line">  - %s    -- 日志序号</span><br><span class="line">  - %S    -- 日志序号，零填充</span><br><span class="line">  - %t    -- 日志线程号</span><br><span class="line">  - %T    -- 日志线程号，零填充</span><br><span class="line">  - %a    -- activation ID</span><br><span class="line">  - %d     -- database ID</span><br><span class="line">  - %r     -- 自动生成的随机唯一字符</span><br><span class="line"># LOG_ARCHIVE_DEST</span><br><span class="line">  - 指定归档日志的存放位置</span><br><span class="line">  - 只能指定本地地址</span><br><span class="line">  - 和 log_archive_dest_n 不兼容</span><br><span class="line">  - 和 db_recovery_file_dest 不兼容</span><br><span class="line"># LOG_ARCHIVE_DEST_N</span><br><span class="line">  - 指定在 DG 环境中的归档日志的存放位置</span><br><span class="line">  - n 取值为 1-32</span><br><span class="line">  - n &lt;=10，可以设置为本地，也可以设置为远程</span><br><span class="line">  - n &gt;10，只能设置为远程</span><br><span class="line">  - 语法，ALTER SYSTEM SET LOG_ARCHIVE_DEST_1=&#x27;location=&lt;PATH&gt;&#x27;;</span><br><span class="line"># LOG_ARCHIVE_DEST_STATE_N</span><br><span class="line">  - 指定对应的 LOG_ARCHIVE_DEST_N 的状态</span><br><span class="line">  - 对每一个 LOG_ARCHIVE_DEST_N 必须同时指定 LOG_ARCHIVE_DEST_STATE_N</span><br></pre></td></tr></table></figure></li>
<li><strong>相关数据字典</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">* V$ARCHIVED_LOG</span><br><span class="line">  - 记录已归档的日志，包括已删除的归档日志</span><br><span class="line">  - 信息来自控制文件</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">* V$ARCHIVE</span><br><span class="line">  - 记录还未归档的 redo 日志</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">* V$ARCHIVE_DEST</span><br><span class="line">  - 记录所有的 LOG_ARCHIVE_DEST_N 参数的设置</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">* V$ARCHIVE_DEST_STATUS</span><br><span class="line">  - 记录所有的 LOG_ARCHIVE_DEST_STATE_N 参数的设置</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">* V$ARCHIVE_GAP</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">* V$ARCHIVE_PROCESSES</span><br><span class="line">  - 记录 ARCH 进程的信息</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：ARCHIVE-LOG-LIST-语句"><a href="#知识点：ARCHIVE-LOG-LIST-语句" class="headerlink" title="知识点：ARCHIVE LOG LIST 语句"></a>知识点：ARCHIVE LOG LIST 语句</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 查看当前数据库是否开启了归档模式</span><br><span class="line">  - 查看归档模式的信息</span><br></pre></td></tr></table></figure></li>
<li><strong>语法</strong><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ARCHIVE LOG LIST ;</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：ALTER-DATABASE-ARCHIVELOG-语句"><a href="#知识点：ALTER-DATABASE-ARCHIVELOG-语句" class="headerlink" title="知识点：ALTER DATABASE ARCHIVELOG 语句"></a>知识点：ALTER DATABASE ARCHIVELOG 语句</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">* 作用</span><br><span class="line">  - 数据库启动或者关闭归档模式</span><br></pre></td></tr></table></figure></li>
<li><strong>启动归档模式</strong><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">STARTUP MOUNT ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">ALTER</span> DATABASE ARCHIVELOG [MANUAL] ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">ALTER</span> DATABASE <span class="keyword">OPEN</span> ;</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
<li><strong>关闭归档模式</strong><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">STARTUP MOUNT ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">ALTER</span> DATABASE NOARCHIVELOG ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">ALTER</span> DATABASE <span class="keyword">OPEN</span> ;</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：ALTER-SYSTEM-ARCHIVE-LOG-语句"><a href="#知识点：ALTER-SYSTEM-ARCHIVE-LOG-语句" class="headerlink" title="知识点：ALTER SYSTEM ARCHIVE LOG 语句"></a>知识点：ALTER SYSTEM ARCHIVE LOG 语句</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 手动对 redo 日志进行归档</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
<li><strong>语法</strong><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">*</span> <span class="keyword">ALTER</span> SYSTEN ARCHIVE LOG <span class="keyword">CURRENT</span> ;</span><br><span class="line"><span class="comment">-- 切换当前 redo 日志并归档</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="operator">*</span> <span class="keyword">ALTER</span> <span class="keyword">SYSTEM</span> ARCHIVE LOG <span class="keyword">ALL</span> [<span class="keyword">TO</span> <span class="string">&#x27;Location&#x27;</span>] ;</span><br><span class="line"><span class="comment">-- 手动归档所有尚未归档的 redo 日志</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h2 id="11-6-DRA"><a href="#11-6-DRA" class="headerlink" title="11.6 DRA"></a>11.6 DRA</h2><hr>
<h2 id="11-7-闪回"><a href="#11-7-闪回" class="headerlink" title="11.7 闪回"></a>11.7 闪回</h2><hr>
<h2 id="11-8-额外内容"><a href="#11-8-额外内容" class="headerlink" title="11.8 额外内容"></a>11.8 额外内容</h2><hr>
<h1 id="Chapter12-RMAN"><a href="#Chapter12-RMAN" class="headerlink" title="Chapter12 RMAN"></a>Chapter12 RMAN</h1><hr>
<h2 id="12-1-RMAN-介绍"><a href="#12-1-RMAN-介绍" class="headerlink" title="12.1 RMAN 介绍"></a>12.1 RMAN 介绍</h2><hr>
<h3 id="知识点：RMAN-介绍"><a href="#知识点：RMAN-介绍" class="headerlink" title="知识点：RMAN 介绍"></a>知识点：RMAN 介绍</h3><ol>
<li><strong>介绍</strong></li>
</ol>
<hr>
<h3 id="知识点：RMAN-TARGET-指令"><a href="#知识点：RMAN-TARGET-指令" class="headerlink" title="知识点：RMAN TARGET 指令"></a>知识点：RMAN TARGET 指令</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 用于使用 RMAN 连接到数据库</span><br><span class="line"></span><br><span class="line">* 前提</span><br><span class="line">  - 数据库启动到 mount 阶段</span><br><span class="line">  - 监听配置了 IPC 协议</span><br><span class="line">  - 监听已打开并已经注册了服务</span><br><span class="line"></span><br><span class="line">* 环境变量</span><br><span class="line">  * ORACLE_BASE</span><br><span class="line">  * ORACLE_HOME</span><br><span class="line">  * ORACLE_SID</span><br><span class="line">  * NLS_DATE_FORMAT</span><br></pre></td></tr></table></figure></li>
<li><strong>常用命令</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">* RMAN TARGET / ;</span><br><span class="line">  - 本地连接</span><br><span class="line"></span><br><span class="line">* RMAN TARGET SYS/PassWord@Service ;</span><br><span class="line">  - 网络连接</span><br><span class="line"></span><br><span class="line">* RMAN TARGET &quot; &#x27;sys/PassWord&#x27;@Service as sysdba &quot; ;</span><br><span class="line">  - 带特殊字符密码的网络连接</span><br><span class="line"></span><br><span class="line">* RMAN TARGET ... cmdfile &#x27;File_Name&#x27; ;</span><br><span class="line">  - 登录 RMAN 并执行文件中的命令</span><br><span class="line">  - 文件名如果使用相对路径，则第一个字符不能是数字</span><br><span class="line"></span><br><span class="line">* RMAN TARGET / AS SYSDBA DEBUG [TRACE &#x27;file_name&#x27;] ;</span><br><span class="line">  - 启动 RMAN DEBUG 并将日志导入到附加文件</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h2 id="12-2-RMAN-配置"><a href="#12-2-RMAN-配置" class="headerlink" title="12.2 RMAN 配置"></a>12.2 RMAN 配置</h2><hr>
<h3 id="知识点：RMAN-配置介绍"><a href="#知识点：RMAN-配置介绍" class="headerlink" title="知识点：RMAN 配置介绍"></a>知识点：RMAN 配置介绍</h3><ol>
<li><strong>介绍</strong></li>
<li><strong>相关数据字典</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">* V$RMAN_CONFIGURATION</span><br><span class="line">  - 记录所有 RMAN 配置的非默认值设置</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：RMAN-配置详解"><a href="#知识点：RMAN-配置详解" class="headerlink" title="知识点：RMAN 配置详解"></a>知识点：RMAN 配置详解</h3><ol>
<li><strong>默认备份设备 DEFAULT DEVICE TYPE</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">* 格式</span><br><span class="line">  CONFIGURE DEFAULT DEVICE TYPE TO DISK</span><br><span class="line"></span><br><span class="line">* 介绍</span><br><span class="line">  - 指定 RMAN 在进行备份时使用的默认备份设备</span><br></pre></td></tr></table></figure></li>
<li><strong>备份设备配置 DEVICE TYPE</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">* 格式</span><br><span class="line">  CONFIGURE DEVICE TYPE DISK PARALLELISM 1 BACKUP TYPE TO BACKUPSET</span><br><span class="line"></span><br><span class="line">* 介绍</span><br><span class="line">  - 指定某一个备份设备的细节，如并行数、压缩、备份文件格式等</span><br></pre></td></tr></table></figure></li>
<li><strong>备份通道 CHANNEL</strong></li>
<li><strong>保留策略 RETENTION POLICY</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">* 格式</span><br><span class="line">  CONFIGURE RETENTION POLICY TO &#123; REDUNDANCY Number | RECOVERY WINDOW OF Number DAYS | NONE &#125;</span><br></pre></td></tr></table></figure></li>
<li><strong>控制文件自动备份 CONTROLFILE AUTOBACKUP</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">* 格式</span><br><span class="line">  CONFIGURE CONTROLFILE AUTOBACKUP &#123;ON|OFF&#125;</span><br><span class="line">  CONFIGURE CONTROLFILE AUTOBACKUP FORMAT FOR DEVICE TYPE DISK TO &#x27;%F&#x27;</span><br><span class="line"></span><br><span class="line">* 介绍</span><br><span class="line">  - 配置 RMAN 开启控制文件自动备份、配置控制文件自动备份的保存路径</span><br><span class="line">  - 在连接到 CDB 时，每次手动备份时，都会自动备份控制文件和参数文件，不管此次备份是否已经添加的控制文件</span><br><span class="line">  - 控制文件的自动备份放在 &lt;FRA_HOME&gt;/autobackup 目录下</span><br></pre></td></tr></table></figure></li>
<li><strong>压缩算法 COMPRESSION ALGORITHM</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">* 格式</span><br><span class="line">  CONFIGURE COMPRESSION ALGORITHM &#x27;BASIC&#x27; AS OF RELEASE &#x27;DEFAULT&#x27; OPTIMIZE FOR LOAD TRUE</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">* 介绍</span><br><span class="line">  - 配置 RMAN 使用的压缩算法</span><br><span class="line">  - 压缩算法压缩比：LOW &lt; MEDIA &lt; BASIC &lt; HIGH</span><br><span class="line">  - 除 BASIC 外，其他的压缩算法需要使用 Advanced Compression Option 付费功能</span><br><span class="line">  - 只有 BACKUPSET 可以进行压缩，COPY IMAGE 不能进行压缩备份</span><br><span class="line">  - 默认不进行压缩，指定 BACKUP AS COMPRESSED BACKUP 指定进行压缩备份</span><br><span class="line"></span><br><span class="line">* 相关数据字典</span><br><span class="line">  - V$RMAN_COMPRESSION_ALGORITHM 数据库支持的 compression_algorithm_name</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
<li><strong>其他配置</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">CONFIGURE BACKUP OPTIMIZATION &#123;ON|OFF&#125;</span><br><span class="line">  - RMAN 优化备份，数据文件的 SCN 若自上次备份没有变化，则此次不备份</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">CONFIGURE DATAFILE BACKUP COPIES FOR DEVICE TYPE DISK TO 1;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">CONFIGURE ARCHIVELOG BACKUP COPIES FOR DEVICE TYPE DISK TO 1;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">CONFIGURE MAXSETSIZE TO UNLIMITED</span><br><span class="line">  - 备份文件单个文件的最大值</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">CONFIGURE ENCRYPTION FOR DATABASE OFF;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">CONFIGURE ENCRYPTION ALGORITHM &#x27;AES128&#x27;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">CONFIGURE RMAN OUTPUT TO KEEP FOR 7 DAYS; # default</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">CONFIGURE ARCHIVELOG DELETION POLICY TO NONE</span><br><span class="line">  - RMAN 备份归档日志后是否删除归档日志</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">CONFIGURE SNAPSHOT CONTROLFILE NAME TO &#x27;/u01/app/oracle/product/18c/dbs/snapcf_orcla.f&#x27;</span><br><span class="line">  - RMAN 控制文件快照</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：RMAN-SHOW-命令"><a href="#知识点：RMAN-SHOW-命令" class="headerlink" title="知识点：RMAN SHOW 命令"></a>知识点：RMAN SHOW 命令</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 查看 RMAN 的配置的情况</span><br></pre></td></tr></table></figure></li>
<li><strong>格式</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">RMAN&gt; SHOW ALL ;</span><br><span class="line"></span><br><span class="line">RMAN&gt; SHOW Config_Name ;</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：RMAN-CONFIGURE-命令"><a href="#知识点：RMAN-CONFIGURE-命令" class="headerlink" title="知识点：RMAN CONFIGURE 命令"></a>知识点：RMAN CONFIGURE 命令</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 永久修改 RMAN 的配置</span><br></pre></td></tr></table></figure></li>
<li><strong>格式</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">RMAN&gt; CONFIGURE Config_Name Value [FOR DB_UNIQUE_NAME &#123;ALL| &#x27;db_unique_name&#x27;&#125;] ;</span><br><span class="line"></span><br><span class="line">RMAN&gt; CONFIGURE Config_Name CLEAR ;</span><br><span class="line">-- 恢复为默认值</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：RMAN-SET-命令"><a href="#知识点：RMAN-SET-命令" class="headerlink" title="知识点：RMAN SET 命令"></a>知识点：RMAN SET 命令</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 临时修改 RMAN 的配置</span><br><span class="line">  - 修改仅在一次 Job 或一次 Session 中生效</span><br><span class="line">    - 在 RUN Block 中，则效果仅在 Job 中生效</span><br><span class="line">    - 在 RMAN Prompt，则效果仅在 Session 中生效</span><br><span class="line"></span><br><span class="line">* 常用格式</span><br><span class="line">  RUN &#123; SET ...; Rman_Command ; ...&#125;</span><br></pre></td></tr></table></figure></li>
<li><strong>格式</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">RMAN&gt; SET [SetRmanOption | SetRunOption | SetRmanOrRunOption] ;</span><br></pre></td></tr></table></figure></li>
<li><strong>SetRmanOption 从句</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">BACKUP FILES [FOR DEVICE TYPE &lt;deviceSpecifier&gt;] TO &#123;NOTACCESSIBLE | ACCESSIBLE &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">COMPRESSION ALGORITHM Compression_Algorithm_Name [OPTIMIZE FOR LOAD &#123;TRUE | FALSE&#125;] [AS OF RELEASE quoted_string]</span><br><span class="line">  - 临时指定压缩算法</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">DECRYPTION &#123; &#123; IDENTIFIED BY Pass_Word [, ...] &#125; | &#123; WALLET OPEN IDENTIFIED BY Pass_Word &#125; &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ECHO &#123;OFF | ON&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ENCRYPTION Encryption_Clause[ ...]</span><br><span class="line">  - ALGORITHM &lt;quoted_string&gt;</span><br><span class="line">  - IDENTIFIED BY &lt;Pass_Word&gt; [ONLY]</span><br><span class="line">  - &#123;OFF | ON&#125; [FOR ALL TABLESPACES]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">PASSPHRASE &#123;OFF | ON IDENTIFIED BY &lt;Pass_Word&gt;&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">PREPLUGIN CONTAINER &#123;CLEAR | &lt;pdb_name&gt;&#125;</span><br></pre></td></tr></table></figure></li>
<li><strong>SetRunOption 从句</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">ARCHIVELOG DESTINATION TO &#x27;&lt;log_archive_dest&gt;&#x27;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">BACKUP COPIES &lt;integer&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">MAXCORRUPT FOR DATAFILE &lt;datafileSpec&gt;[, ...] TO &lt;integer&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">NEWNAME FOR &lt;newname_clause&gt; TO &#123;&#x27;&lt;filename&gt;&#x27; | NEW&#125;</span><br><span class="line">  - BLOCK CHANGE TRACKING FILE</span><br><span class="line">  - &#123;DATABASE [ROOT]</span><br><span class="line">  - PLUGGABLE DATABASE &lt;pdb_name&gt;[, ...]</span><br><span class="line">  - DATAFILE &lt;datafileSpec&gt;</span><br><span class="line">  - TABLESPACE [&#x27;]&lt;tablespace_name&gt;[&#x27;]</span><br><span class="line">  - TEMPFILE &lt;tempfileSpec&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">TO RESTORE POINT &lt;restore_point_name&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">UntilClause</span><br><span class="line">  - UNTIL SCN &lt;scn&gt;</span><br><span class="line">  - UNTIL SEQUENCE &lt;sequence_id&gt; [THREAD &lt;thread_id&gt;]</span><br><span class="line">  - UNTIL TIME &#x27;&lt;date_time&gt;&#x27;</span><br></pre></td></tr></table></figure></li>
<li><strong>SetRmanOrRunOption 从句</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">AUXILIARY INSTANCE PARAMETER FILE TO &#x27;&lt;filename&gt;&#x27;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">COMMAND ID TO &#x27;&lt;string&gt;&#x27;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">CONTROLFILE AUTOBACKUP FORMAT FOR DEVICE TYPE &lt;deviceSpecifier&gt; TO &lt;formatSpec&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">DATABASE [&#x27;]&lt;database_name&gt;[&#x27;]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">DBID &lt;integer&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">INCARNATION primaryKey</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">LONG &lt;integer&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">NUMWIDTH &lt;integer&gt;</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h2 id="12-3-RMAN-基础指令"><a href="#12-3-RMAN-基础指令" class="headerlink" title="12.3 RMAN 基础指令"></a>12.3 RMAN 基础指令</h2><hr>
<h3 id="知识点：RMAN-EXIT-命令"><a href="#知识点：RMAN-EXIT-命令" class="headerlink" title="知识点：RMAN EXIT 命令"></a>知识点：RMAN EXIT 命令</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 退出 RMAN 环境</span><br></pre></td></tr></table></figure></li>
<li><strong>格式</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">RMAN&gt; EXIT ;</span><br><span class="line"></span><br><span class="line">RMAN&gt; QUIT ;</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：RMAN-SQL-命令"><a href="#知识点：RMAN-SQL-命令" class="headerlink" title="知识点：RMAN SQL 命令"></a>知识点：RMAN SQL 命令</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">* 作用</span><br><span class="line">  - 执行 SQL 语句</span><br><span class="line">  - 执行 PL/SQL 语句</span><br><span class="line">  - 从 ORACLE 12c 开始，RMAN SQL 命令可以省略 &quot;SQL&quot; 关键字</span><br><span class="line">  - 对于 SQL 和 RMAN 均支持的语句，例如 DELETE，虽然 RMAN 可以自动根据语法进行推测，但仍最好显式的加上 &quot;SQL&quot; 关键字</span><br></pre></td></tr></table></figure></li>
<li><strong>格式</strong><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">RMAN<span class="operator">&gt;</span> [<span class="keyword">SQL</span>] Sql_Statement ;</span><br></pre></td></tr></table></figure></li>
<li><strong>范例</strong><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">RMAN<span class="operator">&gt;</span> <span class="keyword">SELECT</span> <span class="built_in">count</span>(<span class="operator">*</span>) <span class="keyword">FROM</span> dba_tables ;</span><br><span class="line">RMAN<span class="operator">&gt;</span> <span class="keyword">SQL</span> <span class="keyword">SELECT</span> <span class="built_in">count</span>(<span class="operator">*</span>) <span class="keyword">FROM</span> dba_tables ;</span><br><span class="line"><span class="comment">-- 两个语句等价</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
<li><strong>RMAN SQL (Quoted) 命令</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 12c 版本之前的 RMAN SQL 命令</span><br><span class="line">  - 与新版本的区别在于：</span><br><span class="line">    1. Sql_Statement 必须使用单引号 &#x27; &#x27; 包裹</span><br><span class="line">    2. &quot;SQL&quot; 关键字不能省略</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">RMAN&gt; SQL &#x27;Sql_Statement&#x27; ;</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：RMAN-DESCRIBE-命令"><a href="#知识点：RMAN-DESCRIBE-命令" class="headerlink" title="知识点：RMAN DESCRIBE 命令"></a>知识点：RMAN DESCRIBE 命令</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - RMAN 中用于查看表的结果，相当于 sqlplus 的 DESC 命令</span><br></pre></td></tr></table></figure></li>
<li><strong>格式</strong><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">RMAN<span class="operator">&gt;</span> <span class="keyword">DESCRIBE</span> Table_Name[<span class="variable">@Db</span>_Link] ;</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：RMAN-RUN-命令"><a href="#知识点：RMAN-RUN-命令" class="headerlink" title="知识点：RMAN RUN 命令"></a>知识点：RMAN RUN 命令</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 一次性执行多个 RMAN 命令，将多个 RMAN 命令组合为一个命令块，称为 RUN BLOCK，串行的依次执行其中的 RMAN 命令</span><br><span class="line"></span><br><span class="line">* 常用应用方式</span><br><span class="line">  - 在 RMAN 脚本中，使用 RUN BLOCK 来设定 channel 或 SET CONFIGURE，可以在不影响 RMAN 整体环境配置的情况下，临时建立一个隔离的环境域并基于此运行命令</span><br></pre></td></tr></table></figure></li>
<li><strong>格式</strong><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">RMAN<span class="operator">&gt;</span> RUN &#123; Rman_Command ; [ Rman_Command ; ...] &#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">* 格式说明</span><br><span class="line">  - 使用大括号 &quot;&#123; &#125;&quot; 来标记 RUN BLOCK</span><br><span class="line">  - RUN BLOCK 中可以在一行中放入多条命令，也可以分行进行</span><br><span class="line">  - RUN BLOCK 中每一条命令都要以分号结尾，不论是在一行上还是分行</span><br><span class="line">  - RUN 命令不能以分号 &quot;;&quot; 结尾，只能以 &quot;&#125;&quot; 结尾</span><br></pre></td></tr></table></figure></li>
<li><strong>范例</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">RMAN&gt; RUN &#123; SHOW ALL ;</span><br><span class="line">2&gt; CROSSCHECK BACKUP ;</span><br><span class="line">3&gt; CROSSCHECK ARCHIVELOG ALL ;</span><br><span class="line">4&gt; &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h2 id="12-4-RMAN-仓库操作"><a href="#12-4-RMAN-仓库操作" class="headerlink" title="12.4 RMAN 仓库操作"></a>12.4 RMAN 仓库操作</h2><hr>
<h3 id="知识点：RMAN-LIST-命令"><a href="#知识点：RMAN-LIST-命令" class="headerlink" title="知识点：RMAN LIST 命令"></a>知识点：RMAN LIST 命令</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - LIST 命令，用来查看 RMAN repository 中记录的信息，如备份文件信息、归档日志信息等</span><br><span class="line">  - 内容过多，只整理常用用法</span><br></pre></td></tr></table></figure></li>
<li><strong>LIST BACKUP</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 查看 RMAN repository 中记录的 backupset 的信息</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">RMAN&gt; LIST BACKUP ;</span><br><span class="line"></span><br><span class="line">RMAN&gt; LIST EXPIRED BACKUP  ;        -- 查看 expired backupset 的信息</span><br><span class="line"></span><br><span class="line">RMAN&gt; LIST BACKUP SUMMARY ;         -- 查看 backupset 的概要信息</span><br><span class="line"></span><br><span class="line">RMAN&gt; LIST BACKUP BY FILE ;         -- 查看 backupset 中包含的数据文件</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">-- 查看数据库的 backupset 的信息</span><br><span class="line">RMAN&gt; LIST BACKUP OF DATABASE ;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">-- 查看指定的 pdb 的 backupset 的信息</span><br><span class="line">RMAN&gt; LIST BACKUP OF PLUGGABLE DATABASE Pdb_Name [, ...] ;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">-- 查看指定的表空间的 backupset 的信息</span><br><span class="line">RMAN&gt; LIST BACKUP OF TABLEPSACE [Pdb_Name:]&#x27;Tablespace_Name&#x27; [, ...] ;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">-- 查看指定的数据文件的 backupset 的信息</span><br><span class="line">RMAN&gt; LIST BACKUP OF DATAFILE Integer ;</span><br><span class="line">RMAN&gt; LIST BACKUP OF DATAFILE &#x27;Datafile_Name&#x27; ;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">-- 查看控制文件的 backupset 的信息</span><br><span class="line">RMAN&gt; LIST BACKUP OF CONTROLFILE ;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">-- 查看参数文件的 backupset 的信息</span><br><span class="line">RMAN&gt; LIST BACKUP OF SPFILE ;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">-- 查看归档日志的 backupset 的信息</span><br><span class="line">RMAN&gt; LIST BACKUP OF ARCHIVELOG ALL ;</span><br></pre></td></tr></table></figure></li>
<li><strong>LIST ARCHIVELOG</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 查看 RMAN repository 中记录的归档日志文件的信息</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">RMAN&gt; LIAT ARCHIVELOG ALL ;</span><br><span class="line"></span><br><span class="line">RMAN&gt; LIAT ARCHIVELOG LIKE &#x27;String&#x27;;</span><br></pre></td></tr></table></figure></li>
<li><strong>LIST BACKUPSET 和 LIST BACKUPPIECE</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">-- 查看指定的 backupset 的信息</span><br><span class="line">RMAN&gt; LIST BACKUPSET Primary_Key ;</span><br><span class="line"></span><br><span class="line">-- 查看指定的 backuppiece 的信息</span><br><span class="line">RMAN&gt; LIST BACKUPPIECE Primary_Key ;</span><br></pre></td></tr></table></figure></li>
<li><strong>其他格式</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">RMAN&gt; LIST COPY ;</span><br><span class="line"></span><br><span class="line">RMAN&gt; LIST FOREIGN ARCHIVELOG ALL ;</span><br><span class="line"></span><br><span class="line">RMAN&gt; LIST DB_UNIQUE_NAME ALL ;</span><br><span class="line">RMAN&gt; LIST DB_UNIQUE_NAME OF DATABASE [&#x27;Database_Name&#x27;] ;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">RMAN&gt; LIST INCARNATION [OF DATABASE [&#x27;Database_Name&#x27;]] ;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">RMAN&gt; LIST RESTORE POINT ALL ;</span><br><span class="line">RMAN&gt; LIST RESTORE POINT Restore_Point_Name [ For_Db_Unique_Name_Option ] ;</span><br><span class="line"></span><br><span class="line">RMAN&gt; LIST [GLOBAL|ALL] SCRIPT NAMES ;</span><br><span class="line"></span><br><span class="line">RMAN&gt; LIST FAILURE ;</span><br><span class="line">RMAN&gt; LIST FAILURE [ALL|CRITICAL|HIGH|LOW|UNKNOWN|CLOSED|&#x27;Failure_Number&#x27;] [EXCLUDE FALILUE &#x27;Failure_Number&#x27; [, ...]] [DETAIL] ;</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：RMAN-REPORT-命令"><a href="#知识点：RMAN-REPORT-命令" class="headerlink" title="知识点：RMAN REPORT 命令"></a>知识点：RMAN REPORT 命令</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 对 RMAN repository 的内容进行检查，如检查备份文件是否过期</span><br></pre></td></tr></table></figure></li>
<li><strong>常用</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">-- 检查 obsolete 的备份</span><br><span class="line">RMAN&gt; REPORT OBSOLETE ;</span><br><span class="line">RMAN&gt; REPORT OBSOLETE RECOVERY WINDOW OF Number DAYS ;</span><br><span class="line">RMAN&gt; REPORT OBSOLETE REDUNDANCY Number ;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">-- 检查 Needed 的备份，即指定一个保留策略，看在此保留策略下需要用到哪些备份文件</span><br><span class="line">RMAN&gt; REPORT NEED ;</span><br><span class="line">RMAN&gt; REPORT NEED BACKUP DAYS Number ;</span><br><span class="line">RMAN&gt; REPORT NEED BACKUP INCREMENTAL Number ;</span><br><span class="line">RMAN&gt; REPORT NEED BACKUP RECOVERY WINDOW OF Number DAYS ;</span><br><span class="line">RMAN&gt; REPORT NEED BACKUP REDUNDANCY Number ;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">-- 检查 target database 在某个 point in time 时的数据文件的情况</span><br><span class="line">RMAN&gt; REPORT SCHEMA ;</span><br><span class="line">RMAN&gt; REPORT SCHEMA AT SCN Scn ;</span><br><span class="line">RMAN&gt; REPORT SCHEMA AT SEQUENCE Sequence_id [THREAD Thread_id] ;</span><br><span class="line">RMAN&gt; REPORT SCHEMA AT TIME &#x27;Date_Time&#x27; ;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">-- 报告目前数据库中无法恢复的数据文件的情况</span><br><span class="line">-- 原因，自从最后一次备份后，数据文件出现了发生了变更，例如增加/减少了数据文件</span><br><span class="line">-- 此报告如果有内容，则最好重新做一下备份</span><br><span class="line">RMAN&gt; REPORT UNRECOVERABLE ;</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：RMAN-CROSSCHECK-命令"><a href="#知识点：RMAN-CROSSCHECK-命令" class="headerlink" title="知识点：RMAN CROSSCHECK 命令"></a>知识点：RMAN CROSSCHECK 命令</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 检查 RMAN repository 中备份文件的记录是否有效，对物理存在 physical reality 和逻辑记录 logical records 进行对比</span><br></pre></td></tr></table></figure></li>
<li><strong>常用</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">RMAN&gt; CROSSCHECK BACKUP ;</span><br><span class="line"></span><br><span class="line">RMAN&gt; CROSSCHECK ARCHIVELOG ALL ;</span><br><span class="line"></span><br><span class="line">RMAN&gt; CROSSCHECK COPY ;</span><br><span class="line"></span><br><span class="line">RMAN&gt; CROSSCHECK FOREIGN ARCHIVELOG ALL ;</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：RMAN-VALIDATE-命令"><a href="#知识点：RMAN-VALIDATE-命令" class="headerlink" title="知识点：RMAN VALIDATE 命令"></a>知识点：RMAN VALIDATE 命令</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 检查当前数据库中的文件是否存在损坏，如坏块 corrupt blocks 或文件丢失 missing files</span><br><span class="line">  - 检查当前 RMAN repository 中保存的 backupset 是否可以用来进行恢复</span><br><span class="line">  - 检查到的错误 failure，可以使用 LIST FAILURE 来进行查看</span><br></pre></td></tr></table></figure></li>
<li><strong>常用</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">RMAN&gt; VALIDATE DATABASE [ROOT] [INCLUDING CURRENT CONTROLFILE] [PLUS ARCHIVELOG] ;</span><br><span class="line"></span><br><span class="line">RMAN&gt; VALIDATE PLUGGABLE DATABASE Pdb_name [, ...] ;</span><br><span class="line"></span><br><span class="line">RMAN&gt; VALIDATE TABLESPACE [Pdb_name:] &#x27;Tablespace_Name&#x27; [, ...] ;</span><br><span class="line"></span><br><span class="line">RMAN&gt; VALIDATE DATAFILE Number ;</span><br><span class="line">RMAN&gt; VALIDATE DATAFILE &#x27;Datafile_Name&#x27; ;</span><br><span class="line"></span><br><span class="line">RMAN&gt; VALIDATE CURRENT CONTROLFILE ;</span><br><span class="line"></span><br><span class="line">RMAN&gt; VALIDATE SPFILE ;</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">RMAN&gt; VALIDATE BACKUPSET Primary_Key [, ...]</span><br><span class="line"></span><br><span class="line">RMAN&gt; VALIDATE ARCHIVELOG ALL ;</span><br><span class="line">RMAN&gt; VALIDATE ARCHIVELOG LIKE &#x27;String&#x27; ;</span><br><span class="line"></span><br><span class="line">RMAN&gt; VALIDATE RECOVERY AREA ;</span><br><span class="line">RMAN&gt; VALIDATE DB_RECOVERY_FILE_DEST ;</span><br><span class="line">-- 检查 FRA 中所有的文件</span><br><span class="line"></span><br><span class="line">RMAN&gt; VALIDATE RECOVERY FILES ;</span><br><span class="line">-- 检查所有的用来进行恢复的文件，不论是否放在 FRA 中</span><br><span class="line">-- 包括 backupset、archivlog、control file autobackups、data file copies</span><br><span class="line">-- 不包括 flashback logs</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h2 id="12-5-RMAN-备份操作"><a href="#12-5-RMAN-备份操作" class="headerlink" title="12.5 RMAN 备份操作"></a>12.5 RMAN 备份操作</h2><hr>
<h3 id="知识点：RMAN-BACKUP-命令"><a href="#知识点：RMAN-BACKUP-命令" class="headerlink" title="知识点：RMAN BACKUP 命令"></a>知识点：RMAN BACKUP 命令</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 创建备份</span><br><span class="line">  - 可以针对 primary database、standby database、tablespace、data file、control file、、parameter file、archivlog、backup set 创建备份</span><br><span class="line">  - 可以创建 backupset 或 copy 形式的备份</span><br><span class="line"></span><br><span class="line">*</span><br></pre></td></tr></table></figure></li>
<li><strong>常用</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">RMAN&gt; BACKUP DATABASE ;</span><br><span class="line">RMAN&gt; BACKUP DATABASE PLUS ARCHIVELOG INCLUDE CURRENT CONTROLFILE ;</span><br><span class="line"></span><br><span class="line">RMAN&gt; BACKUP PLUGGABLE DATABASE Pdb_Name [, ...] ;</span><br><span class="line"></span><br><span class="line">RMAN&gt; BACKUP TABLESPACE [Pdb_Name:]Tablespace_Name [, ...] ;</span><br><span class="line"></span><br><span class="line">RMAN&gt; BACKUP DATAFILE Number ;</span><br><span class="line">RMAN&gt; BACKUP DATAFILE &#x27;Datafile_Name&#x27; ;</span><br><span class="line"></span><br><span class="line">RMAN&gt; BACKUP CURRENT CONTROLFILE ;</span><br><span class="line"></span><br><span class="line">RMAN&gt; BACKUP SPFILE ;</span><br><span class="line"></span><br><span class="line">RMAN&gt; BACKUP SPFILE CURRENT CONTROLFILE DATABASE ARCHIVELOG ALL ;</span><br><span class="line">-- 同时备份多个文件</span><br><span class="line"></span><br><span class="line">RMAN&gt; BACKUP INCREMENTAL LEVEL 1 DATABASE INCLUDE CURRENT CONTROLFILE ;</span><br><span class="line">-- 进行增量备份</span><br><span class="line"></span><br><span class="line">RMAN&gt; BACKUP SECTION SIZE 1G DATABASE INCLUDE CURRENT CONTROLFILE ;</span><br><span class="line">-- 进行备份分片</span><br></pre></td></tr></table></figure></li>
<li><strong>格式</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">RMAN&gt; BACKUP [Backup_Operand [ ...]] Backup_Spec [ ...] [PLUS ARCHIVELOG [ Backup_Spec_Operand [ ...] ] ] ;</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：RMAN-BACKUP-Backup-Operand-从句"><a href="#知识点：RMAN-BACKUP-Backup-Operand-从句" class="headerlink" title="知识点：RMAN BACKUP Backup_Operand 从句"></a>知识点：RMAN BACKUP Backup_Operand 从句</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 指定进行备份时的整体选项</span><br></pre></td></tr></table></figure></li>
<li><strong>常用选项</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">* AS [NONSPARSE|SPARSE] [COMPRESSED] BACKUPSET</span><br><span class="line">* AS [NONSPARSE|SPARSE] COPY</span><br><span class="line">-- 指定备份文件的类型，backupset 或 copy</span><br><span class="line">-- 默认为 backupset</span><br><span class="line"></span><br><span class="line">* FULL</span><br><span class="line">-- 进行全量备份</span><br><span class="line"></span><br><span class="line">* [CUMULATIVE] INCREMENTAL LEVEL Level</span><br><span class="line">* INCREMENTAL FROM SCN scn</span><br><span class="line">-- 进行增量备份</span><br><span class="line">-- 省略 CUMULATIVE 代表差异增量备份</span><br><span class="line">-- 加上 CUMULATIVE 代表累计增量备份</span><br><span class="line"></span><br><span class="line">* SECTION SIZE Size</span><br><span class="line">-- 进行备份分片</span><br><span class="line"></span><br><span class="line">* TAG &#x27;Tag&#x27;</span><br><span class="line">-- 指定标签</span><br><span class="line"></span><br><span class="line">* VALIDATE</span><br><span class="line">-- 不备份，只是检查</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
<li><strong>其他选项</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line">* CHANNEL &#x27;Channel_Id&#x27;</span><br><span class="line">-- 指定 BACKUP 使用的 channel</span><br><span class="line"></span><br><span class="line">* CHECK LOGICAL</span><br><span class="line">-- 备份的同时对数据文件执行 VALIDATE 检查损坏</span><br><span class="line"></span><br><span class="line">* COPIES Integer</span><br><span class="line">-- 指定多路备份</span><br><span class="line"></span><br><span class="line">* DEVICE TYPE DeviceSpecifier</span><br><span class="line">-- 指定存放备份文件的设备</span><br><span class="line"></span><br><span class="line">* DISKRATIO Integer</span><br><span class="line"></span><br><span class="line">* DURATION Hours:Minites [ &#123;MINIMIZE LOAD|TIME&#125; ] [PARTIAL]</span><br><span class="line">-- 指定 BACKUP 命令的最大执行时间</span><br><span class="line">-- MINIMIZED LOAD，在备份时会尽量降低负载，使备份行为的耗时增大，使备份操作的耗时基本恰好为 DURATION 指定的时间</span><br><span class="line">-- MINIMIZED TIME，在备份时会尽量提高负载，降低备份操作的实际耗时</span><br><span class="line"></span><br><span class="line">* DB_FILE_NAME_CONVERT ( &#123;&#x27;String_Pattern&#x27;, &#x27;String_Pattern&#x27;&#125; [, ...] )</span><br><span class="line">-- 指定映像副本的文件名转换字符对</span><br><span class="line"></span><br><span class="line">* FILESPERSET Integer</span><br><span class="line"></span><br><span class="line">* FORCE</span><br><span class="line"></span><br><span class="line">* AUXILIARY FORMAT &#123; FormatSpec [, ...] | NEW&#125;</span><br><span class="line">* FORMAT FormatSpec [, ...]</span><br><span class="line">* TO DESTINATION &#x27;File_Dest&#x27; [, ...]</span><br><span class="line">-- 指定备份文件的文件名格式和文件</span><br><span class="line"></span><br><span class="line">* FOR RECOVER OF COPY [&#123;&#123;DATAFILECOPY FORMAT FormatSpec&#125;|&#123;WITH TAG &#x27;Tag&gt;&#x27;&#125;&#125; [ ...]]</span><br><span class="line">* FOR RECOVER OF TAG &#x27;Tag&#x27;</span><br><span class="line"></span><br><span class="line">* FOR TRANSPORT</span><br><span class="line">* FOR TRANSPORT ALLOW INCONSISTENT</span><br><span class="line">* FOR TRANSPORT UNPLUG INTO &#x27;File_Name&#x27;</span><br><span class="line">-- 创建用于可传输操作的 backupset 文件</span><br><span class="line"></span><br><span class="line">- TO PLATFORM Platform_Name</span><br><span class="line">- TO PLATFORM Platform_Name ALLOW INCONSISTENT</span><br><span class="line">- TO PLATFORM Platform_Name UNPLUG INTO &#x27;&lt;file_name&gt;&#x27;</span><br><span class="line">-- 创建用于可传输操作的 backupset 文件并转换字节序</span><br><span class="line"></span><br><span class="line">* FROM PLATFORM &#x27;Platform_Name&#x27;</span><br><span class="line"></span><br><span class="line">- NOKEEP</span><br><span class="line">- KEEP FOREVER [RESTORE POINT Restore_Point_Name]</span><br><span class="line">- KEEP UNTIL TIME &#x27;Date_Time&#x27; [RESTORE POINT Restore_Point_Name]</span><br><span class="line">-- 指定备份文件的保留时间</span><br><span class="line">-- 会覆盖 RMAN 的保留策略 RETENTION POLICY</span><br><span class="line">-- 会自动创建还原点</span><br><span class="line"></span><br><span class="line">* MAXSETSIZE Size</span><br><span class="line"></span><br><span class="line">* NOT BACKED UP</span><br><span class="line">* NOT BACKED UP AT ANY SCN</span><br><span class="line">* NOT BACKED UP Integer</span><br><span class="line">* NOT BACKED UP SINCE TIME &#x27;Date_Time&#x27;</span><br><span class="line"></span><br><span class="line">* NOCHECKSUM</span><br><span class="line"></span><br><span class="line">* NOEXCLUDE</span><br><span class="line"></span><br><span class="line">* POOL Integer</span><br><span class="line"></span><br><span class="line">* PROXY [ONLY]</span><br><span class="line"></span><br><span class="line">* REUSE</span><br><span class="line"></span><br><span class="line">* SKIP INACCESSIBLE</span><br><span class="line">* SKIP OFFLINE</span><br><span class="line">* SKIP READONLY</span><br><span class="line">-- 不备份某些数据文件文件</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：RMAN-BACKUP-Backup-Spec-从句"><a href="#知识点：RMAN-BACKUP-Backup-Spec-从句" class="headerlink" title="知识点：RMAN BACKUP Backup_Spec 从句"></a>知识点：RMAN BACKUP Backup_Spec 从句</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 指定备份的目标</span><br></pre></td></tr></table></figure></li>
<li><strong>常用内容</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">* SPFILE</span><br><span class="line"></span><br><span class="line">* CURRENT CONTROLFILE</span><br><span class="line"></span><br><span class="line">* DATABASE [ROOT]</span><br><span class="line"></span><br><span class="line">* PLUGGABLE DATABASE Pdb_Name [, ...]</span><br><span class="line"></span><br><span class="line">* TABLESPACE [Pdb_Name:]Tablespace_Name [, ...]</span><br><span class="line"></span><br><span class="line">* DATAFILE &#123; Number | &#x27;Datafile_Name&#x27; &#125; [, ...]</span><br><span class="line"></span><br><span class="line">* ARCHIVELGO ALL</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
<li><strong>其他内容</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">* BACKUPSET ALL</span><br><span class="line">* BACKUPSET Primary_Key [, ...]</span><br><span class="line">* BACKUPPIECE &#x27;File_Name&#x27; [, ...]</span><br><span class="line">* BACKUPSET FROM TAG &#x27;Tag&#x27; [, ...]</span><br><span class="line">* BACKUPSET COMPLETED &#123; BEFORE | AFTER| BETWEEN &#x27;date_string&#x27; AND &#125; &#x27;date_string&#x27;</span><br><span class="line">-- 对 backupset 进行二次备份</span><br><span class="line">-- 一般用于将 DISK 的备份传导到磁带上</span><br><span class="line"></span><br><span class="line">* CONTROLFILECOPY ALL</span><br><span class="line">* CONTROLFILECOPY LIKE &#x27;String&#x27;</span><br><span class="line">* CONTROLFILECOPY &#x27;File_Name&#x27;</span><br><span class="line">-- 对控制文件的映像副本进行二次备份</span><br><span class="line"></span><br><span class="line">* COPY OF DATABASE [ROOT]</span><br><span class="line">* COPY OF PLUGGABLE DATABASE Pdb_Name [, ...]</span><br><span class="line">* COPY OF DATAFILE &#123; Number|&#x27;Datafile_Name&#x27; &#125; [, ...]</span><br><span class="line">* COPY OF TABLESPACE [Pdb_Name:]Tablespace_Name [, ...]</span><br><span class="line">-- 对数据库和数据文件的映像副本进行二次备份</span><br><span class="line"></span><br><span class="line">* DATAFILECOPY &#x27;Datafile_Name&#x27; [, ...]</span><br><span class="line">* DATAFILECOPY ALL [NODUPLICATES]</span><br><span class="line">* DATAFILECOPY LIKE &#x27;String&#x27; [NODUPLICATES]</span><br><span class="line">* DATAFILECOPY FROM TAG &#x27;Tag&#x27; [, ...] [NODUPLICATES]</span><br><span class="line">-- 对数据文件的映像进行二次备份</span><br><span class="line"></span><br><span class="line">* DATAPUMP [&#123;FORMAT FormatSpec&#125;[ ...]]</span><br><span class="line">-- 导出对象的元数据</span><br><span class="line"></span><br><span class="line">* RECOVERY AREA</span><br><span class="line">* DB_RECOVERY_FILE_DEST</span><br><span class="line">-- 对 FRA 区域进行备份</span><br><span class="line"></span><br><span class="line">* RECOVERY FILES</span><br><span class="line">-- 备份当前 catalog 中记录的所有备份文件，不管是否放在 FRA 中</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：RMAN-BACKUP-Backup-Spec-Operand-从句"><a href="#知识点：RMAN-BACKUP-Backup-Spec-Operand-从句" class="headerlink" title="知识点：RMAN BACKUP Backup_Spec_Operand 从句"></a>知识点：RMAN BACKUP Backup_Spec_Operand 从句</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 指定备份的额外选项</span><br><span class="line">  - 部分选项与 Backup_Operand 相同，区别是 Backup_Operand 作用于整个 BACKUP 命令，Backup_Spec_Operand 只作用于指定的备份对象</span><br></pre></td></tr></table></figure></li>
<li><strong>常用内容</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">* INCLUDE CURRENT CONTROLFILE</span><br><span class="line"></span><br><span class="line">* DELETE [ALL] INPUT</span><br><span class="line">-- 备份归档日志时，在完成备份后就删除原始归档日志</span><br></pre></td></tr></table></figure></li>
<li><strong>其他内容</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">* CHANNEL &#x27;Channel_Id&#x27;</span><br><span class="line"></span><br><span class="line">* DISKRATIO Integer</span><br><span class="line"></span><br><span class="line">* FILESPERSET Integer</span><br><span class="line"></span><br><span class="line">* FORCE</span><br><span class="line"></span><br><span class="line">* AUXILIARY FORMAT &#123;FormatSpec [, ...] | NEW&#125;</span><br><span class="line">* FORMAT FormatSpec [, ...]</span><br><span class="line">* TO DESTINATION &#x27;File_Dest&gt;&#x27; [, ...]</span><br><span class="line"></span><br><span class="line">* FROM TAG &#x27;Tag&#x27;</span><br><span class="line"></span><br><span class="line">* NOKEEP</span><br><span class="line">* KEEP FOREVER [RESTORE POINT Restore_Point_Name]</span><br><span class="line">* KEEP UNTIL TIME &#x27;Date_Time&#x27; [RESTORE POINT Restore_Point_Name]</span><br><span class="line"></span><br><span class="line">* MAXSETSIZE Size</span><br><span class="line"></span><br><span class="line">* NOT BACKED UP</span><br><span class="line">* NOT BACKED UP AT ANY SCN</span><br><span class="line">* NOT BACKED UP Integer</span><br><span class="line">* NOT BACKED UP SINCE TIME &#x27;Date_Time&#x27;</span><br><span class="line"></span><br><span class="line">* NOEXCLUDE</span><br><span class="line"></span><br><span class="line">* POOL Integer</span><br><span class="line"></span><br><span class="line">* REUSE</span><br><span class="line"></span><br><span class="line">* SECTION SIZE Size</span><br><span class="line"></span><br><span class="line">* TAG &#x27;&lt;tag_name&gt;&#x27;</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：RMAN-BACKUP-FormatSpec-从句"><a href="#知识点：RMAN-BACKUP-FormatSpec-从句" class="headerlink" title="知识点：RMAN BACKUP FormatSpec 从句"></a>知识点：RMAN BACKUP FormatSpec 从句</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line"></span><br><span class="line">--------------------</span><br><span class="line">### 知识点：RMAN DELETE 命令</span><br><span class="line">1. **介绍**</span><br></pre></td></tr></table></figure></li>
</ol>
<ul>
<li><p>介绍</p>
<ul>
<li>删除备份，包括 RMAN repository 中的记录和物理文件</li>
</ul>
</li>
<li><p>用户确认</p>
<ul>
<li>默认情况下，在进行实际删除前，RMAN 会要求用户对待删除的文件进行确认</li>
<li>指定 NOPROMPT 选项可以覆盖此设定<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">2. **格式**</span><br></pre></td></tr></table></figure>
RMAN&gt; DELETE [EXPIRE|FORCE|NOPROMPT] … ;<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">  * EXPIRE</span><br><span class="line">    - 删除 RMAN repository 标记为 EXPIRE 的记录</span><br><span class="line"></span><br><span class="line">  * FORCE</span><br><span class="line">    - 强行删除某个备份文件及其在 RMAN repository 的记录，不论其文件是否真实存在于存储介质上</span><br><span class="line"></span><br><span class="line">  * NOPROMPT</span><br><span class="line">    - 在删除备份时，不需要进行用户确认</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
</ul>
<ol start="3">
<li><strong>常用</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">RMAN&gt; DELETE OBSOLETE ;</span><br><span class="line">-- 删除标记为 OBSOLETE 的备份</span><br><span class="line">-- 包括 backupset、archivelog、control file autobackup</span><br><span class="line"></span><br><span class="line">RMAN&gt; DELETE ARCHIVELOG ALL ;</span><br><span class="line">RMAN&gt; DELETE ARCHIVELOG LIKE &#x27;String&#x27; ;</span><br><span class="line"></span><br><span class="line">RMAN&gt; DELETE BACKUP ;</span><br><span class="line">RMAN&gt; DELETE BACKUP OF DATABASE ;</span><br><span class="line">RMAN&gt; DELETE BACKUP OF PLUGGABLE DATABASE Pdb_Name [, ...] ;</span><br><span class="line">-- 删除全部备份文件</span><br><span class="line"></span><br><span class="line">RMAN&gt; DELETE BACKUP OF TABLESPACE [Pdb_Name:]Tablesapce_Name [, ...] ;</span><br><span class="line">RMAN&gt; DELETE BACKUP OF DATAFILE Number ;</span><br><span class="line">RMAN&gt; DELETE BACKUP OF DATAFILE &#x27;Datafile_Name&#x27; ;</span><br><span class="line"></span><br><span class="line">RMAN&gt; DELETE BACKUP OF CONTROL FILE ;</span><br><span class="line">RMAN&gt; DELETE BACKUP OF SPFILE ;</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h2 id="11-6-RMAN-恢复操作"><a href="#11-6-RMAN-恢复操作" class="headerlink" title="11.6 RMAN 恢复操作"></a>11.6 RMAN 恢复操作</h2><hr>
<h2 id="11-7-常见故障"><a href="#11-7-常见故障" class="headerlink" title="11.7 常见故障"></a>11.7 常见故障</h2><hr>
<h1 id="Chapter13-ASM"><a href="#Chapter13-ASM" class="headerlink" title="Chapter13 ASM"></a>Chapter13 ASM</h1><hr>
<h1 id="Chapter12-DG"><a href="#Chapter12-DG" class="headerlink" title="Chapter12 DG"></a>Chapter12 DG</h1>
    </div>

    
    
    

    <footer class="post-footer">

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2000/01/01/Blog13-mysql/" rel="prev" title="Blog13-mysql">
                  <i class="fa fa-chevron-left"></i> Blog13-mysql
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2000/01/01/Blog21-hadoop/" rel="next" title="Blog21-hadoop">
                  Blog21-hadoop <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 2000 – 
  <span itemprop="copyrightYear">2024</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">John Doe</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/muse/" rel="noopener" target="_blank">NexT.Muse</a>
  </div>

    </div>
  </footer>

  
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script>

  





  




  

  <script class="next-config" data-name="enableMath" type="application/json">false</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"per_page":true,"tags":"none","cdn":"//cdn.bootcss.com/mathjax/2.7.1/latest.js?config=TeX-AMS-MML_HTMLorMML","js":{"url":"https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js","integrity":"sha256-r+3itOMtGGjap0x+10hu6jW/gZCzxHsoKrOd7gyRSGY="}}</script>
<script src="/js/third-party/math/mathjax.js"></script>



</body>
</html>
