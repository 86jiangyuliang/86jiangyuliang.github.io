<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 5.4.2">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.0.0/css/all.min.css" integrity="sha256-jTIdiMuX/e3DGJUGwl3pKSxuc6YOuqtJYkM0bGQESA4=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"example.com","root":"/","images":"/images","scheme":"Muse","darkmode":false,"version":"8.10.1","exturl":false,"sidebar":{"position":"left","width":500,"display":"always","padding":1,"offset":12},"copycode":false,"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"}}</script><script src="/js/config.js"></script>

    <meta name="description" content="sql">
<meta property="og:type" content="article">
<meta property="og:title" content="Blog12-sql">
<meta property="og:url" content="http://example.com/2000/01/01/Blog12-sql/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="sql">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="1999-12-31T16:00:12.000Z">
<meta property="article:modified_time" content="2023-09-09T07:45:26.348Z">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="http://example.com/2000/01/01/Blog12-sql/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"en","comments":true,"permalink":"http://example.com/2000/01/01/Blog12-sql/","path":"2000/01/01/Blog12-sql/","title":"Blog12-sql"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>Blog12-sql | Hexo</title>
  





  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">Hexo</p>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>







</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Blog12-sql"><span class="nav-text">Blog12-sql</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%B8%AE%E5%8A%A9"><span class="nav-text">帮助</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%86%85%E5%AE%B9%E7%AE%A1%E7%90%86"><span class="nav-text">内容管理</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Chapter01-SQL"><span class="nav-text">Chapter01 SQL</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-1-SQL-%E4%BB%8B%E7%BB%8D"><span class="nav-text">1.1 SQL 介绍</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9ASQL-%E4%BB%8B%E7%BB%8D"><span class="nav-text">知识点：SQL 介绍</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9ASQL-%E8%AF%AD%E6%B3%95%E8%A7%84%E5%88%99"><span class="nav-text">知识点：SQL 语法规则</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1-2-DML"><span class="nav-text">1.2 DML</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9AINSERT-%E8%AF%AD%E5%8F%A5"><span class="nav-text">知识点：INSERT 语句</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9AINSERT-ALL-%E8%AF%AD%E5%8F%A5"><span class="nav-text">知识点：INSERT ALL 语句</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9AUPDATE-%E8%AF%AD%E5%8F%A5"><span class="nav-text">知识点：UPDATE 语句</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9ADELETE-%E8%AF%AD%E5%8F%A5"><span class="nav-text">知识点：DELETE 语句</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9AMERGE-%E8%AF%AD%E5%8F%A5"><span class="nav-text">知识点：MERGE 语句</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1-3-%E4%BA%8B%E5%8A%A1"><span class="nav-text">1.3 事务</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Chapter02-SELECT"><span class="nav-text">Chapter02 SELECT</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#2-1-SELECT-%E5%9F%BA%E7%A1%80"><span class="nav-text">2.1 SELECT 基础</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9ASELECT-%E8%AF%AD%E5%8F%A5%E5%9F%BA%E7%A1%80"><span class="nav-text">知识点：SELECT 语句基础</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A%E5%88%97%E5%88%AB%E5%90%8D"><span class="nav-text">知识点：列别名</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A%E8%A1%A8%E5%88%AB%E5%90%8D"><span class="nav-text">知识点：表别名</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9ADISTINCT-%E5%85%B3%E9%94%AE%E5%AD%97"><span class="nav-text">知识点：DISTINCT 关键字</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9AFROM-%E4%BB%8E%E5%8F%A5"><span class="nav-text">知识点：FROM 从句</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9AWHERE-%E4%BB%8E%E5%8F%A5"><span class="nav-text">知识点：WHERE 从句</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9AGROUP-BY-%E4%BB%8E%E5%8F%A5"><span class="nav-text">知识点：GROUP BY 从句</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9AHAVING-%E4%BB%8E%E5%8F%A5"><span class="nav-text">知识点：HAVING 从句</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9AORDER-BY-%E4%BB%8E%E5%8F%A5"><span class="nav-text">知识点：ORDER BY 从句</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9AOFFSET-%E4%BB%8E%E5%8F%A5"><span class="nav-text">知识点：OFFSET 从句</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9AFETCH-%E4%BB%8E%E5%8F%A5"><span class="nav-text">知识点：FETCH 从句</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9ALIMIT-%E4%BB%8E%E5%8F%A5"><span class="nav-text">知识点：LIMIT 从句</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-2-%E8%BF%9E%E6%8E%A5%E6%9F%A5%E8%AF%A2"><span class="nav-text">2.2 连接查询</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A%E8%BF%9E%E6%8E%A5%E6%9F%A5%E8%AF%A2%E4%BB%8B%E7%BB%8D"><span class="nav-text">知识点：连接查询介绍</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A%E8%BF%9E%E6%8E%A5%E6%9F%A5%E8%AF%A2%E7%A7%8D%E7%B1%BB"><span class="nav-text">知识点：连接查询种类</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9AUSING-%E4%BB%8E%E5%8F%A5"><span class="nav-text">知识点：USING 从句</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9AON-%E4%BB%8E%E5%8F%A5"><span class="nav-text">知识点：ON 从句</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9AJOIN-%E4%BB%8E%E5%8F%A5"><span class="nav-text">知识点：JOIN 从句</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9AOracle-%E8%BF%9E%E6%8E%A5%E6%97%A7%E8%AF%AD%E6%B3%95"><span class="nav-text">知识点：Oracle 连接旧语法</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-3-%E5%AD%90%E6%9F%A5%E8%AF%A2"><span class="nav-text">2.3 子查询</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A%E5%AD%90%E6%9F%A5%E8%AF%A2%E4%BB%8B%E7%BB%8D"><span class="nav-text">知识点：子查询介绍</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A%E5%85%B3%E8%81%94%E5%AD%90%E6%9F%A5%E8%AF%A2"><span class="nav-text">知识点：关联子查询</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9AWITH-%E4%BB%8E%E5%8F%A5"><span class="nav-text">知识点：WITH 从句</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-4-%E9%9B%86%E5%90%88%E6%9F%A5%E8%AF%A2"><span class="nav-text">2.4 集合查询</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A%E9%9B%86%E5%90%88%E8%BF%90%E7%AE%97%E7%AC%A6"><span class="nav-text">知识点：集合运算符</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A%E9%9B%86%E5%90%88%E6%9F%A5%E8%AF%A2"><span class="nav-text">知识点：集合查询</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-5-%E5%88%86%E7%BB%84%E6%9F%A5%E8%AF%A2"><span class="nav-text">2.5 分组查询</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9AGROUPING-SETS-%E4%BB%8E%E5%8F%A5"><span class="nav-text">知识点：GROUPING SETS 从句</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9AROLLUP-%E4%BB%8E%E5%8F%A5"><span class="nav-text">知识点：ROLLUP 从句</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9ACUBE-%E4%BB%8E%E5%8F%A5"><span class="nav-text">知识点：CUBE 从句</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9AGROUP-ID-%E5%87%BD%E6%95%B0"><span class="nav-text">知识点：GROUP_ID 函数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9AGROUPING-%E5%87%BD%E6%95%B0"><span class="nav-text">知识点：GROUPING 函数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9AGROUPING-ID-%E5%87%BD%E6%95%B0"><span class="nav-text">知识点：GROUPING_ID 函数</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-6-%E5%B1%82%E7%BA%A7%E6%9F%A5%E8%AF%A2"><span class="nav-text">2.6 层级查询</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A%E5%B1%82%E7%BA%A7%E6%9F%A5%E8%AF%A2%E4%BB%8B%E7%BB%8D"><span class="nav-text">知识点：层级查询介绍</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A%E5%B1%82%E7%BA%A7%E6%9F%A5%E8%AF%A2%E8%AF%AD%E6%B3%95"><span class="nav-text">知识点：层级查询语法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A%E5%B1%82%E7%BA%A7%E6%9F%A5%E8%AF%A2%E4%BC%AA%E5%88%97"><span class="nav-text">知识点：层级查询伪列</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9ACONNECT-BY-ROOT-%E8%BF%90%E7%AE%97%E7%AC%A6"><span class="nav-text">知识点：CONNECT_BY_ROOT 运算符</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9ASYS-CONNECT-BY-PATH-%E5%87%BD%E6%95%B0"><span class="nav-text">知识点：SYS_CONNECT_BY_PATH 函数</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-7-%E5%85%B6%E4%BB%96%E6%9F%A5%E8%AF%A2"><span class="nav-text">2.7 其他查询</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A%E6%97%B6%E9%97%B4%E6%9C%89%E6%95%88%E6%80%A7%E6%9F%A5%E8%AF%A2"><span class="nav-text">知识点：时间有效性查询</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A%E6%97%B6%E9%97%B4%E6%9C%89%E6%95%88%E6%80%A7%E6%9F%A5%E8%AF%A2%E8%AF%AD%E6%B3%95"><span class="nav-text">知识点：时间有效性查询语法</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Chapter03-SQL-%E5%87%BD%E6%95%B0%E5%92%8C%E8%A1%A8%E8%BE%BE%E5%BC%8F"><span class="nav-text">Chapter03 SQL 函数和表达式</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#3-1-%E5%87%BD%E6%95%B0"><span class="nav-text">3.1 函数</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-2-%E8%81%9A%E5%90%88%E5%87%BD%E6%95%B0"><span class="nav-text">3.2 聚合函数</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-3-%E6%95%B0%E5%AD%A6%E5%87%BD%E6%95%B0"><span class="nav-text">3.3 数学函数</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-4-%E5%AD%97%E7%AC%A6%E5%87%BD%E6%95%B0"><span class="nav-text">3.4 字符函数</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-5-%E4%BC%AA%E5%88%97"><span class="nav-text">3.5 伪列</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9AROWID"><span class="nav-text">知识点：ROWID</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9AROWNUM"><span class="nav-text">知识点：ROWNUM</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Chapter05-%E8%A1%A8"><span class="nav-text">Chapter05 表</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#5-1-%E8%A1%A8"><span class="nav-text">5.1 表</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A%E8%A1%A8"><span class="nav-text">知识点：表</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A%E9%BB%98%E8%AE%A4%E5%80%BC"><span class="nav-text">知识点：默认值</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A%E8%A1%A8%E7%9A%84%E6%B3%A8%E9%87%8A"><span class="nav-text">知识点：表的注释</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-2-%E8%A1%A8-DDL"><span class="nav-text">5.2 表 DDL</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9ACREATE-TABLE-%E8%AF%AD%E5%8F%A5"><span class="nav-text">知识点：CREATE TABLE 语句</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9AALTER-TABLE-%E8%AF%AD%E5%8F%A5"><span class="nav-text">知识点：ALTER TABLE 语句</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9AALTER-TABLE-%E4%BF%AE%E6%94%B9%E5%88%97"><span class="nav-text">知识点：ALTER TABLE 修改列</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9AALTER-TABLE-%E5%88%A0%E9%99%A4%E5%88%97"><span class="nav-text">知识点：ALTER TABLE 删除列</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9AALTER-TABLE-%E6%A0%87%E8%AE%B0%E5%88%97%E4%B8%8D%E5%8F%AF%E7%94%A8"><span class="nav-text">知识点：ALTER TABLE 标记列不可用</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9ADROP-TABLE-%E8%AF%AD%E5%8F%A5"><span class="nav-text">知识点：DROP TABLE 语句</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9ATRUNCATE-TABLE-%E8%AF%AD%E5%8F%A5"><span class="nav-text">知识点：TRUNCATE TABLE 语句</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-3-%E7%BA%A6%E6%9D%9F"><span class="nav-text">5.3 约束</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A%E7%BA%A6%E6%9D%9F"><span class="nav-text">知识点：约束</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A%E7%BA%A6%E6%9D%9F%E7%9A%84%E7%A7%8D%E7%B1%BB"><span class="nav-text">知识点：约束的种类</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A%E5%A4%96%E9%94%AE%E7%BA%A6%E6%9D%9F"><span class="nav-text">知识点：外键约束</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A%E7%BA%A6%E6%9D%9F%E7%9A%84%E5%90%AF%E7%94%A8%E5%92%8C%E7%A6%81%E7%94%A8"><span class="nav-text">知识点：约束的启用和禁用</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A%E7%BA%A6%E6%9D%9F%E7%9A%84%E7%94%9F%E6%95%88%E5%92%8C%E5%A4%B1%E6%95%88"><span class="nav-text">知识点：约束的生效和失效</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A%E7%BA%A6%E6%9D%9F%E7%9A%84%E5%BB%B6%E8%BF%9F%E6%A3%80%E6%9F%A5"><span class="nav-text">知识点：约束的延迟检查</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-4-%E7%BA%A6%E6%9D%9F-DDL"><span class="nav-text">5.4 约束 DDL</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9ACONSTRAINT-%E4%BB%8E%E5%8F%A5"><span class="nav-text">知识点：CONSTRAINT 从句</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9AUSING-INDEX-%E4%BB%8E%E5%8F%A5"><span class="nav-text">知识点：USING INDEX 从句</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9ACREATE-TABLE-%E6%8C%87%E5%AE%9A%E7%BA%A6%E6%9D%9F"><span class="nav-text">知识点：CREATE TABLE 指定约束</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9AALTER-TABLE-%E4%BF%AE%E6%94%B9%E7%BA%A6%E6%9D%9F"><span class="nav-text">知识点：ALTER TABLE 修改约束</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-5-%E5%9B%9E%E6%94%B6%E7%AB%99"><span class="nav-text">5.5 回收站</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A%E5%9B%9E%E6%94%B6%E7%AB%99"><span class="nav-text">知识点：回收站</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9ASHOW-RECYCLEBIN"><span class="nav-text">知识点：SHOW RECYCLEBIN</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9APURGE"><span class="nav-text">知识点：PURGE</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9AFLASHBACK-TABLE-TO-BEFORE-DROP"><span class="nav-text">知识点：FLASHBACK TABLE TO BEFORE DROP</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Chapter06-%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AF%B9%E8%B1%A1"><span class="nav-text">Chapter06 数据库对象</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#6-1-%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AF%B9%E8%B1%A1%E4%BD%93%E7%B3%BB"><span class="nav-text">6.1 数据库对象体系</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A%E6%96%B9%E6%A1%88-SCHEMA"><span class="nav-text">知识点：方案 SCHEMA</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AF%B9%E8%B1%A1"><span class="nav-text">知识点：数据库对象</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A%E6%97%A0%E6%95%88%E5%AF%B9%E8%B1%A1"><span class="nav-text">知识点：无效对象</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#6-2-%E7%B4%A2%E5%BC%95"><span class="nav-text">6.2 索引</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A%E7%B4%A2%E5%BC%95"><span class="nav-text">知识点：索引</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9ACREATE-INDEX"><span class="nav-text">知识点：CREATE INDEX</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9AALTER-INDEX"><span class="nav-text">知识点：ALTER INDEX</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9ADROP-INDEX"><span class="nav-text">知识点：DROP INDEX</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#6-3-%E8%A7%86%E5%9B%BE"><span class="nav-text">6.3 视图</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A%E8%A7%86%E5%9B%BE"><span class="nav-text">知识点：视图</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9ACREATE-VIEW"><span class="nav-text">知识点：CREATE VIEW</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9ADROP-VIEW"><span class="nav-text">知识点：DROP VIEW</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#6-4-%E5%BA%8F%E5%88%97"><span class="nav-text">6.4 序列</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A%E5%BA%8F%E5%88%97"><span class="nav-text">知识点：序列</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A%E5%BA%8F%E5%88%97%E7%9A%84%E6%80%A7%E8%B4%A8"><span class="nav-text">知识点：序列的性质</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A%E7%83%AD%E7%82%B9%E5%9D%97%E9%97%AE%E9%A2%98"><span class="nav-text">知识点：热点块问题</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9ACREATE-SEQUENCE"><span class="nav-text">知识点：CREATE SEQUENCE</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9AALTER-SEQUENCE"><span class="nav-text">知识点：ALTER SEQUENCE</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9ADROP-SEQUENCE"><span class="nav-text">知识点：DROP SEQUENCE</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#6-5-%E5%85%B6%E4%BB%96%E7%B1%BB%E5%9E%8B%E5%AF%B9%E8%B1%A1"><span class="nav-text">6.5 其他类型对象</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A%E5%90%8C%E4%B9%89%E8%AF%8D-Synonym"><span class="nav-text">知识点：同义词 Synonym</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A%E7%9B%AE%E5%BD%95%E5%AF%B9%E8%B1%A1-Directory"><span class="nav-text">知识点：目录对象 Directory</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Chapter07-%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B"><span class="nav-text">Chapter07 数据类型</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#7-1-%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%E4%BB%8B%E7%BB%8D"><span class="nav-text">7.1 数据类型介绍</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A%E5%AD%97%E9%9D%A2%E9%87%8F-Literal"><span class="nav-text">知识点：字面量 Literal</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A%E6%9B%BF%E6%8D%A2%E5%BC%95%E7%94%A8%E7%AC%A6"><span class="nav-text">知识点：替换引用符</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A%E9%9A%90%E5%BC%8F%E8%BD%AC%E6%8D%A2%E5%92%8C%E6%98%BE%E5%BC%8F%E8%BD%AC%E6%8D%A2"><span class="nav-text">知识点：隐式转换和显式转换</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#7-2-%E6%95%B0%E5%80%BC%E5%9E%8B"><span class="nav-text">7.2 数值型</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9ANUMBER-%E5%9E%8B"><span class="nav-text">知识点：NUMBER 型</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9ATO-NUMBER-%E5%87%BD%E6%95%B0"><span class="nav-text">知识点：TO_NUMBER 函数</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#7-3-%E5%AD%97%E7%AC%A6%E5%9E%8B"><span class="nav-text">7.3 字符型</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9AVARCHAR2-%E5%9E%8B"><span class="nav-text">知识点：VARCHAR2 型</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9ACHAR-%E5%9E%8B"><span class="nav-text">知识点：CHAR 型</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9ATO-CHAR-%E5%87%BD%E6%95%B0"><span class="nav-text">知识点：TO_CHAR 函数</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#7-4-%E6%97%A5%E6%9C%9F%E6%97%B6%E9%97%B4%E5%9E%8B"><span class="nav-text">7.4 日期时间型</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9ADATE-%E5%9E%8B"><span class="nav-text">知识点：DATE 型</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9ATIMESTAMP-%E5%9E%8B"><span class="nav-text">知识点：TIMESTAMP 型</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9ATIMESTAMP-WITH-TIME-ZONE-%E5%9E%8B"><span class="nav-text">知识点：TIMESTAMP WITH TIME ZONE 型</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9ATIMESTAMP-WITH-LOCAL-TIME-ZONE-%E5%9E%8B"><span class="nav-text">知识点：TIMESTAMP WITH LOCAL TIME ZONE 型</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9ATO-DATE-%E5%87%BD%E6%95%B0"><span class="nav-text">知识点：TO_DATE 函数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9ATO-TIMESTAMP-%E5%87%BD%E6%95%B0"><span class="nav-text">知识点：TO_TIMESTAMP 函数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A%E6%97%B6%E5%8C%BA-Time-Zone"><span class="nav-text">知识点：时区 Time Zone</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A%E6%97%A5%E6%9C%9F%E6%97%B6%E9%97%B4%E5%9E%8B%E7%9A%84%E7%AE%97%E6%95%B0%E8%BF%90%E7%AE%97"><span class="nav-text">知识点：日期时间型的算数运算</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#7-5-%E6%97%B6%E9%97%B4%E9%97%B4%E9%9A%94%E5%9E%8B"><span class="nav-text">7.5 时间间隔型</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A%E6%97%B6%E9%97%B4%E9%97%B4%E9%9A%94%E5%9E%8B"><span class="nav-text">知识点：时间间隔型</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9AINTERVAL-YEAR-TO-MONTH-%E5%9E%8B"><span class="nav-text">知识点：INTERVAL YEAR TO MONTH 型</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9AINTERVAL-DAY-TO-SECOND-%E5%9E%8B"><span class="nav-text">知识点：INTERVAL DAY TO SECOND 型</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9ATO-YMINTERVAL-%E5%87%BD%E6%95%B0"><span class="nav-text">知识点：TO_YMINTERVAL 函数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9ATO-DSINTERVAL-%E5%87%BD%E6%95%B0"><span class="nav-text">知识点：TO_DSINTERVAL 函数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9ANUMTOYMINTERVAL-%E5%87%BD%E6%95%B0"><span class="nav-text">知识点：NUMTOYMINTERVAL 函数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9ANUMTODSINTERVAL-%E5%87%BD%E6%95%B0"><span class="nav-text">知识点：NUMTODSINTERVAL 函数</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#7-6-%E7%A9%BA%E5%80%BC"><span class="nav-text">7.6 空值</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A%E7%A9%BA%E5%80%BC-NULL"><span class="nav-text">知识点：空值 NULL</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9ANVL-%E5%87%BD%E6%95%B0"><span class="nav-text">知识点：NVL 函数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9ANVL2-%E5%87%BD%E6%95%B0"><span class="nav-text">知识点：NVL2 函数</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#7-7-%E6%A0%BC%E5%BC%8F%E5%8C%96%E6%A8%A1%E5%9E%8B"><span class="nav-text">7.7 格式化模型</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A%E6%A0%BC%E5%BC%8F%E5%8C%96%E6%A8%A1%E5%9E%8B"><span class="nav-text">知识点：格式化模型</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A%E6%95%B0%E5%AD%97%E6%A0%BC%E5%BC%8F%E5%8C%96%E6%A8%A1%E5%9E%8B"><span class="nav-text">知识点：数字格式化模型</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A%E6%95%B0%E5%AD%97%E6%A0%BC%E5%BC%8F%E5%8C%96%E6%A8%A1%E5%9E%8B%E5%85%83%E7%B4%A0"><span class="nav-text">知识点：数字格式化模型元素</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A%E6%97%A5%E6%9C%9F%E6%97%B6%E9%97%B4%E6%A0%BC%E5%BC%8F%E5%8C%96%E6%A8%A1%E5%9E%8B"><span class="nav-text">知识点：日期时间格式化模型</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A%E6%97%A5%E6%9C%9F%E6%97%B6%E9%97%B4%E6%A0%BC%E5%BC%8F%E5%8C%96%E6%A8%A1%E5%9E%8B%E5%85%83%E7%B4%A0"><span class="nav-text">知识点：日期时间格式化模型元素</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A%E6%A0%BC%E5%BC%8F%E5%8C%96%E6%A8%A1%E5%9E%8B%E4%BF%AE%E6%AD%A3%E7%AC%A6"><span class="nav-text">知识点：格式化模型修正符</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#7-8-NLS"><span class="nav-text">7.8 NLS</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9ANLS"><span class="nav-text">知识点：NLS</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A%E5%AD%97%E7%AC%A6%E9%9B%86"><span class="nav-text">知识点：字符集</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9ANLS-SORT-%E5%8F%82%E6%95%B0"><span class="nav-text">知识点：NLS_SORT 参数</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#7-9-%E5%85%B6%E4%BB%96%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B"><span class="nav-text">7.9 其他数据类型</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9ALOB-%E5%9E%8B"><span class="nav-text">知识点：LOB 型</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Chapter08-%E8%A1%A8%E7%9A%84%E9%AB%98%E7%BA%A7%E7%89%B9%E6%80%A7"><span class="nav-text">Chapter08 表的高级特性</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#8-1-%E8%A1%A8%E7%9A%84%E5%B1%9E%E6%80%A7"><span class="nav-text">8.1 表的属性</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A%E8%A1%A8%E7%9A%84%E5%B1%9E%E6%80%A7"><span class="nav-text">知识点：表的属性</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A%E5%8F%AA%E8%AF%BB%E8%A1%A8"><span class="nav-text">知识点：只读表</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#8-2-%E7%89%B9%E6%AE%8A%E5%88%97"><span class="nav-text">8.2 特殊列</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A%E9%9A%90%E8%97%8F%E5%88%97-INIVISIBLE"><span class="nav-text">知识点：隐藏列 INIVISIBLE</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A%E8%99%9A%E6%8B%9F%E5%88%97-VIRTUAL"><span class="nav-text">知识点：虚拟列 VIRTUAL</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A%E8%87%AA%E5%A2%9E%E5%88%97-IDENTITY"><span class="nav-text">知识点：自增列 IDENTITY</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#8-3-%E4%B8%B4%E6%97%B6%E8%A1%A8"><span class="nav-text">8.3 临时表</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#8-4-%E5%A4%96%E9%83%A8%E8%A1%A8"><span class="nav-text">8.4 外部表</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A%E5%A4%96%E9%83%A8%E8%A1%A8"><span class="nav-text">知识点：外部表</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9AOracle-%E5%88%9B%E5%BB%BA%E5%A4%96%E9%83%A8%E8%A1%A8"><span class="nav-text">知识点：Oracle 创建外部表</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#8-5-%E5%88%86%E5%8C%BA%E8%A1%A8"><span class="nav-text">8.5 分区表</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A%E5%88%86%E5%8C%BA%E8%A1%A8"><span class="nav-text">知识点：分区表</span></a></li></ol></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">John Doe</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">19</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
  </nav>
</div>



        </div>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2000/01/01/Blog12-sql/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="John Doe">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
      <meta itemprop="description" content="">
    </span>
    
    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="Blog12-sql | Hexo">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Blog12-sql
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2000-01-01 00:00:12" itemprop="dateCreated datePublished" datetime="2000-01-01T00:00:12+08:00">2000-01-01</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2023-09-09 15:45:26" itemprop="dateModified" datetime="2023-09-09T15:45:26+08:00">2023-09-09</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <hr>
<h1 id="Blog12-sql"><a href="#Blog12-sql" class="headerlink" title="Blog12-sql"></a>Blog12-sql</h1><p><a href="#Chapter01-SQL"><strong>Chapter01 SQL</strong></a></p>
<ul>
<li><a href="#2-1-SQL-%E4%BB%8B%E7%BB%8D">1.1 SQL 介绍</a></li>
<li><a href="#1-2-DML">1.2 DML</a></li>
<li><a href="#1-3-%E4%BA%8B%E5%8A%A1">1.3 事务</a></li>
</ul>
<p><a href="#Chapter02-SELECT"><strong>Chapter02 SELECT</strong></a></p>
<ul>
<li><a href="#2-1-SELECT-%E5%9F%BA%E7%A1%80">2.1 SELECT 基础</a></li>
<li><a href="#2-2-%E8%BF%9E%E6%8E%A5%E6%9F%A5%E8%AF%A2">2.2 连接查询</a></li>
<li><a href="#2-3-%E5%AD%90%E6%9F%A5%E8%AF%A2">2.3 子查询</a></li>
<li><a href="#2-4-%E9%9B%86%E5%90%88%E6%9F%A5%E8%AF%A2">2.4 集合查询</a></li>
<li><a href="#2-5-%E5%88%86%E7%BB%84%E6%9F%A5%E8%AF%A2">2.5 分组查询</a></li>
<li><a href="#2-6-%E5%B1%82%E7%BA%A7%E6%9F%A5%E8%AF%A2">2.6 层级查询</a></li>
<li><a href="#2-7-%E5%85%B6%E4%BB%96%E6%9F%A5%E8%AF%A2">2.7 其他查询</a></li>
</ul>
<p><a href="#Chapter03-%E5%87%BD%E6%95%B0%E5%92%8C%E8%A1%A8%E8%BE%BE%E5%BC%8F"><strong>Chapter03 函数和表达式</strong></a></p>
<ul>
<li><a href="#3-1-%E5%87%BD%E6%95%B0">3.1 函数</a></li>
<li><a href="#3-2-%E8%81%9A%E5%90%88%E5%87%BD%E6%95%B0">3.2 聚合函数</a></li>
<li><a href="#3-3-%E6%95%B0%E5%AD%A6%E5%87%BD%E6%95%B0">3.3 数学函数</a></li>
<li><a href="#3-4-%E5%AD%97%E7%AC%A6%E5%87%BD%E6%95%B0">3.4 字符函数</a></li>
<li><a href="#3-5-%E4%BC%AA%E5%88%97">3.5 伪列</a></li>
</ul>
<p><a href="#Chapter05-%E8%A1%A8"><strong>Chapter05 表</strong></a></p>
<ul>
<li><a href="#5-1-%E8%A1%A8">5.1 表</a></li>
<li><a href="#5-2-%E8%A1%A8-DDL">5.2 表 DDL</a></li>
<li><a href="#5-3-%E7%BA%A6%E6%9D%9F">5.3 约束</a></li>
<li><a href="#5-4-%E7%BA%A6%E6%9D%9F-DDL">5.4 约束 DDL</a></li>
<li><a href="#5-5-%E5%9B%9E%E6%94%B6%E7%AB%99">5.5 回收站</a></li>
</ul>
<p><a href="#Chapter06-%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AF%B9%E8%B1%A1"><strong>Chapter06 数据库对象</strong></a></p>
<ul>
<li><a href="#6-1-%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AF%B9%E8%B1%A1%E4%BD%93%E7%B3%BB">6.1 数据库对象体系</a></li>
<li><a href="#6-2-%E7%B4%A2%E5%BC%95">6.2 索引</a></li>
<li><a href="#6-3-%E8%A7%86%E5%9B%BE">6.3 视图</a></li>
<li><a href="#6-4-%E5%BA%8F%E5%88%97">6.4 序列</a></li>
<li><a href="#6-5-%E5%85%B6%E4%BB%96%E7%B1%BB%E5%9E%8B%E5%AF%B9%E8%B1%A1">6.5 其他类型对象</a></li>
</ul>
<p><a href="#Chapter07-%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B"><strong>Chapter07 数据类型</strong></a></p>
<ul>
<li><a href="#7-1-%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%E4%BB%8B%E7%BB%8D">7.1 数据类型介绍</a></li>
<li><a href="#7-2-%E6%95%B0%E5%80%BC%E5%9E%8B">7.2 数值型</a></li>
<li><a href="#7-3-%E5%AD%97%E7%AC%A6%E5%9E%8B">7.3 字符型</a></li>
<li><a href="#7-4-%E6%97%A5%E6%9C%9F%E6%97%B6%E9%97%B4%E5%9E%8B">7.4 日期时间型</a></li>
<li><a href="#7-5-%E6%97%B6%E9%97%B4%E9%97%B4%E9%9A%94%E5%9E%8B">7.5 时间间隔型</a></li>
<li><a href="#7-6-%E7%A9%BA%E5%80%BC">7.6 空值</a></li>
<li><a href="#7-7-%E6%A0%BC%E5%BC%8F%E5%8C%96%E6%A8%A1%E5%9E%8B">7.7 格式化模型</a></li>
<li><a href="#7-8-NLS">7.8 NLS</a></li>
<li><a href="#7-9-%E5%85%B6%E4%BB%96%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B">7.9 其他数据类型</a></li>
</ul>
<p><a href="#Chapter08-%E8%A1%A8%E7%9A%84%E9%AB%98%E7%BA%A7%E7%89%B9%E6%80%A7"><strong>Chapter08 表的高级特性</strong></a></p>
<ul>
<li><a href="#8-1-%E8%A1%A8%E7%9A%84%E5%B1%9E%E6%80%A7">8.1 表的属性</a></li>
<li><a href="#8-2-%E7%89%B9%E6%AE%8A%E5%88%97">8.2 特殊列</a></li>
<li><a href="#8-3-%E4%B8%B4%E6%97%B6%E8%A1%A8">8.3 临时表</a></li>
<li><a href="#8-4-%E5%A4%96%E9%83%A8%E8%A1%A8">8.4 外部表</a></li>
<li><a href="#8-5-%E5%88%86%E5%8C%BA%E8%A1%A8">8.5 分区表</a></li>
</ul>
<hr>
<h2 id="帮助"><a href="#帮助" class="headerlink" title="帮助"></a>帮助</h2><ol>
<li><strong>ORACLE SQL 文档</strong></li>
</ol>
<ul>
<li>SQL Language Reference <a target="_blank" rel="noopener" href="https://docs.oracle.com/en/database/oracle/oracle-database/18/sqlrf/index.html">https://docs.oracle.com/en/database/oracle/oracle-database/18/sqlrf/index.html</a></li>
</ul>
<ol start="2">
<li><strong>分区表</strong></li>
</ol>
<ul>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/m0_37253968/article/details/120408897">https://blog.csdn.net/m0_37253968/article/details/120408897</a></li>
<li><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/601813504">https://zhuanlan.zhihu.com/p/601813504</a></li>
</ul>
<hr>
<h2 id="内容管理"><a href="#内容管理" class="headerlink" title="内容管理"></a>内容管理</h2><ol>
<li><strong>未整理</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">* 开窗查询</span><br><span class="line"></span><br><span class="line">* depth-first search 深度优先查询？</span><br><span class="line"></span><br><span class="line">* breadth-first search 广度优先查询？</span><br><span class="line"></span><br><span class="line">* insert</span><br><span class="line">  - 传统插入 Conventional insert</span><br><span class="line">  - 直接路径插入 direct-path insert</span><br><span class="line"></span><br><span class="line">* 事务</span><br><span class="line"></span><br><span class="line">* 堆表 heap table</span><br><span class="line"></span><br><span class="line">* 函数</span><br><span class="line"></span><br><span class="line">* 表的属性</span><br><span class="line"></span><br><span class="line">* 临时表</span><br><span class="line"></span><br><span class="line">* 外部表</span><br><span class="line"></span><br><span class="line">* 分区表</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h1 id="Chapter01-SQL"><a href="#Chapter01-SQL" class="headerlink" title="Chapter01 SQL"></a>Chapter01 SQL</h1><hr>
<h2 id="1-1-SQL-介绍"><a href="#1-1-SQL-介绍" class="headerlink" title="1.1 SQL 介绍"></a>1.1 SQL 介绍</h2><hr>
<h3 id="知识点：SQL-介绍"><a href="#知识点：SQL-介绍" class="headerlink" title="知识点：SQL 介绍"></a>知识点：SQL 介绍</h3><ol>
<li><strong>分类</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">* DML</span><br><span class="line">  - SELECT</span><br><span class="line">  - INSERT</span><br><span class="line">  - UPDATE</span><br><span class="line">  - DELETE</span><br><span class="line">  - MERGE</span><br><span class="line"></span><br><span class="line">* DDL</span><br><span class="line">  - CREATE</span><br><span class="line">  - ALTER</span><br><span class="line">  - DROP</span><br><span class="line">  - TRUNCATE</span><br><span class="line"></span><br><span class="line">* DCL</span><br><span class="line">  - GRANT</span><br><span class="line">  - REVOKE</span><br><span class="line"></span><br><span class="line">* TCL</span><br><span class="line">  - COMMIT</span><br><span class="line">  - ROLLBACK</span><br><span class="line">  - SAVEPOINT</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：SQL-语法规则"><a href="#知识点：SQL-语法规则" class="headerlink" title="知识点：SQL 语法规则"></a>知识点：SQL 语法规则</h3><ol>
<li><strong>基本规则</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">* 不区分大小写</span><br><span class="line"></span><br><span class="line">* 使用减号 &#x27;-&#x27; 作为续行符</span><br><span class="line"></span><br><span class="line">* 使用分号 &#x27;;&#x27; semicolon 表示语句结束</span><br><span class="line"></span><br><span class="line">* 关键字不可以缩写或跨行</span><br><span class="line"></span><br><span class="line">* 字符串不可以跨行</span><br><span class="line"></span><br><span class="line">* 注释</span><br><span class="line">  --</span><br><span class="line">  /*...*/</span><br><span class="line">  rem、remark</span><br><span class="line"></span><br><span class="line">* sqlplus 中</span><br><span class="line">  - 在交互界面，一次只能执行一条 sql 语句</span><br><span class="line">  - 在脚本中，一个脚本中可以包含多条 sql 语句</span><br></pre></td></tr></table></figure></li>
<li><strong>编写习惯</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">* 关键字通常大写，其他内容通常小写，如表名、列名</span><br><span class="line"></span><br><span class="line">* 注释最好放在单独一行中，并且不要嵌入在一个 sql statement 中</span><br><span class="line"></span><br><span class="line">* 使用缩进以增加阅读性</span><br><span class="line"></span><br><span class="line">* 子句通常放在单独一行中</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h2 id="1-2-DML"><a href="#1-2-DML" class="headerlink" title="1.2 DML"></a>1.2 DML</h2><hr>
<h3 id="知识点：INSERT-语句"><a href="#知识点：INSERT-语句" class="headerlink" title="知识点：INSERT 语句"></a>知识点：INSERT 语句</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">* 作用</span><br><span class="line">  - INSERT 语句用来向表中插入数据行</span><br><span class="line"></span><br><span class="line">* 不同的数据库的区别</span><br><span class="line">  - Mysql  一条 INSERT 可以插入多个数据行</span><br><span class="line">  - Oracle 一条 INSERT 只能插入一个数据行，称为单表插入 single_table_insert</span><br><span class="line">  - Oracle 通过 INSERT ALL 语法，可以实现一条语句插入个数据行，称为多表插入</span><br><span class="line"></span><br><span class="line">* 关于 Value</span><br><span class="line">  - 可以是字面量</span><br><span class="line">  - 可以是 Function</span><br><span class="line">  - 可以是 Expression</span><br><span class="line">  - 可以是关键字 DEFAULT</span><br><span class="line">  - 可以是关键字 NULL</span><br><span class="line"></span><br><span class="line">* 关于 ColumnName</span><br><span class="line">  - 在 Column_List 中，如果缺失了某个列，则表示此数据行中此列的数据为 NULL</span><br><span class="line">  - 如果省略了 Column_List，则表示按照 CREATE TABLE 时的列顺序指定 Value，此时 Value 的数量必须与 Column 的数量相同，即使是 NULL 值也要显式指定</span><br></pre></td></tr></table></figure></li>
<li><strong>Oracle INSERT 语法</strong><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span></span><br><span class="line">  <span class="keyword">INTO</span> TableName [( ColumnName [, ...] )]</span><br><span class="line">  <span class="keyword">VALUES</span> ( <span class="keyword">Value</span> [, ...] )</span><br><span class="line">  ;</span><br></pre></td></tr></table></figure></li>
<li><strong>Mysql INSERT 语法</strong><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span></span><br><span class="line">  <span class="keyword">INTO</span> TableName [( ColumnName [, ...] )]</span><br><span class="line">  <span class="keyword">VALUES</span> ( <span class="keyword">Value</span> [, ...] ) [, ( <span class="keyword">Value</span> [, ...] ) ...]</span><br><span class="line">  ;</span><br></pre></td></tr></table></figure></li>
<li><strong>子查询方式 INSERT</strong><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 子查询方式 INSERT，使用子查询的结果来指定待插入的数据</span></span><br><span class="line"><span class="keyword">INSERT</span></span><br><span class="line">  <span class="keyword">INTO</span> TableName [( ColumnName [, ...] )]</span><br><span class="line">  Sub_Query</span><br><span class="line">  ;</span><br></pre></td></tr></table></figure></li>
<li><strong>内联视图方式 INSERT</strong><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 内联视图方式 INSERT</span></span><br><span class="line"><span class="comment">-- 使用内联视图来确定待插入的列，内联视图返回的行不重要，即使 WHERE 1=0 也可以</span></span><br><span class="line"><span class="keyword">INSERT</span></span><br><span class="line">  <span class="keyword">INTO</span> (Sub_Query)</span><br><span class="line">  <span class="keyword">VALUES</span> ( <span class="keyword">Value</span> [, ...] )</span><br><span class="line">  ;</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：INSERT-ALL-语句"><a href="#知识点：INSERT-ALL-语句" class="headerlink" title="知识点：INSERT ALL 语句"></a>知识点：INSERT ALL 语句</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - Oracle 语法，多表插入 multi_table_insert</span><br><span class="line">  - 可以在一条语句中向一个表插入多行</span><br><span class="line">  - 可以在一条语句中向多个表插入多行</span><br><span class="line"></span><br><span class="line">* 形式</span><br><span class="line">  - 一个 INSERT ALL 语句中，末尾要有一个 EndSub_Query，插入的所有数据行都是 EndSub_Query 的子集</span><br><span class="line">  - 可以有多个 INTO 从句，每个 INTO 从句，都代表一个对某个表的一次插入的行为</span><br><span class="line">  - 相当于，每一个 INTO 从句，都代表了一个单独的 INSERT INTO TableName SELECT Column_List FROM EndSub_Query ;</span><br></pre></td></tr></table></figure></li>
<li><strong>基本 INSERT ALL 语法</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 每一个 INTO 从句，都是插入的 EndSub_Query 全部数据行</span><br><span class="line">  - INTO 从句中可以通过指定 Column_List 来在纵向上对 EndSub_Query 的结果进行选取</span><br><span class="line"></span><br><span class="line">* 关于 Value</span><br><span class="line">  - 相比基本 INSERT 语句，多个一个可选项，就是 EndSub_QueryColumnName</span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> [<span class="keyword">ALL</span>]</span><br><span class="line">  <span class="keyword">INTO</span> TableName  [( ColumnName [, ...] )] [<span class="keyword">VALUES</span> (<span class="keyword">Value</span> [, ...] )]</span><br><span class="line">  [<span class="keyword">INTO</span> TableName [( ColumnName [, ...] )] [<span class="keyword">VALUES</span> (<span class="keyword">Value</span> [, ...] )]</span><br><span class="line">  [...]]</span><br><span class="line">  EndSub_Query</span><br><span class="line">  ;</span><br></pre></td></tr></table></figure></li>
<li><strong>条件多表插入 INSERT ALL WHEN THEN 语法</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 通过 WHEN THEN 从句，设置 Condition，对 EndSub_Query 的返回行进行筛选</span><br><span class="line">  - EndSub_Query 中的每一个返回行，对所有 WHEN THEN 从句的 Condition 进行匹配，插入到所有匹配的 WHEN THEN 从句对应的所有的 INTO 从句</span><br><span class="line">  - 一个 INSERT ALL 语句中可以包含多个 WHEN THEN 从句</span><br><span class="line">  - 一个 WHEN THEN 从句中可以包含多个 INTO 从句</span><br><span class="line">  - 最末尾可以追加一个 ELSE 从句，用来指定不满足任何 WHEN THEN 条件的行的插入行为</span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> [<span class="keyword">ALL</span>]</span><br><span class="line">  <span class="keyword">WHEN</span> <span class="keyword">Condition</span> <span class="keyword">THEN</span></span><br><span class="line">    <span class="keyword">INTO</span>  TableName [( ColumnName [, ...] )] [<span class="keyword">VALUES</span> ( <span class="keyword">Value</span> [, ...] )]</span><br><span class="line">    [<span class="keyword">INTO</span> TableName [( ColumnName [, ...] )] [<span class="keyword">VALUES</span> ( <span class="keyword">Value</span> [, ...] )]</span><br><span class="line">    [...] ]</span><br><span class="line">  [<span class="keyword">WHEN</span> <span class="keyword">Condition</span> <span class="keyword">THEN</span></span><br><span class="line">    <span class="keyword">INTO</span>  TableName [( ColumnName [, ...] )] [<span class="keyword">VALUES</span> ( <span class="keyword">Value</span> [, ...] )]</span><br><span class="line">    [<span class="keyword">INTO</span> TableName [( ColumnName [, ...] )] [<span class="keyword">VALUES</span> ( <span class="keyword">Value</span> [, ...] )]</span><br><span class="line">    [...]]</span><br><span class="line">    [...]]</span><br><span class="line">  [<span class="keyword">ELSE</span></span><br><span class="line">    <span class="keyword">INTO</span>  TableName [( ColumnName [, ...] )] [<span class="keyword">VALUES</span> ( <span class="keyword">Value</span> [, ...] )]</span><br><span class="line">    [<span class="keyword">INTO</span> TableName [( ColumnName [, ...] )] [<span class="keyword">VALUES</span> ( <span class="keyword">Value</span> [, ...] )]</span><br><span class="line">    [...] ] ]</span><br><span class="line">  EndSub_Query</span><br><span class="line">  ;</span><br></pre></td></tr></table></figure></li>
<li><strong>条件多表插入 INSERT FIRST WHEN THEN 语法</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 与 INSERT ALL 形式的唯一区别</span><br><span class="line">    - EndSub_Query 返回的每一个结果行，只会对应一个 WHEN THEN 从句</span><br><span class="line">    - 只会被插入到第一个满足的 WHEN THEN 从句对应的所有的 INTO 从句</span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">FIRST</span></span><br><span class="line">  <span class="keyword">WHEN</span> <span class="keyword">Condition</span> <span class="keyword">THEN</span></span><br><span class="line">    <span class="keyword">INTO</span>  TableName [( ColumnName [, ...] )] [<span class="keyword">VALUES</span> ( <span class="keyword">Value</span> [, ...] )]</span><br><span class="line">    [<span class="keyword">INTO</span> TableName [( ColumnName [, ...] )] [<span class="keyword">VALUES</span> ( <span class="keyword">Value</span> [, ...] )]</span><br><span class="line">    [ ...] ]</span><br><span class="line">  [<span class="keyword">WHEN</span> <span class="keyword">Condition</span> <span class="keyword">THEN</span></span><br><span class="line">    <span class="keyword">INTO</span>  TableName [( ColumnName [, ...] )] [<span class="keyword">VALUES</span> ( <span class="keyword">Value</span> [, ...] )]</span><br><span class="line">    [<span class="keyword">INTO</span> TableName [( ColumnName [, ...] )] [<span class="keyword">VALUES</span> ( <span class="keyword">Value</span> [, ...] )]</span><br><span class="line">    [...] ]</span><br><span class="line">    [...] ]</span><br><span class="line">  [<span class="keyword">ELSE</span></span><br><span class="line">    <span class="keyword">INTO</span>  TableName [( ColumnName [, ...] )] [<span class="keyword">VALUES</span> ( <span class="keyword">Value</span> [, ...] )]</span><br><span class="line">    [<span class="keyword">INTO</span> TableName [( ColumnName [, ...] )] [<span class="keyword">VALUES</span> ( <span class="keyword">Value</span> [, ...] )]</span><br><span class="line">    [...] ]</span><br><span class="line">  EndSub_Query</span><br><span class="line">  ;</span><br></pre></td></tr></table></figure></li>
<li><strong>范例</strong><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 旋转 INSERT</span></span><br><span class="line"><span class="comment">-- 将 sales 表中 mon_sal 到 fri_sal 五个列的数据，转换为 sal_info 表中 week_day 一个列的数据</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 建表</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> sales ( emp_id NUMBER, week_id NUMBER, mon_sal NUMBER, tue_sal NUMBER, wed_sal NUMBER, thu_sal NUMBER, fri_sal NUMBER ) ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> sal_info ( emp_id NUMBER, week_id NUMBER, week_day <span class="type">VARCHAR</span>( <span class="number">25</span> ), sales NUMBER ) ;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 旋转 INSERT</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">ALL</span></span><br><span class="line">  <span class="keyword">INTO</span> sal_info ( emp_id, week_id, <span class="string">&#x27;MONDAY&#x27;</span>, mon_sal )</span><br><span class="line">  <span class="keyword">INTO</span> sal_info ( emp_id, week_id, <span class="string">&#x27;TUESDAY&#x27;</span>, tue_sal )</span><br><span class="line">  <span class="keyword">INTO</span> sal_info ( emp_id, week_id, <span class="string">&#x27;WEDNESDAY&#x27;</span>, wed_sal )</span><br><span class="line">  <span class="keyword">INTO</span> sal_info ( emp_id, week_id, <span class="string">&#x27;THUSDAY&#x27;</span>, thu_sal )</span><br><span class="line">  <span class="keyword">INTO</span> sal_info ( emp_id, week_id, <span class="string">&#x27;FRIDAY&#x27;</span>, fri_sal )</span><br><span class="line">  <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> sales</span><br><span class="line">  ;</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：UPDATE-语句"><a href="#知识点：UPDATE-语句" class="headerlink" title="知识点：UPDATE 语句"></a>知识点：UPDATE 语句</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - UPDATE 语句，用于对表中的数据行更新数据</span><br><span class="line"></span><br><span class="line">* 基本形式</span><br><span class="line">  - 使用 WHERE 子句用于限定待更新的行</span><br><span class="line">  - 使用 SET 子句确定更新的方式</span><br><span class="line">  - 一条 UPDATE 语句中只能包含一个 WHERE 子句，根据 WHERE 子句的筛选结果更新一行或多行</span><br><span class="line">  - 一条 UPDATE 语句中只能包含一个 SET 子句，根据 SET 子句的设置更新一列或多列</span><br><span class="line"></span><br><span class="line">* UPDATE 使用子查询</span><br><span class="line">  - 可以使用单行子查询来指定 Value</span><br><span class="line">  - 可以使用多列单行子查询来为多个列指定 Value</span><br><span class="line">  - 可以使用关联子查询来指定 value</span><br><span class="line"></span><br><span class="line">* 关于 Value</span><br><span class="line">  - 可以是字面量</span><br><span class="line">  - 可以是 function</span><br><span class="line">  - 可以是 expression</span><br><span class="line">  - 可以是关键字 DEFAULT</span><br><span class="line">  - 可以是关键字 NULL</span><br></pre></td></tr></table></figure></li>
<li><strong>基本语法</strong><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">UPDATE TableName [ Alias ]</span><br><span class="line">  <span class="keyword">SET</span> ColumnName <span class="operator">=</span> <span class="keyword">Value</span> [ [, ColumnName <span class="operator">=</span> <span class="keyword">Value</span> ] ... ]</span><br><span class="line">  [ <span class="keyword">WHERE</span> <span class="keyword">Condition</span> ]</span><br><span class="line">  ;</span><br></pre></td></tr></table></figure></li>
<li><strong>UPDATE 使用子查询语法</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">-- UPDATE 使用单行子查询</span><br><span class="line">UPDATE TableName</span><br><span class="line">  SET ColumnName = SingleRowSub_Query [ [, ColumnName = Value ] ... ]</span><br><span class="line">  SET ColumnName = ( SingleRowSub_Query )</span><br><span class="line">  [ WHERE Condition ]</span><br><span class="line">  ;</span><br><span class="line"></span><br><span class="line">-- UPDATE 使用多列单行子查询指定多个列的 Value</span><br><span class="line">UPDATE TableName</span><br><span class="line">  SET ( Column_List ) = ( SELECT Column_List FROM ... )</span><br><span class="line">  [ WHERE Condition ]</span><br><span class="line">  ;</span><br><span class="line"></span><br><span class="line">-- UPDATE 使用关联子查询 Correlated Sub_Query 指定 Value</span><br><span class="line">UPDATE MainTable [ Alias ]</span><br><span class="line">  SET Column_List = ( SELECT Column_List FROM SubTable WHERE SubTable.ColumnName=MainTable.ColumnName ... )</span><br><span class="line">  ;</span><br></pre></td></tr></table></figure></li>
<li><strong>范例</strong><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- UPDATE 使用关联子查询指定 Value</span></span><br><span class="line"><span class="comment">-- 在 employee 表中为员工记录其 manager 的 salary</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> employee_new <span class="keyword">AS</span> <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> employees ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> employees_new <span class="keyword">ADD</span> ( manager_salary number <span class="keyword">DEFAULT</span> <span class="keyword">null</span> ) ;</span><br><span class="line"></span><br><span class="line">UPDATE employees_new e</span><br><span class="line">  <span class="keyword">SET</span> manager_salary <span class="operator">=</span> ( <span class="keyword">SELECT</span> salary <span class="keyword">FROM</span> employees <span class="keyword">WHERE</span> e.manager_id<span class="operator">=</span>employees.employee_id )</span><br><span class="line">  ;</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：DELETE-语句"><a href="#知识点：DELETE-语句" class="headerlink" title="知识点：DELETE 语句"></a>知识点：DELETE 语句</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - DELETE 语句，用来删除表中已存在的行</span><br><span class="line">  - 使用 WHERE 从句，来确定要被删除的行，若省略 WHERE 从句则表示删除所有的行</span><br></pre></td></tr></table></figure></li>
<li><strong>语法</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">DELETE [FROM] TableName</span><br><span class="line">  [ WHERE Condition ]</span><br><span class="line">  ;</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：MERGE-语句"><a href="#知识点：MERGE-语句" class="headerlink" title="知识点：MERGE 语句"></a>知识点：MERGE 语句</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - MERGE 融合，是 INSERT 和 UPDATE 的结合形式的语法糖，实际上在底层也会被转换 INSERT 和 UPDATE</span><br><span class="line">  - MERGE 的优点，可以节申请资源时的消耗</span><br><span class="line"></span><br><span class="line">* 形式</span><br><span class="line">  - 指定一个源表 SourceTable</span><br><span class="line">  - 指定一个目标表 TargetTable</span><br><span class="line">  - 将 SourceTable 中的内容融合到 TargetTable 中，批量进行 INSERT 和 UPDATE</span><br><span class="line">  - 指定一个 ON Condition</span><br><span class="line">    - ON Condition 是一个由 TargetTable 中的列和 SourceTable 中的中的列共同组成的条件</span><br><span class="line">    - 对于 TargetTable 中 ON Condition 为 TRUE 的行，进行 UPDATE</span><br><span class="line">    - 对于 SourceTable 中 ON Condition 为 FALSE 的行，INSERT 到 TargetTable</span><br></pre></td></tr></table></figure></li>
<li><strong>语法</strong><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">MERGE</span></span><br><span class="line">  <span class="keyword">INTO</span> TargetTable</span><br><span class="line">  <span class="keyword">USING</span> SourceTable</span><br><span class="line"><span class="keyword">ON</span>( <span class="keyword">Condition</span> )</span><br><span class="line"><span class="keyword">WHEN</span> MATCHED <span class="keyword">THEN</span></span><br><span class="line">  UPDATE <span class="keyword">SET</span> ColumnName<span class="operator">=</span><span class="keyword">Value</span> [, ...]</span><br><span class="line">  [ <span class="keyword">WHERE</span> <span class="keyword">Condition</span> ]</span><br><span class="line">  [ <span class="keyword">DELETE</span> WhereClause ]</span><br><span class="line"><span class="keyword">WHEN</span> <span class="keyword">NOT</span> MATCHED <span class="keyword">THEN</span></span><br><span class="line">  <span class="keyword">INSERT</span> [( ColumnName[, ...] )] <span class="keyword">VALUES</span> ( <span class="keyword">Value</span>[, ...] )</span><br><span class="line">  [ <span class="keyword">WHERE</span> <span class="keyword">Condition</span> ]</span><br><span class="line">  ;</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">* WHEN MATEHED 和 WHEN NOT METCH</span><br><span class="line">  - 顺序不能乱</span><br><span class="line">  - 可以只出现其中的某一个</span><br><span class="line"></span><br><span class="line">* WHERE Condition</span><br><span class="line">  - 表示仅在符合条件时，才执行 UPDATE/INSERT 操作</span><br><span class="line"></span><br><span class="line">* DELETE WhereClause</span><br><span class="line">  - 在 UPDATE 时，同时删除 TargetTable 中的某些行</span><br></pre></td></tr></table></figure></li>
<li><strong>范例</strong><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 创建一个新的 emp 表，使用原有的 employees 的 first_name 和 last_name 来整合记录员工的 name</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> emp</span><br><span class="line">  <span class="keyword">AS</span> <span class="keyword">SELECT</span> employee_id, first_name name, salary</span><br><span class="line">     <span class="keyword">FROM</span> employees ;</span><br><span class="line"><span class="keyword">MERGE</span></span><br><span class="line">  <span class="keyword">INTO</span> emp</span><br><span class="line">  <span class="keyword">USING</span> employees</span><br><span class="line"><span class="keyword">ON</span> ( emp.employee_id <span class="operator">=</span> employees.employee_id )</span><br><span class="line"><span class="keyword">WHEN</span> MATCHED <span class="keyword">THEN</span></span><br><span class="line">  UPDATE <span class="keyword">SET</span> emp.name <span class="operator">=</span> employees.first_name <span class="operator">||</span> <span class="string">&#x27; &#x27;</span> <span class="operator">||</span> employees.last_name</span><br><span class="line">;</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h2 id="1-3-事务"><a href="#1-3-事务" class="headerlink" title="1.3 事务"></a>1.3 事务</h2><hr>
<h1 id="Chapter02-SELECT"><a href="#Chapter02-SELECT" class="headerlink" title="Chapter02 SELECT"></a>Chapter02 SELECT</h1><hr>
<h2 id="2-1-SELECT-基础"><a href="#2-1-SELECT-基础" class="headerlink" title="2.1 SELECT 基础"></a>2.1 SELECT 基础</h2><hr>
<h3 id="知识点：SELECT-语句基础"><a href="#知识点：SELECT-语句基础" class="headerlink" title="知识点：SELECT 语句基础"></a>知识点：SELECT 语句基础</h3><ol>
<li><strong>SELECT 语句的功能</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - SELECT 语句，SQL 中使用最多的语句，作用是查询 Query</span><br><span class="line"></span><br><span class="line">* SELECT 语言的功能 </span><br><span class="line">  - 选取 selection，横向选择，选择表中的行，通过使用 WHERE 来对行进行过滤</span><br><span class="line">  - 投影 projection，纵向选择，选择表中的列，通过使用 Select_List 来对列进行过滤</span><br><span class="line">  - 连接 join，多表关联，通过指定表与表之间的联系，将不同表中的数据整合在一起</span><br></pre></td></tr></table></figure></li>
<li><strong>SELECT 基本从句</strong><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> Select_List</span><br><span class="line">  <span class="keyword">FROM</span> clause</span><br><span class="line">  <span class="keyword">JOIN</span> clause</span><br><span class="line">  <span class="keyword">WHERE</span> clause</span><br><span class="line">  <span class="keyword">GROUP</span> <span class="keyword">BY</span> clause</span><br><span class="line">  <span class="keyword">HAVING</span> clause</span><br><span class="line">  <span class="keyword">ORDER</span> <span class="keyword">BY</span> clause</span><br><span class="line">  <span class="keyword">OFFSET</span> clause <span class="keyword">FETCH</span> clause <span class="operator">|</span> LIMIT clause</span><br><span class="line">  ;</span><br></pre></td></tr></table></figure></li>
<li><strong>虚拟表</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">* 虚拟表介绍</span><br><span class="line">  - SELECT 语句的每个从句都会产生一个虚拟表</span><br><span class="line">  - 虚拟表被用作下一个从句的输入</span><br><span class="line">  - 只有最后一步生成的虚拟表才会返回给调用者，中间过程的虚拟表都对调用者不可见</span><br><span class="line">  - 虚拟表允许存在错误，如两列的列名相同，输入时会对虚拟表进行检查，输出时不进行检查</span><br><span class="line"></span><br><span class="line">* SELECT 各个从句的执行顺序</span><br><span class="line">  - FROM</span><br><span class="line">  - JOIN</span><br><span class="line">  - WHERE</span><br><span class="line">  - GROUP BY</span><br><span class="line">  - HAVING</span><br><span class="line">  - SELECT 聚合函数</span><br><span class="line">  - SELECT</span><br><span class="line">  - DISTINCT</span><br><span class="line">  - UNION</span><br><span class="line">  - ORDER BY</span><br><span class="line">  - OFFSET</span><br><span class="line">  - FETCH</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：列别名"><a href="#知识点：列别名" class="headerlink" title="知识点：列别名"></a>知识点：列别名</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">* 列别名 column alias</span><br><span class="line">  - 在 SELECT 语句的 Select_List 中，为列或表达式设置别名</span><br><span class="line">  - 列别名的命名方式与对象的命名方式相同</span><br><span class="line">  - 列别名除了在 ORDER BY 子句中可用，其他子句中几乎都不可用</span><br><span class="line"></span><br><span class="line">* 带双引号的列别名</span><br><span class="line">  - 在设置列别名时，将列别名放在双引号中</span><br><span class="line">  - 在引用列别名时，也要带有双引号</span><br><span class="line">  - 双引号列别名可以区分大小写，可以使用空白字符，可以使用特殊字符，可以使用关键字</span><br><span class="line"></span><br><span class="line">* 设置列别名的方式</span><br><span class="line">  - 空格</span><br><span class="line">  - AS</span><br></pre></td></tr></table></figure></li>
<li><strong>范例</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">SELECT</span><br><span class="line">  department_name &quot;Dept&quot;,</span><br><span class="line">  avg(salary) &quot;Avg_Sal&quot;</span><br><span class="line">FROM hr.employees NATURAL JOIN hr.departments</span><br><span class="line">GROUP BY department_name</span><br><span class="line">;</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：表别名"><a href="#知识点：表别名" class="headerlink" title="知识点：表别名"></a>知识点：表别名</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">* 表别名 table alias</span><br><span class="line">  - 在 FROM 子句中为表设置别名</span><br><span class="line">  - 由于 FROM 最先执行，故表别名可以用在 SELECT 语句中的任意从句</span><br><span class="line"></span><br><span class="line">* 用处</span><br><span class="line">  - 用在 Select_List 中，指定参与计算的列</span><br><span class="line">  - 用在 ON 连接中，指定连接条件使用的列</span><br><span class="line">  - 用在子查询中，尤其是关联子查询，分别指定外表和内表的列</span><br><span class="line"></span><br><span class="line">* 注意</span><br><span class="line">  - 在连接中，只能对基础表定义表别名，不能对连接后的虚拟表定义表别名</span><br><span class="line"></span><br><span class="line">* 设置定义表别名的方式</span><br><span class="line">  - 空格</span><br></pre></td></tr></table></figure></li>
<li><strong>范例</strong><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">  department_name &quot;Dept&quot;,</span><br><span class="line">  <span class="built_in">avg</span>(salary) &quot;Avg_Sal&quot;</span><br><span class="line"><span class="keyword">FROM</span> hr.employees e <span class="keyword">NATURAL</span> <span class="keyword">JOIN</span> hr.departments d</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> department_name</span><br><span class="line">;</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：DISTINCT-关键字"><a href="#知识点：DISTINCT-关键字" class="headerlink" title="知识点：DISTINCT 关键字"></a>知识点：DISTINCT 关键字</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 也写作 UNIQUE</span><br><span class="line">  - 用来选取唯一值</span><br><span class="line">  - 作用与分组 GROUP BY 相同</span><br><span class="line">  - 可以放在其他函数作为参数</span><br><span class="line"></span><br><span class="line">* 注意</span><br><span class="line">  - 一个 SELECT 语句中只能包含一个 DISTINCT</span><br><span class="line">  - DISTINCT Identifier_1, Identifier_2[, ...]，相当于 GROUP BY Identifier_1, Identifier_2[, ...]</span><br><span class="line">  - DISTINCT 可以接收 NULL，作用是将所有 NULL 合并为一个 NULL</span><br></pre></td></tr></table></figure></li>
<li><strong>格式</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">* 格式</span><br><span class="line">  DISTINCT  Identifier [, ...]</span><br><span class="line">  DISTINCT (Identifier [, ...])</span><br><span class="line"></span><br><span class="line">* Identifier</span><br><span class="line">  - ColumnName</span><br><span class="line">  - Function</span><br><span class="line">  - Expression</span><br></pre></td></tr></table></figure></li>
<li><strong>范例</strong><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> owner <span class="keyword">FROM</span> dba_tables ;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 放在其他函数中作为参数</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">COUNT</span>(<span class="keyword">DISTINCT</span> owner) <span class="keyword">FROM</span> dba_tables ;</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：FROM-从句"><a href="#知识点：FROM-从句" class="headerlink" title="知识点：FROM 从句"></a>知识点：FROM 从句</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">* 作用</span><br><span class="line">  - 指定要查询的表</span><br><span class="line">  - 定义表别名</span><br><span class="line">  - 指定表的连接逻辑</span><br></pre></td></tr></table></figure></li>
<li><strong>语法</strong><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">FROM</span> [schema.]TableName[<span class="variable">@db</span>_link] [TableAlias]</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：WHERE-从句"><a href="#知识点：WHERE-从句" class="headerlink" title="知识点：WHERE 从句"></a>知识点：WHERE 从句</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">* 作用</span><br><span class="line">  - 用于对表进行基于行的筛选</span><br><span class="line">  - 对于条件为 true 的行，保留</span><br><span class="line">  - 对于条件问 false 的行，去除</span><br></pre></td></tr></table></figure></li>
<li><strong>语法</strong><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">WHERE</span> <span class="keyword">Condition</span></span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：GROUP-BY-从句"><a href="#知识点：GROUP-BY-从句" class="headerlink" title="知识点：GROUP BY 从句"></a>知识点：GROUP BY 从句</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">* 作用</span><br><span class="line">  - 用于对查询结果进行分组和聚合</span><br><span class="line">  - GROUP BY 从句中不能使用聚合函数</span><br><span class="line">  - 当进行了分组时，Select_List 中的项，要么在 Select_List 中以聚合函数的参数存在，要么写在 GROUP BY list 中作为分组依据</span><br></pre></td></tr></table></figure></li>
<li><strong>语法</strong><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> &#123;ColumnName<span class="operator">|</span><span class="keyword">Function</span><span class="operator">|</span>Expression&#125;[, ...]</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">* 关于括号</span><br><span class="line">  - 括号和先后顺序并不影响分组结果，只影响排序</span><br><span class="line">  - 以下三者结果相同</span><br><span class="line">    GROUP BY column_a, column_b, column_c</span><br><span class="line">    GROUP BY ( column_a, column_b ), column_c</span><br><span class="line">    GROUP BY column_a, ( column_b, column_c )</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：HAVING-从句"><a href="#知识点：HAVING-从句" class="headerlink" title="知识点：HAVING 从句"></a>知识点：HAVING 从句</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">* 作用</span><br><span class="line">  - 用于对 GROUP BY 从句的结果，进行筛选</span><br><span class="line">  - HAVING 从句中可以使用聚合函数</span><br><span class="line"></span><br><span class="line">* HAVING 从句与 WHERE 从句的区别</span><br><span class="line">  - WHERE 从句是对 GROUP BY 之前的虚拟表进行筛选，Condition 中不可以使用聚合函数</span><br><span class="line">  - HAVING 从句是对 GROUP BY 之后的虚拟表进行筛选，Condition 中可以使用聚合函数</span><br></pre></td></tr></table></figure></li>
<li><strong>语法</strong><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">HAVING</span> <span class="keyword">Condition</span></span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：ORDER-BY-从句"><a href="#知识点：ORDER-BY-从句" class="headerlink" title="知识点：ORDER BY 从句"></a>知识点：ORDER BY 从句</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">* 作用</span><br><span class="line">  - 用来对查询结果进行排序</span><br></pre></td></tr></table></figure></li>
<li><strong>语法</strong><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> &#123;OderByItem [<span class="keyword">ASC</span><span class="operator">|</span><span class="keyword">DESC</span>] [NULLS <span class="keyword">FIRST</span><span class="operator">|</span>NULLS <span class="keyword">LAST</span>]&#125;[, ...]</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">* ASC           &lt;== 升序</span><br><span class="line">* DESC          &lt;== 降序</span><br><span class="line">* NULLS FIRST   &lt;== 空值放在最前</span><br><span class="line">* NULLS LAST    &lt;== 空值放在最后</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">* OderByItem</span><br><span class="line">  - 指定作为排序依据的列、函数运算、表达式</span><br><span class="line">  - 可以使用没有出现在 Select_List 中的项</span><br><span class="line">  - 可以是以下形式</span><br><span class="line">    - ColumnName</span><br><span class="line">    - ColumnAlias</span><br><span class="line">    - Expression</span><br><span class="line">    - Select_ListPosition</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：OFFSET-从句"><a href="#知识点：OFFSET-从句" class="headerlink" title="知识点：OFFSET 从句"></a>知识点：OFFSET 从句</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">* 作用</span><br><span class="line">  - Oracle sql 语法</span><br><span class="line">  - 对于 ORDER BY 之后的虚拟表，跳过前面 N 行</span><br><span class="line">  - 可以不和 FETCH 一起使用</span><br></pre></td></tr></table></figure></li>
<li><strong>语法</strong><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">OFFSET</span> n &#123;<span class="type">ROW</span><span class="operator">|</span><span class="keyword">ROWS</span>&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">* ROW、ROWS      &lt;== 语法提示词，无功能意义，但不能缺少</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：FETCH-从句"><a href="#知识点：FETCH-从句" class="headerlink" title="知识点：FETCH 从句"></a>知识点：FETCH 从句</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">* 作用</span><br><span class="line">  - Oracle sql 语法，进行 top-N 查询</span><br><span class="line">  - 对于 OFFSET/ORDER BY 之后的结果，只返回前 RowCount 行</span><br><span class="line">  - 可以单独使用，不加 OFFSET 从句</span><br></pre></td></tr></table></figure></li>
<li><strong>语法</strong><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[OffsetClause] <span class="keyword">FETCH</span> &#123;<span class="keyword">FIRST</span><span class="operator">|</span>NEXT&#125; &#123;RowCount<span class="operator">|</span><span class="keyword">Percent</span> <span class="keyword">PERCENT</span>&#125; &#123;<span class="type">ROW</span><span class="operator">|</span><span class="keyword">ROWS</span>&#125; &#123;<span class="keyword">ONLY</span><span class="operator">|</span><span class="keyword">WITH</span> TIES&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">* FIRST、NEXT    &lt;== 语法提示词，无功能意义，但不能缺少</span><br><span class="line">* ROW、ROWS      &lt;== 语法提示词，无功能意义，但不能缺少</span><br><span class="line">* ONLY           &lt;== 指定了多少行，就返回多少行</span><br><span class="line">* WITH TIES      &lt;== 必须配合 ORDER BY 子句使用，对排序的最后一个值将相同的行都取出，即使超出了 &#123;RowCount|Percent PERCENT&#125; 的限制</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：LIMIT-从句"><a href="#知识点：LIMIT-从句" class="headerlink" title="知识点：LIMIT 从句"></a>知识点：LIMIT 从句</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">* 作用</span><br><span class="line">  - Mysql sql 语法，进行 top-N 查询语法</span><br><span class="line">  - 对于 ORDER BY 之后的结果，跳过前 OffsetCount 行，再只返回前 RowCount 行</span><br><span class="line">  - 同时兼具 Oracle 的 OFFSET 和 FETCH 两个从句的功能</span><br></pre></td></tr></table></figure></li>
<li><strong>语法</strong><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">LIMIT [OffsetCount,] RowCount</span><br><span class="line">LIMIT RowCount <span class="keyword">OFFSET</span> OffsetCount</span><br></pre></td></tr></table></figure></li>
<li><strong>范例</strong><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 选取平均工资最高的前三个部门</span></span><br><span class="line"><span class="keyword">SELECT</span> department_name, <span class="built_in">avg</span>(salary)</span><br><span class="line">  <span class="keyword">FROM</span> employees</span><br><span class="line">  <span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="number">2</span></span><br><span class="line">  LIMIT <span class="number">3</span></span><br><span class="line">  ;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 选取平均工资第三高到第五高的部门</span></span><br><span class="line"><span class="keyword">SELECT</span> department_name, <span class="built_in">avg</span>(salary)</span><br><span class="line">  <span class="keyword">FROM</span> employees</span><br><span class="line">  <span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="number">2</span></span><br><span class="line">  LIMIT <span class="number">2</span>, <span class="number">3</span></span><br><span class="line">  ;</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h2 id="2-2-连接查询"><a href="#2-2-连接查询" class="headerlink" title="2.2 连接查询"></a>2.2 连接查询</h2><hr>
<h3 id="知识点：连接查询介绍"><a href="#知识点：连接查询介绍" class="headerlink" title="知识点：连接查询介绍"></a>知识点：连接查询介绍</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 连接查询 join，将数据分散储存到不同的表中，在查询时才进行连接</span><br><span class="line">  - 意义，避免产生冗余数据</span><br><span class="line"></span><br><span class="line">* 连接查询的执行过程</span><br><span class="line">  - 首先将两张表组成笛卡尔乘积</span><br><span class="line">  - 根据连接条件，从笛卡尔乘积中去除不符合条件的行</span><br><span class="line">  - 根据选择的列，从虚拟表中去除不需要的列</span><br><span class="line">  - 返回结果</span><br><span class="line"></span><br><span class="line">* 连接条件列</span><br><span class="line">  - 指定连接条件时，两个列可以具有不同的数据类型，但必须可以相互进行隐式转换</span><br><span class="line"></span><br><span class="line">* 连接查询的性能特点</span><br><span class="line">  - 由于连接查询需要组成笛卡尔乘积，所以非常占用内存，属于以空间换时间思想</span><br><span class="line">  - 对多个表进行连接查询，内存的占用量按指数级别上升</span><br><span class="line">  - 阿里技术要求不允许编写超过三个表的连接查询</span><br><span class="line"></span><br><span class="line">* SQL 连接查询的语法标准</span><br><span class="line">  - ORACLE JOIN，WHERE 方式的连接</span><br><span class="line">  - SQL1999 compliant ANSI JOIN，JOIN 方式的连接，与 SQL:1999 标准兼容</span><br><span class="line">  - 两种连接语法的性能相同</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：连接查询种类"><a href="#知识点：连接查询种类" class="headerlink" title="知识点：连接查询种类"></a>知识点：连接查询种类</h3><ol>
<li><strong>等值连接和非等值连接</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">* 等值连接 equejoin</span><br><span class="line">  - 连接条件为 &quot;等于&quot; 的连接</span><br><span class="line"></span><br><span class="line">* 非等值连接 nonequejoin</span><br><span class="line">  - 连接条件为 &quot;不等于&quot; 的连接</span><br><span class="line">  - 非等值连接虽然连接条件不是等于，但仍要尽量保证对对于左表的每一行右表中只有一个匹配行，否则容易产生大量冗余数据，一般没有实际意义</span><br></pre></td></tr></table></figure></li>
<li><strong>内连接和外连接</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">* 内连接 inner join</span><br><span class="line">  - 在对笛卡尔乘积去除行时，仅会保留符合条件的行，不符合条件的行会被筛选掉</span><br><span class="line"></span><br><span class="line">* 外连接 outer join</span><br><span class="line">  - 在内连接的基础上，会拼接上一些额外的行</span><br><span class="line"></span><br><span class="line">* 左外连接 left outer join</span><br><span class="line">  - 在内连接的基础上，会拼接上左表中未被选中的行，对应的右表部分置 NULL</span><br><span class="line"></span><br><span class="line">* 右外连接 right outer join</span><br><span class="line">  - 在内连接的基础上，会拼接上右表中未被选中的行，对应的左表部分置 NULL</span><br><span class="line"></span><br><span class="line">* 全外连接 full outer join</span><br><span class="line">  - 在内连接的基础上，会拼接上左表和右表中未被选中的行，对应的另一部分置 NULL</span><br></pre></td></tr></table></figure></li>
<li><strong>自连接</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">* 自连接 self join</span><br><span class="line">  - 表与自己连接，即左表和右表是同一张表</span><br><span class="line">  - 自连接必须使用表别名</span><br></pre></td></tr></table></figure></li>
<li><strong>自然连接</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">* 自然连接 natural join</span><br><span class="line">  - 一种特殊的等值连接，自动寻找两张表中的公共列，自动进行等值连接</span><br><span class="line"></span><br><span class="line">* 自然连接的前提</span><br><span class="line">  - table_A 和 table_B 有公共列</span><br><span class="line">  - 公共列的列名要相同</span><br><span class="line">  - 公共列的数据类型要相同，或者不同但可以进行隐式转换，否则会报错</span><br><span class="line">  - 如果有多个公共列，则所有的公共列都会被用作连接条件，并且必须满足每一对公共列的值都相等</span><br><span class="line">  - 多个公共列时，可能因为某一对公共列的问题而影响结果，或报错</span><br><span class="line"></span><br><span class="line">* 自然连接的结果</span><br><span class="line">  - 会将公共列的重复项去重，并将公共列提到表的第一列</span><br><span class="line">  - 公共列中行的顺序按照左表中公共列的行顺序</span><br><span class="line"></span><br><span class="line">* 对自然连接的结果进行查询时，如果引用公共列，则公共列不能加表别名</span><br></pre></td></tr></table></figure></li>
<li><strong>笛卡尔乘积</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">* 笛卡尔乘积 Cartesian Products</span><br><span class="line">  - 也称为交叉连接 cross join</span><br><span class="line">  - 即，对左表的每一行，将右表的每一行与其进行拼接</span><br><span class="line">  - 结果表的行数为 左表行数*右表行数</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：USING-从句"><a href="#知识点：USING-从句" class="headerlink" title="知识点：USING 从句"></a>知识点：USING 从句</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - Oracle 语句，用于在连接查询中指定连接条件</span><br><span class="line">  - USING 从句只能执行等值连接</span><br><span class="line">  - 在 USING 从句中指定公共列，使用公共列自动进行等值连接</span><br><span class="line">  - 最终查询结果中会删除右表的公共列，将左表的公共列作为表的第一列</span><br></pre></td></tr></table></figure></li>
<li><strong>语法</strong><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">USING</span> ( column_name [, ...] )</span><br></pre></td></tr></table></figure></li>
<li><strong>范例</strong><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> hr.employees <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> hr.departments <span class="keyword">USING</span> (department_id)</span><br><span class="line">;</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：ON-从句"><a href="#知识点：ON-从句" class="headerlink" title="知识点：ON 从句"></a>知识点：ON 从句</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - Oracle 语句，用于在连接查询中指定连接条件</span><br><span class="line">  - ON 从句是功能最全面的连接方式，能完成所有方式的连接</span><br><span class="line">  - ON 从句会保留公共列，重复的公共列会重新起个名</span><br><span class="line">  - ON 方式最好使用表别名</span><br><span class="line">  - 处等值连接以外的其他所有方式的连接，只能使用 ON 从句</span><br></pre></td></tr></table></figure></li>
<li><strong>语法</strong><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ON</span> ( join_condition [&#123;<span class="keyword">AND</span><span class="operator">|</span><span class="keyword">OR</span>&#125; join_condition][ ...] )</span><br></pre></td></tr></table></figure></li>
<li><strong>范例</strong><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> hr.employees e <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> hr.departments d <span class="keyword">ON</span> ( e.department_id<span class="operator">=</span>d.department_id)</span><br><span class="line">;</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：JOIN-从句"><a href="#知识点：JOIN-从句" class="headerlink" title="知识点：JOIN 从句"></a>知识点：JOIN 从句</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 用来指定连接查询</span><br><span class="line">  - 是 FROM 从句的子句</span><br></pre></td></tr></table></figure></li>
<li><strong>语法</strong><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 自然连接 NATURAL JOIN</span></span><br><span class="line"><span class="keyword">FROM</span> table_a <span class="keyword">NATURAL</span> [<span class="keyword">INNER</span>] <span class="keyword">JOIN</span> table_b</span><br><span class="line"><span class="keyword">FROM</span> table_a <span class="keyword">NATURAL</span> &#123;<span class="keyword">FULL</span><span class="operator">|</span><span class="keyword">LEFT</span><span class="operator">|</span><span class="keyword">RIGHT</span>&#125; [<span class="keyword">OUTER</span>] <span class="keyword">JOIN</span> table_b</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 内连接 INNER JOIN</span></span><br><span class="line"><span class="keyword">FROM</span> table_a [<span class="keyword">INNER</span>] <span class="keyword">JOIN</span> table_b <span class="keyword">USING</span> ( <span class="keyword">column</span> [, ...] )</span><br><span class="line"><span class="keyword">FROM</span> table_a [<span class="keyword">INNER</span>] <span class="keyword">JOIN</span> table_b <span class="keyword">ON</span> ( <span class="keyword">condition</span> )</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 左外连接 LEFT OUTER JOIN</span></span><br><span class="line"><span class="keyword">FROM</span> table_a <span class="keyword">LEFT</span> [<span class="keyword">OUTER</span>] <span class="keyword">JOIN</span> table_b <span class="keyword">USING</span> ( <span class="keyword">column</span> [, ...] )</span><br><span class="line"><span class="keyword">FROM</span> table_a <span class="keyword">LEFT</span> [<span class="keyword">OUTER</span>] <span class="keyword">JOIN</span> table_b <span class="keyword">ON</span> ( <span class="keyword">condition</span> )</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 右外连接 RIGHT OUTER JOIN</span></span><br><span class="line"><span class="keyword">FROM</span> table_a <span class="keyword">RIGHT</span> [<span class="keyword">OUTER</span>] <span class="keyword">JOIN</span> table_b <span class="keyword">USING</span> ( <span class="keyword">column</span> [, ...] )</span><br><span class="line"><span class="keyword">FROM</span> table_a <span class="keyword">RIGHT</span> [<span class="keyword">OUTER</span>] <span class="keyword">JOIN</span> table_b <span class="keyword">ON</span> ( <span class="keyword">condition</span> )</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 全外连接 FULL OUTER JOIN</span></span><br><span class="line"><span class="keyword">FROM</span> table_a <span class="keyword">FULL</span> [<span class="keyword">OUTER</span>] <span class="keyword">JOIN</span> table_b <span class="keyword">USING</span> ( <span class="keyword">column</span> [, ...] )</span><br><span class="line"><span class="keyword">FROM</span> table_a <span class="keyword">FULL</span> [<span class="keyword">OUTER</span>] <span class="keyword">JOIN</span> table_b <span class="keyword">ON</span> ( <span class="keyword">condition</span> )</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 笛卡尔乘积</span></span><br><span class="line"><span class="keyword">FROM</span> table_a , table_b ...</span><br><span class="line"><span class="keyword">FROM</span> table_a <span class="keyword">CROSS</span> <span class="keyword">JOIN</span> table_b ...</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：Oracle-连接旧语法"><a href="#知识点：Oracle-连接旧语法" class="headerlink" title="知识点：Oracle 连接旧语法"></a>知识点：Oracle 连接旧语法</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 旧语法和新语法最好不要混用，有些情况下会报错</span><br></pre></td></tr></table></figure></li>
<li><strong>语法</strong><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 等值连接</span></span><br><span class="line"><span class="keyword">FROM</span> table_A, table_B <span class="keyword">WHERE</span> A_col <span class="operator">=</span> B_col</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 左外连接</span></span><br><span class="line"><span class="keyword">FROM</span> table_A, table_B <span class="keyword">WHERE</span> A_col <span class="operator">=</span> B_col(<span class="operator">+</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 右外连接</span></span><br><span class="line"><span class="keyword">FROM</span> table_A, table_B <span class="keyword">WHERE</span> A_col(<span class="operator">+</span>) <span class="operator">=</span> A_col</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 笛卡尔乘积</span></span><br><span class="line"><span class="keyword">FROM</span> table_A, table_B, ...</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h2 id="2-3-子查询"><a href="#2-3-子查询" class="headerlink" title="2.3 子查询"></a>2.3 子查询</h2><hr>
<h3 id="知识点：子查询介绍"><a href="#知识点：子查询介绍" class="headerlink" title="知识点：子查询介绍"></a>知识点：子查询介绍</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">* 子查询 Sub_Query</span><br><span class="line">  - 子查询，也就是 SELECT 语句嵌套 SELECT 语句的情况</span><br><span class="line">  - 子查询，也称为内查询</span><br><span class="line">  - 父查询，也称为外查询、主查询</span><br><span class="line">  - 先执行子查询，后执行父查询</span><br><span class="line">  - 子查询可以没有返回行</span><br><span class="line"></span><br><span class="line">* 子查询的位置</span><br><span class="line">  - FROM</span><br><span class="line">  - Select_List</span><br><span class="line">  - WHERE condition</span><br><span class="line"></span><br><span class="line">* 子查询的嵌套和解嵌套</span><br><span class="line">  - 多数情况下，优化器会自动对子查询进行解嵌套，将子查询融合到主查询中</span><br><span class="line">  - 少数情况下，子查询不会被解嵌套，此时，对于主查询的每一个返回行，都会进行一次子查询，严重影响性能，包括以下情况</span><br><span class="line">    - 层级查询</span><br><span class="line">    - 关联子查询</span><br><span class="line">    - 子查询中包含 ROWNUM</span><br><span class="line">    - 子查询包含集合运算符</span><br><span class="line">    - 子查询包含聚合函数</span><br></pre></td></tr></table></figure></li>
<li><strong>子查询的分类</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">* 单行子查询 single_row_Sub_Query</span><br><span class="line">  - 返回值为一行一列的子查询</span><br><span class="line">  - 也称为标量子查询，因为 oralce 会将单行子查询当做一个标量进行处理</span><br><span class="line">  - 如果单行子查询没有返回行，则视为返回 NULL 值</span><br><span class="line"></span><br><span class="line">* 内联视图 inline_view</span><br><span class="line">  - 也叫嵌入式视图</span><br><span class="line">  - 返回值为一个表或列向量</span><br><span class="line">  - 常用方式</span><br><span class="line">    - 在 FROM 中使用子查询返回一个表</span><br><span class="line">    - 在 UPDATE 中使用子查询指定修改的目标数据</span><br></pre></td></tr></table></figure></li>
<li><strong>范例</strong><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 使用内联视图来进行 UPDATE</span></span><br><span class="line">UPDATE (</span><br><span class="line">  <span class="keyword">SELECT</span> a.id aid, a.name aname, b.id bid, b.name bname</span><br><span class="line">  <span class="keyword">FROM</span> test1 a, test2 b</span><br><span class="line">  <span class="keyword">WHERE</span> a.id<span class="operator">=</span>b.id ) t</span><br><span class="line"><span class="keyword">SET</span> aname <span class="operator">=</span> NVL2(aname, bname, aname) ;</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：关联子查询"><a href="#知识点：关联子查询" class="headerlink" title="知识点：关联子查询"></a>知识点：关联子查询</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">* 关联子查询 correlated Sub_Query</span><br><span class="line">  - 在子查询中，如果需要使用父查询的值作为 WHERE 条件，就称为关联子查询</span><br><span class="line">  - 通常需要在父查询中定义表别名，在子查询中使用表别名</span><br><span class="line">  - 关联子查询，对主查询的每一行，都执行一次子查询</span><br><span class="line"></span><br><span class="line">* 关联子查询的效率</span><br><span class="line">  - 关联子查询的效率奇差，会耗费大量时间，在资源足够的情况下建议使用连接进行替代</span><br><span class="line">  - 关联子查询的循环次数多，占用空间少，属于时间换空间</span><br><span class="line">  - 连接查询的循环次数少，占用空间多，属于空间换时间</span><br></pre></td></tr></table></figure></li>
<li><strong>范例</strong><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--- 查询每个部门的工资的前三名</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> hr.employees e</span><br><span class="line"><span class="keyword">WHERE</span> employee_id <span class="keyword">IN</span> (</span><br><span class="line">    <span class="keyword">SELECT</span> employee_id</span><br><span class="line">    <span class="keyword">FROM</span> hr.employees</span><br><span class="line">    <span class="keyword">WHERE</span> department_id <span class="operator">=</span> e.department_id <span class="keyword">AND</span> salary <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span></span><br><span class="line">    <span class="keyword">ORDER</span> <span class="keyword">BY</span> salary <span class="keyword">DESC</span> <span class="keyword">FETCH</span> <span class="keyword">FIRST</span> <span class="number">3</span> <span class="keyword">ROWS</span> <span class="keyword">WITH</span> TIES )</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> department_id, salary <span class="keyword">DESC</span></span><br><span class="line">;</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：WITH-从句"><a href="#知识点：WITH-从句" class="headerlink" title="知识点：WITH 从句"></a>知识点：WITH 从句</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">*  WITH 从句的作用</span><br><span class="line">  - 将子查询的结果储存在临时表空间中</span><br><span class="line">  - 在主查询中直接使用子查询的结果</span><br><span class="line">  - 优点，提高效率，减少磁盘 IO</span><br><span class="line"></span><br><span class="line">* WITH 从句保存的是表，无法作为向量或标量使用</span><br><span class="line">  - 不能直接进行比较，需要在主查询中使用 select 进行取值</span><br><span class="line">  - 不能直接进行 IN 成员运算，需要在主查询中使用 select 进行取值</span><br></pre></td></tr></table></figure></li>
<li><strong>语法</strong><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">WITH</span> name_1 <span class="keyword">AS</span>( Sub_Query ) , name_2 <span class="keyword">AS</span> ( Sub_Query ) [, ...] ,</span><br><span class="line">main_query</span><br><span class="line">;</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h2 id="2-4-集合查询"><a href="#2-4-集合查询" class="headerlink" title="2.4 集合查询"></a>2.4 集合查询</h2><hr>
<h3 id="知识点：集合运算符"><a href="#知识点：集合运算符" class="headerlink" title="知识点：集合运算符"></a>知识点：集合运算符</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">* 集合运算符 Set Operators</span><br><span class="line">  - 实现数学上的集合运算</span><br><span class="line">  - UNION，并集</span><br><span class="line">  - UNION ALL，并集不去重</span><br><span class="line">  - INTERSECT，交集</span><br><span class="line">  - MINUS，差集</span><br><span class="line"></span><br><span class="line">* 集合运算符的去重、保留 NULL、自动排序</span><br><span class="line">  - UNION ALL</span><br><span class="line">    - 不去重</span><br><span class="line">    - 不自动排序</span><br><span class="line">    - 保留 NULL</span><br><span class="line">  - UNION、INTERSECT、MINUS</span><br><span class="line">    - 去重</span><br><span class="line">    - 自动排序</span><br><span class="line">      以第一个查询的第一列为排序依据，升序排列</span><br><span class="line">    - 保留 NULL，对于多个 null ，合并为一个 null</span><br><span class="line"></span><br><span class="line">* 集合运算符和 ORDERY BY</span><br><span class="line">  - 每个查询不允许添加自己 ORDER BY</span><br><span class="line">  - 只能在总查询的最后添加总 ORDER BY</span><br><span class="line"></span><br><span class="line">* 集合运算符的优先级</span><br><span class="line">  - 集合运算符都具有相同的优先级</span><br><span class="line">  - 一个查询中出现多个集合运算符，按照从前向后的顺序，依次执行</span><br><span class="line">  - 括号可以改变集合运算符的优先级</span><br></pre></td></tr></table></figure></li>
<li><strong>范例</strong><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> hr.employees</span><br><span class="line"><span class="keyword">WHERE</span> department_id <span class="operator">&lt;=</span> <span class="number">50</span></span><br><span class="line"><span class="keyword">UNION</span></span><br><span class="line">  <span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line">  <span class="keyword">FROM</span> hr.employees</span><br><span class="line">  <span class="keyword">WHERE</span> department_id <span class="operator">&gt;=</span> <span class="number">100</span></span><br><span class="line">;</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：集合查询"><a href="#知识点：集合查询" class="headerlink" title="知识点：集合查询"></a>知识点：集合查询</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">* 集合查询</span><br><span class="line">  - 也称为组合查询 Compound Query</span><br><span class="line">  - 使用集合运算符的查询称为组合查询</span><br><span class="line"></span><br><span class="line">* 组合查询的列</span><br><span class="line">  - 列以第一个查询为基础，不管其他的查询是否加了括号</span><br><span class="line">  - 所有其他查询的列的数量，要与第一个查询一致</span><br><span class="line"></span><br><span class="line">* 组合查询的列名</span><br><span class="line">  - 列名以第一个查询为基础，不管其他的查询是否加了括号</span><br><span class="line">  - 其他所有查询的列名被忽略</span><br><span class="line"></span><br><span class="line">* 组合查询的数据类型 data type</span><br><span class="line">  - 数据类型以第一个查询的数据类型的数据类型组 data type group 为基础，不管其他的查询是否加了括号</span><br><span class="line">  - 其他所有查询的列的数据类型，要与第一个查询的对应的列，属于同一个 data type group</span><br><span class="line">  - 当数据类型为属于同一个 data type group 的不同数据类型，或宽度不同，则会进行数据类型的转换</span><br><span class="line">      - 如果两个查询都是 char 型，并且宽度相同，则结果为 char 型，具有相同宽度</span><br><span class="line">      - 如果两个查询都是 char 型，具有不同宽度，则结果为 varchar2 型，具有较宽的那个宽度</span><br><span class="line">      - 如果有任意一个为 varchar2 型，则结果为 varchar2 型</span><br><span class="line">  - 组合查询不会对数据类型进行跨 data type group 的数据类型的隐式转换</span><br></pre></td></tr></table></figure></li>
<li><strong>dummy column</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - dummy column，就是一个值为 NULL 的列，在组合查询中用来满足每个查询的数据类型</span><br><span class="line">  - 不需要为 NULL 指定数据类型，NULL 会自动进行类型转换</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h2 id="2-5-分组查询"><a href="#2-5-分组查询" class="headerlink" title="2.5 分组查询"></a>2.5 分组查询</h2><hr>
<h3 id="知识点：GROUPING-SETS-从句"><a href="#知识点：GROUPING-SETS-从句" class="headerlink" title="知识点：GROUPING SETS 从句"></a>知识点：GROUPING SETS 从句</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">* 作用</span><br><span class="line">  - 用来构建分组结果集</span><br><span class="line">  - 将两个 GROUP BY 查询的结果，以 UNION ALL 的方式拼接在一起，可以省略额外写一个子查询的烦劳</span><br><span class="line">  - 相当于 SELECT ... GROUP BY column_1 UNION ALL SELECT ... GROUP BY column_2</span><br><span class="line">  - 相应的缺失的列，会自动添加 NULL</span><br></pre></td></tr></table></figure></li>
<li><strong>语法</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">GROUP BY GROUPING SETS ( column_1, column_2 [, ...] )</span><br><span class="line">GROUP BY GROUPING SETS ( column_1, ( column_2, column_3 ) [, ...] )</span><br><span class="line">GROUP BY GROUPING SETS ( ROLLUP( column_1, column_2 ), CUBE( column_3, column_4 ) [, ...] )</span><br></pre></td></tr></table></figure></li>
<li><strong>范例</strong><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> <span class="keyword">GROUPING</span> SETS ( <span class="keyword">ROLLUP</span> ( department_id, job_id ), <span class="keyword">CUBE</span>( department_id, job_id ) )</span><br><span class="line"><span class="comment">-- 相当于将以下的两个 GROUP BY 的结果，使用 UNION ALL 的方式拼接在一起</span></span><br><span class="line"><span class="comment">-- GROUP BY ROLLUP( department_id, job_id )</span></span><br><span class="line"><span class="comment">-- GROUP BY CUBE( department_id, job_id )</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> <span class="keyword">GROUPING</span> SETS ( <span class="keyword">ROLLUP</span> ( department_id, job_id ), <span class="keyword">CUBE</span>( first_name, last_name ) )</span><br><span class="line"><span class="comment">-- 相当于将以下的两个 GROUP BY 的结果，使用 UNION ALL 的方式拼接在一起，并自动在相应的列上添加 NULL</span></span><br><span class="line"><span class="comment">-- GROUP BY ROLLUP( department_id, job_id )</span></span><br><span class="line"><span class="comment">-- GROUP BY CUBE( first_name, last_name )</span></span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：ROLLUP-从句"><a href="#知识点：ROLLUP-从句" class="headerlink" title="知识点：ROLLUP 从句"></a>知识点：ROLLUP 从句</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 滚动分组</span><br><span class="line">  - 从后向前，以滚动方式执行多个分组查询，将所有的分组结果拼接在一起</span><br><span class="line">  - 共计 n+1 个分组查询的结果，n 为分组项的个数</span><br><span class="line">  - 相应的列自动添加 NULL</span><br><span class="line">  - 括号会减少一次滚动的操作</span><br></pre></td></tr></table></figure></li>
<li><strong>语法</strong><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> <span class="keyword">ROLLUP</span> ( column_a, column_b ,column_c [, ...] )</span><br><span class="line"><span class="comment">-- 相当于将以下的 GROUP BY 的结果拼接在一起</span></span><br><span class="line"><span class="comment">-- GROUP BY column_a, column_b, column_c</span></span><br><span class="line"><span class="comment">-- GROUP BY column_a, column_b</span></span><br><span class="line"><span class="comment">-- GROUP BY column_a</span></span><br><span class="line"><span class="comment">-- GROUP BY 0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> <span class="keyword">ROLLUP</span> ( ( column_a, column_b ), column_c [, ...] )</span><br><span class="line"><span class="comment">-- 相当于将以下的 GROUP BY 的结果拼接在一起</span></span><br><span class="line"><span class="comment">-- GROUP BY column_a, column_b, column_c</span></span><br><span class="line"><span class="comment">-- GROUP BY column_a, column_b</span></span><br><span class="line"><span class="comment">-- GROUP BY 0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> <span class="keyword">GROUPING</span> SETS ( <span class="keyword">ROLLUP</span> ( column_a, column_b ) [, ...] )</span><br></pre></td></tr></table></figure></li>
<li><strong>范例</strong><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 查询每个 department 中每个 job 各有多少人，以及每个 department 的总人数</span></span><br><span class="line"><span class="keyword">SELECT</span> department_id, job_id, <span class="built_in">count</span> (<span class="operator">*</span>)</span><br><span class="line"><span class="keyword">FROM</span> hr.employees</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> <span class="keyword">ROLLUP</span> (department_id, job_id)</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="number">1</span>, <span class="number">2</span></span><br><span class="line">;</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：CUBE-从句"><a href="#知识点：CUBE-从句" class="headerlink" title="知识点：CUBE 从句"></a>知识点：CUBE 从句</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 立方分组</span><br><span class="line">  - 以立方的方式执行多个分组查询，将所有的分组结果拼接在一起</span><br><span class="line">  - 展开所有的分组层次</span><br><span class="line">  - 共计 2^n 个分组查询的结果，n 为分组项的个数</span><br><span class="line">  - 相应的列自动添加 NULL</span><br><span class="line">  - ROLLUP 和 CUBE 的汇总行，在分组依据列自动为 NULL，所以在 WHERE 语句作用应该先过滤分组依据列为 NULL 的行</span><br></pre></td></tr></table></figure></li>
<li><strong>语法</strong><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> <span class="keyword">CUBE</span>( column_a, column_b, column_c [, ...] )</span><br><span class="line"><span class="comment">-- 相当于将以下的 GROUP BY 的结果拼接在一起</span></span><br><span class="line"><span class="comment">-- GROUP BY column_a, column_b, column_c</span></span><br><span class="line"><span class="comment">-- GROUP BY column_a, column_b</span></span><br><span class="line"><span class="comment">-- GROUP BY column_a, column_c</span></span><br><span class="line"><span class="comment">-- GROUP BY column_b, column_c</span></span><br><span class="line"><span class="comment">-- GROUP BY column_a</span></span><br><span class="line"><span class="comment">-- GROUP BY column_b</span></span><br><span class="line"><span class="comment">-- GROUP BY column_c</span></span><br><span class="line"><span class="comment">-- GROUP BY 0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> <span class="keyword">GROUPING</span> SETS( <span class="keyword">CUBE</span>( column_a, column_b ) [, ...] )</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：GROUP-ID-函数"><a href="#知识点：GROUP-ID-函数" class="headerlink" title="知识点：GROUP_ID 函数"></a>知识点：GROUP_ID 函数</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 当分组产生冲突集时，用来区分冲突集</span><br><span class="line">  - 只能作为空函数使用</span><br></pre></td></tr></table></figure></li>
<li><strong>语法</strong><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">group_id( )</span><br></pre></td></tr></table></figure></li>
<li><strong>范例</strong><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> department_id, job_id, <span class="built_in">count</span>(<span class="operator">*</span>), group_id()</span><br><span class="line">  <span class="keyword">FROM</span> hr.employees</span><br><span class="line">  <span class="keyword">GROUP</span> <span class="keyword">BY</span> <span class="keyword">GROUPING</span> SETS( <span class="keyword">ROLLUP</span>( department_id, job_id ), <span class="keyword">CUBE</span>( department_id, job_id ) )</span><br><span class="line">  ;</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：GROUPING-函数"><a href="#知识点：GROUPING-函数" class="headerlink" title="知识点：GROUPING 函数"></a>知识点：GROUPING 函数</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 查看此行是否是 ROLLUP 或 CUBE 的汇总行</span><br><span class="line">  - GROUPING 只能接受一个参数</span><br><span class="line"></span><br><span class="line">* 返回值</span><br><span class="line">  - 1 表示是汇总行</span><br><span class="line">  - 0 表示不是汇总行</span><br></pre></td></tr></table></figure></li>
<li><strong>语法</strong><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GROUPING</span>( column_name )</span><br></pre></td></tr></table></figure></li>
<li><strong>范例</strong><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> department_id, job_id, <span class="built_in">count</span>(<span class="operator">*</span>), <span class="keyword">grouping</span>(department_id), <span class="keyword">grouping</span>(job_id)</span><br><span class="line">  <span class="keyword">FROM</span> employees</span><br><span class="line">  <span class="keyword">GROUP</span> <span class="keyword">BY</span> <span class="keyword">ROLLUP</span>( department_id, job_id )</span><br><span class="line">  ;</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：GROUPING-ID-函数"><a href="#知识点：GROUPING-ID-函数" class="headerlink" title="知识点：GROUPING_ID 函数"></a>知识点：GROUPING_ID 函数</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 查看此行是否是 ROLLUP 或 CUBE 的汇总行</span><br><span class="line">  - 功能比 GROUPING 更多一些</span><br><span class="line">  - 一个参数时，则功能与 GROUPING 相同</span><br><span class="line">  - 多个参数时，意义为将每一列按照 GROUPING( ) 得到结果，将所有结果按顺序拼接在一起，成为一个二进制数，返回其十进制的值</span><br><span class="line">  - 返回值可以用于其他计算</span><br></pre></td></tr></table></figure></li>
<li><strong>语法</strong><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">GROUPING_ID( column_name )</span><br><span class="line">GROUPING_ID( column_1, column_2 [, ...] )</span><br></pre></td></tr></table></figure></li>
<li><strong>范例</strong><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GROUPING</span>( department_id, job_id )</span><br><span class="line"><span class="comment">-- 若某一行的返回值 2，则表示二进制数 10，继而表示是 department_id 的汇总行，但不是 job_id 的汇总行</span></span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h2 id="2-6-层级查询"><a href="#2-6-层级查询" class="headerlink" title="2.6 层级查询"></a>2.6 层级查询</h2><hr>
<h3 id="知识点：层级查询介绍"><a href="#知识点：层级查询介绍" class="headerlink" title="知识点：层级查询介绍"></a>知识点：层级查询介绍</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">* 层级查询 hierarchical query</span><br><span class="line">  - 层级查询用来查询表中所包含的树形结构逻辑</span><br><span class="line">  - 结果是一个倒置树 inverted tree</span><br><span class="line">  - 层级查询需要表中有一列用来记录树形结构的逻辑关系，例如 hr.employees 中的 manager_id 列</span><br><span class="line">  - 必须保证每一个节点都是唯一的，不能出现重复节点，否则会出现重复树</span><br><span class="line">  - 必须保证每一个子节点只有一个父节点，否则报错</span><br><span class="line">  - 层级查询是在 join 之后执行，在 where_clause 之前执行</span><br><span class="line">  - 不建议在层级查询中使用 order_by_clause 和 group_by_clause，因为它们会冲掉最终的层级结果，不过可以使用 ORDER SIBLINGS BY</span><br><span class="line"></span><br><span class="line">* 四种节点</span><br><span class="line">  - 根节点 root</span><br><span class="line">  - 父节点 parent</span><br><span class="line">  - 子节点 child</span><br><span class="line">  - 叶节点 leaf</span><br><span class="line"></span><br><span class="line">* 形式</span><br><span class="line">  - 使用 connect_by_clause 来指定父子关系，放在 where_clause 和 group_clause 之间</span><br><span class="line">  - 使用 start_with_clause 在指定层级查询的根节点</span><br><span class="line">  - 使用 PRIOR 运算符来指定父节点</span><br><span class="line"></span><br><span class="line">* 层级查询的执行过程</span><br><span class="line">  - 通过 start_with_clause 确定根节点</span><br><span class="line">  - 从根节点开始，递归寻找每个节点的所有子节点</span><br><span class="line">  - 最终确立整个倒置树</span><br><span class="line"></span><br><span class="line">* 其他</span><br><span class="line">  - 由于层级查询在底层会被转换为反复执行的 SELECT，因此效率很差</span><br></pre></td></tr></table></figure></li>
<li><strong>范例</strong><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 查询经理 &lt;==&gt; 员工关系</span></span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">  department_id,</span><br><span class="line">  manager_id,</span><br><span class="line">  employee_id,</span><br><span class="line">  first_name <span class="operator">||</span> <span class="string">&#x27; &#x27;</span> <span class="operator">||</span> last_name <span class="keyword">AS</span> name</span><br><span class="line"><span class="keyword">FROM</span> hr.employees</span><br><span class="line"><span class="keyword">CONNECT</span> <span class="keyword">BY</span> PRIOR employee_id<span class="operator">=</span>manager_id</span><br><span class="line"><span class="keyword">ORDER</span> SIBLINGS <span class="keyword">BY</span> manager_id <span class="keyword">desc</span></span><br><span class="line">;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 层级查询结合 case_expression 生成格式化树形结构</span></span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">  employee_id ,</span><br><span class="line">  <span class="keyword">CASE</span> level</span><br><span class="line">    <span class="keyword">WHEN</span> <span class="number">1</span> <span class="keyword">THEN</span> <span class="string">&#x27;  &#x27;</span> <span class="operator">||</span> last_name</span><br><span class="line">    <span class="keyword">WHEN</span> <span class="number">2</span> <span class="keyword">THEN</span> <span class="string">&#x27;    |----&#x27;</span> <span class="operator">||</span> last_name</span><br><span class="line">    <span class="keyword">WHEN</span> <span class="number">3</span> <span class="keyword">THEN</span> <span class="string">&#x27;    |    |----&#x27;</span> <span class="operator">||</span> last_name</span><br><span class="line">    <span class="keyword">WHEN</span> <span class="number">4</span> <span class="keyword">THEN</span> <span class="string">&#x27;    |    |    |----&#x27;</span> <span class="operator">||</span> last_name</span><br><span class="line">    <span class="keyword">END</span> <span class="keyword">AS</span> last_name_path</span><br><span class="line"><span class="keyword">FROM</span> hr.employees</span><br><span class="line"><span class="keyword">CONNECT</span> <span class="keyword">BY</span> PRIOR employee_id<span class="operator">=</span>manager_id</span><br><span class="line"><span class="keyword">START</span> <span class="keyword">WITH</span> employee_id<span class="operator">=</span>( <span class="keyword">SELECT</span> employee_id <span class="keyword">FROM</span> hr.employees <span class="keyword">WHERE</span> manager_id <span class="keyword">IS</span> <span class="keyword">NULL</span>)</span><br><span class="line"><span class="keyword">ORDER</span> SIBLINGS <span class="keyword">BY</span> employee_id</span><br><span class="line">;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 另一种 case_expression 方式</span></span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">  employee_id ,</span><br><span class="line">  level ,</span><br><span class="line">  <span class="keyword">CASE</span> level</span><br><span class="line">    <span class="keyword">WHEN</span> <span class="number">1</span> <span class="keyword">THEN</span> <span class="string">&#x27;  &#x27;</span> <span class="operator">||</span> last_name</span><br><span class="line">    <span class="keyword">ELSE</span> lpad ( <span class="string">&#x27;----&#x27;</span>, ( level<span class="number">-1</span> )<span class="operator">*</span><span class="number">5</span><span class="operator">+</span><span class="number">4</span>, <span class="string">&#x27;    |&#x27;</span> ) <span class="operator">||</span> last_name</span><br><span class="line">  <span class="keyword">END</span> <span class="keyword">AS</span> last_name_path</span><br><span class="line"><span class="keyword">FROM</span> hr.employees</span><br><span class="line"><span class="keyword">CONNECT</span> <span class="keyword">BY</span> PRIOR employee_id<span class="operator">=</span>manager_id</span><br><span class="line"><span class="keyword">START</span> <span class="keyword">WITH</span> employee_id<span class="operator">=</span>( <span class="keyword">SELECT</span> employee_id <span class="keyword">FROM</span> hr.employees <span class="keyword">WHERE</span> manager_id <span class="keyword">IS</span> <span class="keyword">NULL</span>)</span><br><span class="line"><span class="keyword">ORDER</span> SIBLINGS <span class="keyword">BY</span> employee_id</span><br><span class="line">;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 使用层级查询，将列数据集中到一行</span></span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">  sys_connect_by_path( r, <span class="string">&#x27;,&#x27;</span> ) tttt</span><br><span class="line"><span class="keyword">FROM</span> ( <span class="keyword">SELECT</span> ROWNUM r <span class="keyword">FROM</span> hr.employees )</span><br><span class="line"><span class="keyword">WHERE</span> CONNECT_BY_ISLEAF <span class="operator">=</span> <span class="number">1</span></span><br><span class="line"><span class="keyword">START</span> <span class="keyword">WITH</span> r <span class="operator">=</span> <span class="number">1</span></span><br><span class="line"><span class="keyword">CONNECT</span> <span class="keyword">BY</span> prior r <span class="operator">=</span> r <span class="operator">-</span> <span class="number">1</span></span><br><span class="line">;</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：层级查询语法"><a href="#知识点：层级查询语法" class="headerlink" title="知识点：层级查询语法"></a>知识点：层级查询语法</h3><ol>
<li><strong>语法</strong><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> ... <span class="keyword">FROM</span> ... <span class="keyword">WHERE</span> ...</span><br><span class="line">  <span class="keyword">CONNECT</span> <span class="keyword">BY</span> [NOCYCLE] connect_by_condition [<span class="keyword">START</span> <span class="keyword">WITH</span> start_condition ]</span><br><span class="line">  [<span class="keyword">ORDER</span> SIBLINGS <span class="keyword">BY</span> ...]</span><br><span class="line">  ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> ... <span class="keyword">FROM</span> ... <span class="keyword">WHERE</span> ...</span><br><span class="line">  <span class="keyword">START</span> <span class="keyword">WITH</span> start_condition <span class="keyword">CONNECT</span> <span class="keyword">BY</span> [NOCYCLE] connect_by_condition</span><br><span class="line">  [<span class="keyword">ORDER</span> SIBLINGS <span class="keyword">BY</span> ...]</span><br><span class="line">  ;</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">* NOCYCLE</span><br><span class="line">  - 显示环回的行，而不是报错</span><br><span class="line">  - 环回表示，一个节点，同时是另一个节点的祖先和后代</span><br><span class="line"></span><br><span class="line">* CONNECT BY connect_by_condition</span><br><span class="line">  - 指定父子关系，确定树的逻辑关系</span><br><span class="line"></span><br><span class="line">* START WITH start_condition</span><br><span class="line">  - 指定根节点，用来限定是查询一整棵树还是一棵分支</span><br><span class="line">  - 如果省略，则会返回所有的树，亦即所有子树都会被当成一个单独的树重复写一遍</span><br><span class="line"></span><br><span class="line">* ORDER SIBLINGS BY</span><br><span class="line">  - 层级查询排序，只能出现在层级查询中</span><br><span class="line">  - 按父节点进行分组</span><br><span class="line">  - 只对属于同一个父节点的所有子节点进行排序</span><br><span class="line"></span><br><span class="line">* 关于 connect_by_condition 和 where_condition</span><br><span class="line">  - connect_by_condition 在执行上先于 where_condition</span><br><span class="line">  - connect_by_condition 是在树的产生之前进行筛选，不满足条件的节点，连同其子孙，整个树枝都会被减掉</span><br><span class="line">  - where_condition 是在树的产生之后进行筛选，不满足条件的节点被删除，但子孙不受影响，因而会产生不连续的树</span><br></pre></td></tr></table></figure></li>
<li><strong>PRIOR 运算符</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 一元运算符</span><br><span class="line">  - 只能用在层级查询的 connect_by_condition 中，用来指定父节点项，以确定父子关系</span><br><span class="line">  - connect_by_condition 中必须有 PRIOR</span><br><span class="line">  - connect_by_condition 可以包含多个条件，但只能有一个条件需要指定 PRIOR，although you can have multiple PRIOR conditions</span><br><span class="line">  - PRIOR 放在等号左边或右边都可以</span><br><span class="line">  - PRIOR 一般都是指定的是 =，也可以使用其他运算符如比较运算符，但容易产生环回</span><br><span class="line"></span><br><span class="line">* 格式</span><br><span class="line">  PRIOR parent_item = child_item</span><br><span class="line">  child_item = PRIOR parent_item</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：层级查询伪列"><a href="#知识点：层级查询伪列" class="headerlink" title="知识点：层级查询伪列"></a>知识点：层级查询伪列</h3><ol>
<li><strong>CONNECT_BY_ISCYCLE</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 用来检查是否出现环回</span><br><span class="line">  - 必须配合 NOCYCLE 一起使用</span><br><span class="line">  - 1 表示出现了环回，即自己就是自己的父节点或祖先节点 ancestor</span><br><span class="line">  - 0 表示没有环回</span><br></pre></td></tr></table></figure></li>
<li><strong>CONNECT_BY_ISLEAF</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 层级查询伪列，检查节点是否是叶节点</span><br><span class="line">  - 1 表示是叶节点</span><br><span class="line">  - 0 表示不是叶节点</span><br></pre></td></tr></table></figure></li>
<li><strong>LEVEL</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 层级查询伪列，查询节点的深度，查看节点在倒置树中位于底基层</span><br><span class="line">  - 1 表示根节点</span><br><span class="line">  - N 表示根节点的子节点</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：CONNECT-BY-ROOT-运算符"><a href="#知识点：CONNECT-BY-ROOT-运算符" class="headerlink" title="知识点：CONNECT_BY_ROOT 运算符"></a>知识点：CONNECT_BY_ROOT 运算符</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 单目运算符，只能用在层级查询中，用来返回根节点的某列的值</span><br><span class="line">  - 如果层级查询中存在多棵树，则可以用 CONNECT_BY_ROOT 可以用来区分不同的树</span><br><span class="line">  - 可以放在 Select_List 或 where_condition 中，不能用在 start_with_condition 和 connect_by_condition 中</span><br></pre></td></tr></table></figure></li>
<li><strong>范例</strong><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 查询每个员工的大部门领导</span></span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">    first_name <span class="operator">||</span> <span class="string">&#x27; &#x27;</span> <span class="operator">||</span> last_name <span class="keyword">AS</span> employee_name ,</span><br><span class="line">    CONNECT_BY_ROOT first_name <span class="operator">||</span> <span class="string">&#x27; &#x27;</span> <span class="operator">||</span> CONNECT_BY_ROOT last_name <span class="keyword">AS</span> prime_manager_name</span><br><span class="line"><span class="keyword">FROM</span> hr.employees</span><br><span class="line"><span class="keyword">CONNECT</span> <span class="keyword">BY</span> PRIOR employee_id <span class="operator">=</span> manager_id</span><br><span class="line"><span class="comment">-- 子查询确定总领导的 id</span></span><br><span class="line"><span class="comment">-- 通过 START WITH 从句针对每个大部门领导创建一个树</span></span><br><span class="line"><span class="keyword">START</span> <span class="keyword">WITH</span> manager_id <span class="operator">=</span> ( <span class="keyword">SELECT</span> employee_id <span class="keyword">FROM</span> hr.employees <span class="keyword">WHERE</span> manager_id <span class="keyword">IS</span> <span class="keyword">NULL</span>)</span><br><span class="line">;</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：SYS-CONNECT-BY-PATH-函数"><a href="#知识点：SYS-CONNECT-BY-PATH-函数" class="headerlink" title="知识点：SYS_CONNECT_BY_PATH 函数"></a>知识点：SYS_CONNECT_BY_PATH 函数</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">* 作用</span><br><span class="line">  - 只能用在层级查询中，创建到根节点的路径</span><br><span class="line"></span><br><span class="line">* 格式</span><br><span class="line">  SYS_CONNECT_BY_PATH ( column, sep_char )</span><br><span class="line"></span><br><span class="line">* column</span><br><span class="line">  - 放在路径中的值</span><br><span class="line"></span><br><span class="line">* sep_char</span><br><span class="line">  - 指定分隔符</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h2 id="2-7-其他查询"><a href="#2-7-其他查询" class="headerlink" title="2.7 其他查询"></a>2.7 其他查询</h2><hr>
<h3 id="知识点：时间有效性查询"><a href="#知识点：时间有效性查询" class="headerlink" title="知识点：时间有效性查询"></a>知识点：时间有效性查询</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">* 时间有效性查询 temporal validity</span><br><span class="line">  - 在表中储存数据的有效时间段</span><br><span class="line">  - 查询时，需要指明有效时间段</span><br><span class="line">  - 仅返回符合有效时间段的行</span><br><span class="line">  - ILM information lifecycle mamagement</span><br><span class="line"></span><br><span class="line">* 时间有效性字段 valid_time_column</span><br><span class="line">  - 储存有效时间的时间段</span><br><span class="line">  - 自动设置为隐藏列形式</span><br><span class="line">  - 用来作为进行时间有效性判断的依据</span><br><span class="line">  - 实际会作为两个列进行储存数据，valid_time_column_START，valid_time_column_END，标识有效时间的时间段</span><br><span class="line">    - 可以显示指明 START 列和 END 列</span><br><span class="line">    - 也可以仅指明 valid_time_column 的列名，由 Oracle 隐式自动转换为 START 列和 END 列</span><br><span class="line">  - 在 CREATE TABLE 语句中，使用 PERIOD FOR 从句指明时间有效性字段</span><br></pre></td></tr></table></figure></li>
<li><strong>时间有效性查询的两种方式</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">* 基于时间点的查询</span><br><span class="line">  - 查询时给出时间点</span><br><span class="line">  - 返回给定时间点位于有效时间段内的行</span><br><span class="line">  - SELECT 语句中，使用 AS OF PERIOD FOR 实现</span><br><span class="line"></span><br><span class="line">* 基于时间段的查询</span><br><span class="line">  - 查询时给出时间段</span><br><span class="line">  - 返回给定时间段与有效时间段有重合的行</span><br><span class="line">  - SELECT 语句中，使用 VERSIONS BETWEED PERIOD FOR 实现</span><br></pre></td></tr></table></figure></li>
<li><strong>DBMS_FLASHBACK_ARCHIVE.ENABLE_AT_VALID_TIME</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">* 在 session 级指定有效时间点</span><br><span class="line">  - 之后所有的查询和 DML 自动进行对有效时间的基于时间点的查询</span><br><span class="line">  - 注意参数 ASOF 和 CURRENT 要大写，否则过程不会生效，并且不会给出错误提示</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：时间有效性查询语法"><a href="#知识点：时间有效性查询语法" class="headerlink" title="知识点：时间有效性查询语法"></a>知识点：时间有效性查询语法</h3><ol>
<li><strong>CREATE TABLE 指定时间有效性字段</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">* 隐式方式</span><br><span class="line">  CREATE TABLE table ( ..., PERIOD FOR valid_time_column ) ;</span><br><span class="line"></span><br><span class="line">* 显示方式</span><br><span class="line">  CREATE TABLE table ( ...,</span><br><span class="line">    valid_time_column_START DATE ,</span><br><span class="line">    valid_time_column_END DATE ,</span><br><span class="line">    PERIOD FOR valid_time_column ( valid_time_column_START, valid_time_column_END )</span><br><span class="line">    ) ;</span><br></pre></td></tr></table></figure></li>
<li><strong>ALTER TABLE 添加删除时间有效性字段</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">* 添加时间有效性字段</span><br><span class="line">  ALTER TABLE table</span><br><span class="line">    ADD PERIOD FOR valid_time_column [( start_time_column, end_time_column )]</span><br><span class="line">    ;</span><br><span class="line"></span><br><span class="line">* 删除时间有效性字段</span><br><span class="line">  ALTER TABLE table</span><br><span class="line">    DROP PERIOD FOR valid_time_column</span><br><span class="line">    ;</span><br></pre></td></tr></table></figure></li>
<li><strong>INSERT 插入数据到表</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">* 语法</span><br><span class="line">  INSERT INTO table ( ..., column_START , column_END ) VALUES ( ... ) ;</span><br></pre></td></tr></table></figure></li>
<li><strong>SELECT 进行时间有效性查询</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">* 基于时间点的查询</span><br><span class="line">  SELECT ... FROM ...</span><br><span class="line">    AS OF PERIOD FOR valid_time_column datetime</span><br><span class="line">    WHERE ...</span><br><span class="line">    ;</span><br><span class="line"></span><br><span class="line">* 基于时间段的查询</span><br><span class="line">  SELECT ... FROM ...</span><br><span class="line">    VERSIONS PERIOD FOR valid_time_column</span><br><span class="line">      BETWEEN datetime|MINVALUM</span><br><span class="line">      AND datetime|MAXVALUM</span><br><span class="line">    WHERE ...</span><br><span class="line">    ;</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h1 id="Chapter03-SQL-函数和表达式"><a href="#Chapter03-SQL-函数和表达式" class="headerlink" title="Chapter03 SQL 函数和表达式"></a>Chapter03 SQL 函数和表达式</h1><hr>
<h2 id="3-1-函数"><a href="#3-1-函数" class="headerlink" title="3.1 函数"></a>3.1 函数</h2><hr>
<h2 id="3-2-聚合函数"><a href="#3-2-聚合函数" class="headerlink" title="3.2 聚合函数"></a>3.2 聚合函数</h2><hr>
<h2 id="3-3-数学函数"><a href="#3-3-数学函数" class="headerlink" title="3.3 数学函数"></a>3.3 数学函数</h2><hr>
<h2 id="3-4-字符函数"><a href="#3-4-字符函数" class="headerlink" title="3.4 字符函数"></a>3.4 字符函数</h2><hr>
<h2 id="3-5-伪列"><a href="#3-5-伪列" class="headerlink" title="3.5 伪列"></a>3.5 伪列</h2><hr>
<h3 id="知识点：ROWID"><a href="#知识点：ROWID" class="headerlink" title="知识点：ROWID"></a>知识点：ROWID</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 一个数据行的唯一标识，记录了此数据行在数据库中的物理位置</span><br><span class="line">  - Oracle 内部也通过 ROWID 来访问数据</span><br><span class="line"></span><br><span class="line">* ROWID 的内容</span><br><span class="line">  - ROWID 使用 80bit，基于 base64 编码，使用 18 个字符来表示</span><br><span class="line">  - data_object_id  32bit，6 个字符</span><br><span class="line">  - rfile_id        10bit，3 个字符，记录数据文件的 rid</span><br><span class="line">  - block_id        22bit，6 个字符，记录在数据文件中的哪一个 block</span><br><span class="line">  - row_rownumber   16bit，3 个字符，记录在 block 中的第几行</span><br><span class="line"></span><br><span class="line">* 由于 ROWID，数据库的一些限制</span><br><span class="line">  - 一个表空间的数据文件的个数不能超过 2^10 个，实际为 1023 个</span><br><span class="line">  - 一个数据文件的大小不能超过 2^22*block，8k block 数据文件最大为 32T</span><br><span class="line">  - 一个 block 中的行数量不能超过 2^16 个</span><br><span class="line"></span><br><span class="line">* ROWID 和索引</span><br><span class="line">  - 索引中记录的就是 ROWID</span><br><span class="line">  - 移动表，或者导入导出表，会使 ROWID 变化，因而 index 也会失效，因而需要重建 index</span><br><span class="line"></span><br><span class="line">* ROWID 的一个用处</span><br><span class="line">  - 对于重复值的行，通过指定 ROWID 来定位具体要操作的行</span><br></pre></td></tr></table></figure></li>
<li><strong>DBMS_ROWID</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - Oracle 提供的对 ROWID 进行操作的函数的集合包，主要用来 ROWID 中解析出相关的信息</span><br><span class="line"></span><br><span class="line">* DBMS_ROWID.ROWID_OBJECT(ROWID)</span><br><span class="line">  - 从 rowid 中解析出 object_data_id</span><br><span class="line"></span><br><span class="line">* DBMS_ROWID.ROWID_RELATIVE_FNO(ROWID)</span><br><span class="line">  - 从 rowid 中解析出相对文件号 rfile_id</span><br><span class="line"></span><br><span class="line">* DBMS_ROWID.ROWID_BLOCK_NUMBER(ROWID)</span><br><span class="line">  - 从 rowid 中解析出 block_id</span><br><span class="line"></span><br><span class="line">* DBMS_ROWID.ROWID_ROW_NUMBER(ROWID)</span><br><span class="line">  - 从 rowid 中解析出 row_number</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：ROWNUM"><a href="#知识点：ROWNUM" class="headerlink" title="知识点：ROWNUM"></a>知识点：ROWNUM</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 在执行 SELECT 时，根据行被 INSERT 的顺序动态生成的行号</span><br><span class="line">  - 对于简单查询，直接使用基表的 ROWNUM</span><br><span class="line">  - 对于具有子查询的查询，子查询使用基表的 ROWNUM，主查询使用子查询的 ROWNUM</span><br><span class="line"></span><br><span class="line">* ROWNUM 作为 WHERE 的条件时，必须要先从 1 开始向后生成</span><br><span class="line">  - 范例</span><br><span class="line">    - 有返回行: select employee_id from employees where ROWNUM &lt;=2 ;</span><br><span class="line">    - 无返回行: select employee_id from employees where ROWNUM &gt;=2 ;</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h1 id="Chapter05-表"><a href="#Chapter05-表" class="headerlink" title="Chapter05 表"></a>Chapter05 表</h1><hr>
<h2 id="5-1-表"><a href="#5-1-表" class="headerlink" title="5.1 表"></a>5.1 表</h2><hr>
<h3 id="知识点：表"><a href="#知识点：表" class="headerlink" title="知识点：表"></a>知识点：表</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 表 table，是数据库中储存数据的最基础的对象</span><br><span class="line">  - 表采用二维表的方式，储存数据</span><br><span class="line">  - 行储存实体 entity</span><br><span class="line">  - 列储存实体的属性 attribute</span><br><span class="line"></span><br><span class="line">* 列 colume</span><br><span class="line">  - Oracle 中默认一个表的列不能超过 255 个</span><br><span class="line">  - 当超过 255 数量时，则会发生行连接</span><br><span class="line">    - 例如，一个表有 1000 个列，则将这 1000 个列分为 4 个行片，每个行片分别储存在一个 block 中</span><br></pre></td></tr></table></figure></li>
<li><strong>表相关的数据字典</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">* SYS.TAB$</span><br><span class="line">  - 表的基表，记录数据库中的表</span><br><span class="line">  - DBA_TABLES 等数据字典，都是在这些基表上所建立的视图，同义词等</span><br><span class="line"></span><br><span class="line">* DBA_TABLES</span><br><span class="line">  - 记录数据中所有的表和表的相关信息</span><br><span class="line">  - 主要内容包括，表的基本属性、block 属性、extent 属性、统计信息、IM 属性、缓存设置</span><br><span class="line"></span><br><span class="line">* DBA_TAB_COLS</span><br><span class="line">  - 记录所有的表的列</span><br><span class="line"></span><br><span class="line">* DBA_UNUSED_COL_TABS</span><br><span class="line">  - 记录所有的有 UNUSED 的列的表</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：默认值"><a href="#知识点：默认值" class="headerlink" title="知识点：默认值"></a>知识点：默认值</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">* 默认值 DEFAULT</span><br><span class="line">  - 隐式添加 NULL 值时，会自动将 NULL 替换为默认值</span><br><span class="line">  - 显式添加 NULL 值时，则不使用默认值，直接添加 NULL 值</span><br></pre></td></tr></table></figure></li>
<li><strong>默认值的内容</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">* 默认值允许的内容</span><br><span class="line">  - 字面量</span><br><span class="line">  - Expression</span><br><span class="line">  - 部分函数，如 SYADATE、USER</span><br><span class="line">  - 序列值</span><br><span class="line">    - Sequence.NEXTVAL</span><br><span class="line">    - Sequence.CURRVAL</span><br><span class="line"></span><br><span class="line">* 默认值不允许的内容</span><br><span class="line">  - 其他的列的值</span><br><span class="line">  - 伪列的值</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：表的注释"><a href="#知识点：表的注释" class="headerlink" title="知识点：表的注释"></a>知识点：表的注释</h3><ol>
<li><strong>相关字典</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">* DBA_TAB_COMMENTS</span><br><span class="line">  - 记录表和对象的注释</span><br><span class="line"></span><br><span class="line">* DBA_COL_COMMENTS</span><br><span class="line">  - 记录列的注释</span><br></pre></td></tr></table></figure></li>
<li><strong>COMMENT 语句</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">* 为表或列添加注释</span><br><span class="line"></span><br><span class="line">* 语法</span><br><span class="line">  COMMENT ON TABLE TableName IS String ;</span><br><span class="line">  COMMENT ON COLUMN TableName.ColumnName IS String ;</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h2 id="5-2-表-DDL"><a href="#5-2-表-DDL" class="headerlink" title="5.2 表 DDL"></a>5.2 表 DDL</h2><hr>
<h3 id="知识点：CREATE-TABLE-语句"><a href="#知识点：CREATE-TABLE-语句" class="headerlink" title="知识点：CREATE TABLE 语句"></a>知识点：CREATE TABLE 语句</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - CREATE TABLE 语句，用来创建新表</span><br><span class="line"></span><br><span class="line">* CREATE TABLE 需要的权限</span><br><span class="line">  - CREATE TABLE 系统权限</span><br><span class="line">  - QUOTA</span><br></pre></td></tr></table></figure></li>
<li><strong>普通建表语法</strong><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> TableName (</span><br><span class="line">  ColumnName DataType [<span class="keyword">DEFAULT</span> Expression] [ <span class="keyword">Constraint</span> ]</span><br><span class="line">  [, ColumnName DataType [<span class="keyword">DEFAULT</span> Expression] [ <span class="keyword">Constraint</span> ] [, ...] ]</span><br><span class="line">  )</span><br><span class="line">  [TABLESPACE TablespaceName]</span><br><span class="line">  ;</span><br></pre></td></tr></table></figure></li>
<li><strong>子查询建表</strong><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> TableName [ ( ColumnName [, ...] ) ]</span><br><span class="line">  [TABLESPACE TablespaceName]</span><br><span class="line">  <span class="keyword">AS</span> Sub_Query</span><br><span class="line">  ;</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">* 子查询建表的注意事项</span><br><span class="line">  1. 如果指定了 Column_List，则在 Column_List 中不能指定数据类型</span><br><span class="line">  2. 在 Sub_Query 中可以使用列别名，来指定新表的列名</span><br><span class="line">  3. 传递的内容</span><br><span class="line">    - 列名</span><br><span class="line">    - 数据类型</span><br><span class="line">    - 默认值</span><br><span class="line">    - NOT NULL 约束</span><br><span class="line">    - 数据</span><br><span class="line">  4. 不传递的内容</span><br><span class="line">    - PRIMARY KEY 约束</span><br><span class="line">    - PRIMARY KEY 约束隐式建立的 NOT NULL 约束</span><br><span class="line">    - 其他约束</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：ALTER-TABLE-语句"><a href="#知识点：ALTER-TABLE-语句" class="headerlink" title="知识点：ALTER TABLE 语句"></a>知识点：ALTER TABLE 语句</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 用来修改表的属性，包括表的内部属性或物理属性</span><br></pre></td></tr></table></figure></li>
<li><strong>语法</strong><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 重命名 ALTER TABLE RENAME</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> TableOldName RENAME <span class="keyword">TO</span> TableNewName ;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 移动表空间 ALTER TABLE MOVE</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> TableName MOVE TABLESPACE TableSpace ;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 分配新区 ALTER TABLE ALLOCATE EXTENT</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> TableName <span class="keyword">ALLOCATE</span> EXTENT [( [SIZE Size] [DATAFILE <span class="string">&#x27;Filename&#x27;</span>] [INSTANCE N ] )] ;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 回收表末尾的未使用的区 ALTER TABLE DEALLOCATE UNUSED</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> TableName <span class="keyword">DEALLOCATE</span> UNUSED [KEEP Size] ;</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：ALTER-TABLE-修改列"><a href="#知识点：ALTER-TABLE-修改列" class="headerlink" title="知识点：ALTER TABLE 修改列"></a>知识点：ALTER TABLE 修改列</h3><ol>
<li><strong>添加列</strong><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- ALTER TABLE ADD</span></span><br><span class="line"><span class="comment">-- 新添加的列会放在表的最后</span></span><br><span class="line"><span class="comment">-- 新添加的列的数据会全部是 NULL，如果设置了 DEFAULT VALUE 则全部为默认值</span></span><br><span class="line"><span class="comment">-- 新添加的列不能设置 NOT NULL 约束，除非设置了默认值，或者表中没有行</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> TableName <span class="keyword">ADD</span> ( ColumnName DataType [<span class="keyword">DEFAULT</span> Expression] [<span class="keyword">Constraint</span>][, ...] ) ;</span><br></pre></td></tr></table></figure></li>
<li><strong>重命名列</strong><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- ALTER TABLE RENAME COLUMN</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> TableName RENAME <span class="keyword">COLUMN</span> ColumnOldName <span class="keyword">TO</span> ColumnNewName ;</span><br></pre></td></tr></table></figure></li>
<li><strong>修改列</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">-- ALTER TABLE MODIFY</span><br><span class="line">-- 可以变更列的数据类型</span><br><span class="line">-- 可以修改列的数据宽度或精度</span><br><span class="line">-- 可以添加/删除约束</span><br><span class="line">-- 可以修改默认值，对默认值的修改只会影响之后添加的数据</span><br><span class="line">-- 可以删除默认值，即将默认值置位 NULL 即可</span><br><span class="line">ALTER TABLE TableName MODIFY ( ColumnName [DataType] [DEFAULT Expression] [Constraint] [, ...] ) ;</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：ALTER-TABLE-删除列"><a href="#知识点：ALTER-TABLE-删除列" class="headerlink" title="知识点：ALTER TABLE 删除列"></a>知识点：ALTER TABLE 删除列</h3><p>1.<strong>介绍</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 删除列 ALTER TABLE DROP COLUMN</span><br><span class="line">  - 删除列是不可恢复操作，耗时较长，并且会产生 UNDO</span><br><span class="line">  - 删除列会一起删除建立在此列上的约束</span><br><span class="line"></span><br><span class="line">* CASCADE CONSTRAINTS</span><br><span class="line">  - 当列存在某些相关的约束时，会导致无法删除此列</span><br><span class="line">    - 列上建立了主键</span><br><span class="line">    - 列的约束包含其他不被删除的列</span><br><span class="line">    - 列被其他外键所引用</span><br><span class="line">  - 指定 CASCADE CONSTRAINTS，则在删除列时，可以同时删除相关的约束，包括其他表上的外键约束</span><br></pre></td></tr></table></figure>
<ol start="2">
<li><strong>语法</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">-- 删除一列语法</span><br><span class="line">ALTER TABLE TableName DROP COLUMN ColumnName [CASCADE CONSTRAINTS] ;</span><br><span class="line"></span><br><span class="line">-- 删除多列语法</span><br><span class="line">ALTER TABLE TableName DROP ( ColumnName [, ...] ) [CASCADE CONSTRAINTS] ;</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：ALTER-TABLE-标记列不可用"><a href="#知识点：ALTER-TABLE-标记列不可用" class="headerlink" title="知识点：ALTER TABLE 标记列不可用"></a>知识点：ALTER TABLE 标记列不可用</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 标记列不可用 ALTER TABLE SET UNUSED COLUME</span><br><span class="line">  - 用来缓解删除列带来的性能问题</span><br><span class="line">  - 标记列不可用是不可恢复操作，虽然理论上可以恢复，但很麻烦</span><br><span class="line">  - 标记列不可用没有实际删除数据，而是将此列雪藏，对外展示为列已经不存在</span><br><span class="line">  - 标记列不可用会一起删除建立在此列上的约束</span><br><span class="line">    - 如果相关的约束包含其他不被删除的列，需要指定 CASCADE CONSTRAINTS 来强制删除约束</span><br><span class="line">    - 如果删除父表中的 ReferencedColumn，则要加上 CASCADE CONSTRAINTS 关键字，来保留子表中引用了此列的行</span><br><span class="line"></span><br><span class="line">* 优点</span><br><span class="line">  - 反应速度快，不需要锁表，不产生 UNDO</span><br><span class="line">  - 所以一般先将列 SET UNUSED，之后等系统空闲时再 DROP UNUSED COLUMN</span><br></pre></td></tr></table></figure></li>
<li><strong>语法</strong><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 设置一列 UNUSED 语法</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> TableName <span class="keyword">SET</span> UNUSED <span class="keyword">COLUMN</span> ColumnName [CASCADE CONSTRAINTS] [ONLINE] ;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 设置多列 UNUSED 语法</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> TableName <span class="keyword">SET</span> UNUSED ( ColumnName [, ...] ) [CASCADE CONSTRAINTS] [ONLINE] ;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 删除不可用的列语法</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> <span class="keyword">DROP</span> UNUSED COLUMNS ;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- CASCADE CONSTRAINTS</span></span><br><span class="line"><span class="comment">-- 强制删除约束</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- ONLINE</span></span><br><span class="line"><span class="comment">-- 在进行标记的过程中，允许 DML 操作</span></span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：DROP-TABLE-语句"><a href="#知识点：DROP-TABLE-语句" class="headerlink" title="知识点：DROP TABLE 语句"></a>知识点：DROP TABLE 语句</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 删除表</span><br><span class="line">  - 默认只是将表移动到 RECYCLE BIN 中，之后还可以还原</span><br><span class="line">  - PURGE 会将表彻底删除，无法还原</span><br><span class="line"></span><br><span class="line">* DROP TABLE 语句将会一起关联删除的对象</span><br><span class="line">  - 索引</span><br><span class="line">  - 约束</span><br><span class="line">  - 触发器</span><br><span class="line">  - 相关的 object privileges 的授予</span><br><span class="line"></span><br><span class="line">* DROP TABLE 语句不会一起关联删除的对象</span><br><span class="line">  - 视图，不会被关联删除，但是会失效</span><br><span class="line">  - 同义词，不会被关联删除，但是会失效</span><br></pre></td></tr></table></figure></li>
<li><strong>语法</strong><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> TableName [CASCADE CONSTRAINTS] [PURGE] ;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- CASCADE CONSTRAINTS</span></span><br><span class="line"><span class="comment">-- 当表被作为父表被其他表的外键引用时，默认无法删除父表</span></span><br><span class="line"><span class="comment">-- 指定 CASCADE CONSTRAINTS 可以删除父表，同时删除子表上建立的外键约束</span></span><br><span class="line"><span class="comment">-- 子表中的行保持不变</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- PURGE</span></span><br><span class="line"><span class="comment">-- 彻底删除，不放到 RECYCLE BIN 中，数据无法还原</span></span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：TRUNCATE-TABLE-语句"><a href="#知识点：TRUNCATE-TABLE-语句" class="headerlink" title="知识点：TRUNCATE TABLE 语句"></a>知识点：TRUNCATE TABLE 语句</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 删除表中的所有数据，仅保留表的结构</span><br><span class="line">  - 重置高水平线</span><br><span class="line">  - TRUNCATE TABLE 语句是一个 DDL 语句，不能被撤销</span><br><span class="line">  - TRUNCATE TABLE 比 DELETE 语句更快</span><br><span class="line">    - TRUNCATE TABLE 是 DDL，不生成 redo、undo</span><br><span class="line">    - TRUNCATE TABLE 不会触发表的 DELETE 触发器</span><br><span class="line">  - 保留触发器</span><br><span class="line">  - 保留约束</span><br><span class="line"></span><br><span class="line">* TURNCATE 需要的权限</span><br><span class="line">  - OWNER</span><br><span class="line">  - TRUNCATE ANY TABLE 系统权限</span><br><span class="line"></span><br><span class="line">* TRUNCATE TABLE 的限制</span><br><span class="line">  - TRUNCATE TABLE 不能删除带外键的父表，必须要先禁用外键，再发出 TRUNCATE 语句</span><br><span class="line"></span><br><span class="line">* TURNCATE TABLE 关联操作</span><br><span class="line">  - 删除索引的所有数据，保留索引的结构，重置索引的高水位线</span><br></pre></td></tr></table></figure></li>
<li><strong>语法</strong><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">TRUNCATE</span> <span class="keyword">TABLE</span> <span class="keyword">table</span> [CASCADE] ;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- CASCADE</span></span><br><span class="line"><span class="comment">-- 如果子表的外键设置的是 ON DELETE CASCADE，则可以同时 TRUNCATE 子表</span></span><br><span class="line"><span class="comment">-- 其他情况，TRUNCATE TABLE 无法执行</span></span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h2 id="5-3-约束"><a href="#5-3-约束" class="headerlink" title="5.3 约束"></a>5.3 约束</h2><hr>
<h3 id="知识点：约束"><a href="#知识点：约束" class="headerlink" title="知识点：约束"></a>知识点：约束</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 约束 Constraint，是在表级逻辑层上设定规则，对表的数据进行限定</span><br><span class="line">    - 对表的增删改需要满足约束</span><br><span class="line">    - 删除表需要满足外键约束</span><br><span class="line">  - 约束可以满足 ACID 中一致性和完整性的功能</span><br><span class="line">  - 约束可以减少开发代码时需要设定的规则</span><br><span class="line"></span><br><span class="line">* 约束的种类</span><br><span class="line">  - NOT NULL</span><br><span class="line">  - UNIQUE</span><br><span class="line">  - PRIMARY KEY</span><br><span class="line">  - FOREIGN KEY</span><br><span class="line">  - CHECK</span><br><span class="line"></span><br><span class="line">* 约束的名字</span><br><span class="line">  - 在创建约束时，默认系统会自动生成一个名字，使用 SYS_Cn 的格式</span><br><span class="line">  - 可以在创建约束时手动对约束起名</span><br><span class="line">  - 可以之后使用 ALTER TABLE 对约束进行改名</span><br><span class="line"></span><br><span class="line">* 约束的创建</span><br><span class="line">  - 在 CREATE TABLE 时创建约束</span><br><span class="line">  - 用 ALTER TABLE 创建约束</span><br><span class="line"></span><br><span class="line">* 列级约束和表级约束</span><br><span class="line">  - 列级约束 Column-level Constraint，在 CREATE TABLE 时约束写在列后</span><br><span class="line">  - 表级约束 Table-level Constraint，在 CREATE TABLE 时约束写在表的末尾</span><br><span class="line">  - NOT NULL 约束只能作为列级约束</span><br><span class="line">  - PRIMARY KEY、UNIQUE、FOREIGN KEY、CHECK，可以作为列级约束，也可以作为表级约束，如果一个约束中涉及多个列，则只能作为表级约束</span><br></pre></td></tr></table></figure></li>
<li><strong>相关字典</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">* DBA_CONSTRAINTS</span><br><span class="line">  - 记录所有的约束及其内容</span><br><span class="line"></span><br><span class="line">* DBA_CONS_COLUMNS</span><br><span class="line">  - 记录所有的建有约束的列</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：约束的种类"><a href="#知识点：约束的种类" class="headerlink" title="知识点：约束的种类"></a>知识点：约束的种类</h3><ol>
<li><strong>NOT NULL 约束</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 保证新增的数据不是 NULL</span><br><span class="line">  - NOT NULL 约束在底层使用 CHECK 约束来实现，因此在数据字典中的 CONSTRAINT_TYPE 记录为 C</span><br><span class="line">  - NOT NULL 约束只能写在列级约束中</span><br><span class="line">  - 在 ALTER TABLE 时，NOT NULL 约束只能使用 ALTER TABLE MODIFY 语句添加和删除，或者使用 CHECK 约束来实现 NOT NULL 约束</span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 范例</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> test ( a NUMBER <span class="keyword">NOT</span> <span class="keyword">NULL</span> ) ;</span><br></pre></td></tr></table></figure></li>
<li><strong>CHECK 约束</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 由用户自定义约束的规则</span><br><span class="line">  - 一个表可以定义多个 CHECK 约束，没有数量限制</span><br><span class="line">  - 一个列上可以定义多个 CHECK 约束，没有数量限制</span><br><span class="line"></span><br><span class="line">* CHECK 约束中不可以使用的内容</span><br><span class="line">  - 伪列，如 CURRVAL，NEXTVAL，LEVEL，ROWNUM</span><br><span class="line">  - 部分函数，如 SYSDATE，UID，USER，USERENV</span><br><span class="line">  - 对其他行的引用</span><br><span class="line"></span><br><span class="line">* CHECK 约束的位置</span><br><span class="line">  - 既可以写在列级约束中，也可以写在表级约束中</span><br><span class="line">  - 列级约束只能引用本列，不能引用其他列</span><br><span class="line">  - 如果涉及多个列，则只能写在表记约束中</span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 范例</span></span><br><span class="line"><span class="comment">-- 列级 CHECK 约束</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> test ( a NUMBER <span class="keyword">CHECK</span> ( a <span class="operator">&gt;</span> <span class="number">100</span> ) ) ;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 表级 CHECK 约束</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> test ( a NUMBER , b NUMBER , <span class="keyword">CHECK</span> ( a <span class="operator">+</span> b <span class="operator">&gt;</span> <span class="number">100</span> ) ) ;</span><br></pre></td></tr></table></figure></li>
<li><strong>UNIQUE 约束</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - UNIQUE 约束，用来保证列中不会有重复数据</span><br><span class="line">  - 如果 UNIQUE 约束定义在一列上，则这一列不会有两个相同的记录</span><br><span class="line">  - 如果 UNIQUE 约束定义在多列上，则这几列不会有两行完全相同的记录</span><br><span class="line">    - 两行的每一列的数据都相同，违反约束</span><br><span class="line">    - 两行中，部分列是 NULL ，部分列不是 NULL，则所有非 NULL 的列数据相同，就违反约束</span><br><span class="line">    - 两行所有列的数据都是 NULL，不违反约束</span><br><span class="line"></span><br><span class="line">* 唯一键 unique key</span><br><span class="line">  - 创建了 UNIQUE 约束的列，会被称为唯一键</span><br><span class="line">  - 如果 UNIQUE 约束中包含多个列，则这些列称为组合唯一键 composite unique key</span><br><span class="line"></span><br><span class="line">* UNIQUE 约束和 UNIQUE 索引</span><br><span class="line">  - UNIQUE 约束会隐式的创建一个 UNIQUE INDEX</span><br><span class="line">  - UNIQUE INDEX 的名字与约束名相同</span><br><span class="line">  - 可以使用 using_index_clause 来显示指定使用的索引</span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 范例</span></span><br><span class="line"><span class="comment">-- 列级 UNIQUE 约束</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> test ( a NUMBER <span class="keyword">UNIQUE</span> ) ;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 表级 UNIQUE 约束</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> test ( a NUMBER, b NUMBER, <span class="keyword">UNIQUE</span> ( a, b ) ) ;</span><br></pre></td></tr></table></figure></li>
<li><strong>PRIMARY KEY 约束</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 主键约束，用来唯一标识一个表中的某一行</span><br><span class="line">  - 通常会被作为父表中的 ReferencedColumn</span><br><span class="line">  - 一个表只能创建一个 PRIMARY KEY 约束</span><br><span class="line">  - PRIMARY KEY 相当于 NOT NULL 和 UNIQUE 的组合</span><br><span class="line">  - PRIMARY KEY 中可以只包含一列，也可以包含多列，如果包含多个列，则每列都不允许插入 NULL</span><br><span class="line"></span><br><span class="line">* PRIMARY KEY 约束和 UNIQUE 索引</span><br><span class="line">  - PRIMARY 会隐式的创建一个 UNIQUE INDEX</span><br><span class="line">  - UNIQUE INDEX 的名字与主键的名字相同</span><br><span class="line">  - 可以使用 using_index_clause 来显示指定使用的索引</span><br><span class="line"></span><br><span class="line">* 组合主键 Composite Primary Key</span><br><span class="line">  - 如果一个主键约束中包含多个列，则称为组合主键</span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 范例</span></span><br><span class="line"><span class="comment">-- 列级 PRIMARY KEY 约束</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> test ( a NUMBER <span class="keyword">PRIMARY</span> KEY, b NUMBER ) ;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 表级 PRIMARY KEY 约束</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> test ( a NUMBER, b NUMBER, <span class="keyword">PRIMARY</span> KEY ( a, b ) ) ;</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：外键约束"><a href="#知识点：外键约束" class="headerlink" title="知识点：外键约束"></a>知识点：外键约束</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 外键约束 FOREIGN KEY，用来在两个表之间建立一对多的关系，父表为一，子表为多</span><br><span class="line">  - 外键约束定义在子表上，引用父表中的内容</span><br><span class="line">  - 在一个列上可以建立多个 FOREIGN KEY 约束</span><br><span class="line">  - 一个 FOREIGN KEY 约束只能引用一个父表</span><br><span class="line">  - 如果 FOREIGN KEY 中包含多个列</span><br><span class="line">    - 父表的 PRIMARY KEY 约束或 UNIQUE 约束必须是包含多个列的约束</span><br><span class="line">    - 子表外键中的列的数量必须与父表的 PRIMARY KEY 约束或 UNIQUE 约束列的数量相同</span><br><span class="line"></span><br><span class="line">* 被引用列 ReferencedColumn</span><br><span class="line">  - 父表中的被引用列</span><br><span class="line">  - ReferencedColumn 必须已经建立了 PRIMARY KEY 约束或 UNIQUE 约束</span><br><span class="line">  - FOREIGN KEY 约束实际上是指向父表的 PRIMARY KEY 约束或 UNIQUE 约束</span><br><span class="line"></span><br><span class="line">* 引用列 ReferencingColumn</span><br><span class="line">  - 子表中引用父表的列</span><br><span class="line">  - ReferencingColumn 如果没有 NOT NULL 约束，则可以插入空值，不论父表的 ReferencedColumn 是否设定了 NOT NULL</span><br></pre></td></tr></table></figure></li>
<li><strong>父表的删除</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 子表建立了 FOREIGN KEY 后，删除父表的行会受到限制，即使子表是一个空表</span><br><span class="line">  - 父表内没有被子表所引用的行的删除不受限制</span><br><span class="line">  - 父表内被子表引用的行删除受限制</span><br><span class="line">  - 受影响的情况包括，TRUNCATE TABLE 截断表，DELETE 删除行</span><br><span class="line"></span><br><span class="line">* 不指定 ON DELETE</span><br><span class="line">  - 相当于 no action，此时无法删除父表中的行</span><br><span class="line"></span><br><span class="line">* 指定 ON DELETE CASCADE</span><br><span class="line">  - 对父表进行 TRUNCATE TABLE，无法执行</span><br><span class="line">  - 对父表进行 TRUNCATE TABLE CASCADE，子表中的行会被一起删除</span><br><span class="line">  - 对父表进行 DELETE，子表中的行会被一起删除</span><br><span class="line"></span><br><span class="line">* 指定 ON DELETE SET NULL</span><br><span class="line">  - 对父表进行 TRUNCATE TABLE，无法执行</span><br><span class="line">  - 对父表进行 TRUNCATE TABLE CASCADE，无法执行</span><br><span class="line">  - 对父表进行 DELETE，子表中的行会被设置为 NULL</span><br></pre></td></tr></table></figure></li>
<li><strong>语法</strong><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- FOREIGH KEY 约束既可以写在列级约束中，也可以写在表级约束中</span></span><br><span class="line"><span class="comment">-- 写在列级约束时，可以省略此列的数据类型</span></span><br><span class="line"><span class="comment">-- 如果涉及多个列，则只能写在表级约束中</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 列级</span></span><br><span class="line">[<span class="keyword">CONSTRAINT</span> ConstraintName] <span class="keyword">REFERENCES</span> ParentTable( ColumnName ) [<span class="keyword">ON</span> <span class="keyword">DELETE</span> &#123;CASCADE <span class="operator">|</span> <span class="keyword">SET</span> <span class="keyword">NULL</span>&#125;]</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 表级</span></span><br><span class="line">[<span class="keyword">CONSTRAINT</span> ConstraintName] <span class="keyword">FOREIGN</span> KEY ( Column_List ) <span class="keyword">REFERENCES</span> ParentTable( Column_List ) [<span class="keyword">ON</span> <span class="keyword">DELETE</span> &#123;CASCADE <span class="operator">|</span> <span class="keyword">SET</span> <span class="keyword">NULL</span>&#125;]</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
<li><strong>范例</strong><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 列级</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> test ( a [NUMBER] <span class="keyword">REFERENCES</span> employees ( employee_id ) ) ;</span><br><span class="line"></span><br><span class="line"><span class="operator">-</span> 表级</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> test ( a NUMBER, b NUMBER, <span class="keyword">FOREIGN</span> KEY ( a ) <span class="keyword">REFERENCES</span> employees ( employee_id ) ) ;</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
<li><strong>其他</strong><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 给出子表，看其有哪些父表</span></span><br><span class="line"><span class="operator">&amp;</span>owner                <span class="comment">-- 指定子表的 owner</span></span><br><span class="line"><span class="operator">&amp;</span>child_table_name     <span class="comment">-- 指定子表的表名</span></span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">  child.constraint_type &quot;child_cons_type&quot;,</span><br><span class="line">  child.table_name &quot;child_table&quot;,</span><br><span class="line">  child.Constraint_Name &quot;child_cons&quot;,</span><br><span class="line">  father.constraint_type &quot;father_cons_type&quot;,</span><br><span class="line">  father.table_name &quot;father_table&quot;,</span><br><span class="line">  father.Constraint_Name &quot;father_cons&quot;</span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">  dba_constraints child <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> dba_constraints father</span><br><span class="line">  <span class="keyword">ON</span> child.r_owner <span class="operator">=</span> father.owner <span class="keyword">AND</span> child.r_Constraint_Name <span class="operator">=</span> father.Constraint_Name</span><br><span class="line"><span class="keyword">WHERE</span></span><br><span class="line">  child.owner <span class="operator">=</span> <span class="built_in">upper</span>( <span class="string">&#x27;&amp;owner&#x27;</span> )</span><br><span class="line">  <span class="keyword">AND</span> child.table_name <span class="operator">=</span> <span class="built_in">upper</span>( <span class="string">&#x27;&amp;child_table_name&#x27;</span> )</span><br><span class="line">  <span class="keyword">AND</span> child.constraint_type <span class="operator">=</span> <span class="string">&#x27;R&#x27;</span></span><br><span class="line">;</span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 给出父表，看其有哪些子表</span></span><br><span class="line"><span class="operator">&amp;</span>owner                <span class="comment">-- 指定父表的 owner</span></span><br><span class="line"><span class="operator">&amp;</span>child_table_name     <span class="comment">-- 指定父表的表名</span></span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">  child.constraint_type &quot;child_cons_type&quot;,</span><br><span class="line">  child.table_name &quot;child_table&quot;,</span><br><span class="line">  child.Constraint_Name &quot;child_cons&quot;,</span><br><span class="line">  father.constraint_type &quot;father_cons_type&quot;,</span><br><span class="line">  father.table_name &quot;father_table&quot;,</span><br><span class="line">  father.Constraint_Name &quot;father_cons&quot;</span><br><span class="line"><span class="keyword">FROM</span> dba_constraints father <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> dba_constraints child</span><br><span class="line">  <span class="keyword">ON</span> child.r_owner <span class="operator">=</span> father.owner <span class="keyword">AND</span> child.r_Constraint_Name <span class="operator">=</span> father.Constraint_Name</span><br><span class="line"><span class="keyword">WHERE</span> father.owner <span class="operator">=</span> <span class="built_in">upper</span>( <span class="string">&#x27;&amp;owner&#x27;</span> )</span><br><span class="line">  <span class="keyword">AND</span> father.table_name <span class="operator">=</span> <span class="built_in">upper</span>( <span class="string">&#x27;&amp;child_table_name&#x27;</span> )</span><br><span class="line">  <span class="keyword">AND</span> child.constraint_type <span class="operator">=</span> <span class="string">&#x27;R&#x27;</span></span><br><span class="line">;</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：约束的启用和禁用"><a href="#知识点：约束的启用和禁用" class="headerlink" title="知识点：约束的启用和禁用"></a>知识点：约束的启用和禁用</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">* ENABLE</span><br><span class="line">  - 启用约束</span><br><span class="line">  - 启用约束后，对于之后的 DML 操作，进行约束的检查</span><br><span class="line"></span><br><span class="line">* DISABLE</span><br><span class="line">  - 禁用约束</span><br><span class="line">  - 禁用约束后，对于之后的 DML 操作，不进行约束的检查</span><br><span class="line">  - 对于 PRIMARY KEY 和 UNIQUE 约束，如果外键所引用，需要指定 DISABLE CASCADE 来级联禁用约束</span><br><span class="line">  - 禁用 PRIMARY KEY 和 UNIQUE 约束会自动删除索引，重新启用约束会自动建立索引</span><br><span class="line">  - 对于指定 DISABLE CASCADE 被级联禁用的外键，重新启用约束无法级联启用外键</span><br><span class="line"></span><br><span class="line">* 约束的 ENABLE/DISABLE 的指定和修改</span><br><span class="line">  - 可以在 CREATE TABLE 时指定</span><br><span class="line">  - 可以在 ALTER TABLE ADD CONSTRAINT 中指定</span><br><span class="line">  - 可以通过 ALTER TABLE MODIFY 进行修改</span><br><span class="line">  - 位置，放在 DEFERRABLE 部分之后</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：约束的生效和失效"><a href="#知识点：约束的生效和失效" class="headerlink" title="知识点：约束的生效和失效"></a>知识点：约束的生效和失效</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">* VALIDATE</span><br><span class="line">  - 指定约束生效</span><br><span class="line">  - 对于表中已经存在的数据，进行约束的检查</span><br><span class="line"></span><br><span class="line">* NOVALIDATE</span><br><span class="line">  - 指定约束失效</span><br><span class="line">  - 对于表中已经存在的数据，不进行约束的检查</span><br><span class="line"></span><br><span class="line">* 约束的 VALIDATE/NOVALIDATE 的指定与修改</span><br><span class="line">  - 可以在 CREATE TABLE 时指定</span><br><span class="line">  - 可以在 ALTER TABLE ADD CONSTRAINT 中指定</span><br><span class="line">  - 可以通过 ALTER TABLE MODIFY 进行修改</span><br><span class="line">  - 位置，放在 ENABLE、DISABLE 之后</span><br><span class="line"></span><br><span class="line">* 一个常见的应用场景，当需要加载脏数据时</span><br><span class="line">  - DISABLE 约束并 NOVALIDATE 约束</span><br><span class="line">  - INSERT 新数据，UPDATE 新数据</span><br><span class="line">  - 提交</span><br><span class="line">  - VALIDATE 约束，如果失败，则对违反约束的数据进行修改，直到约束可以生效</span><br><span class="line">  - ENABLE 约束</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：约束的延迟检查"><a href="#知识点：约束的延迟检查" class="headerlink" title="知识点：约束的延迟检查"></a>知识点：约束的延迟检查</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 约束的延迟检查，可以修改在事务中对数据进行约束的检查的时间点</span><br><span class="line">  - 优点，提供了一种可以在事务之内启用和禁用约束的手段</span><br><span class="line">  - 延迟约束是为 SET CONSTRAINT 语句专门提供的一个特性</span><br><span class="line"></span><br><span class="line">* NOT DEFERRABLE</span><br><span class="line">  - 普通约束</span><br><span class="line">  - 非延迟，不允许延迟检查</span><br><span class="line">  - 对约束的检查是在每一个 DML 语句之后就进行</span><br><span class="line"></span><br><span class="line">* DEFERRABLE</span><br><span class="line">  - 延迟约束，允许修改约束的检查时间点</span><br><span class="line">  - DEFERRABLE IMMDEIATE，在 DML 语句结束时进行约束的检查，效果与普通约束相同</span><br><span class="line">  - DEFERRABLE DEFERRED，在 COMMIT 时才进行约束的检查</span><br><span class="line"></span><br><span class="line">* 应用场景</span><br><span class="line">  - 当需要在添加大量低质量的数据时，可以提高成功率</span><br><span class="line">  - 主要用在物化视图的场景</span><br><span class="line">  - 一个应用场景</span><br><span class="line">    - SET CONSTRAINT ALL DEFERRED</span><br><span class="line">    - 执行添加数据的 DML 语句</span><br><span class="line">    - SET CONSTRAINT Constraint_1 IMMEDIATE，如果失败，检查并修改引起失败的数据，直到语句成功</span><br><span class="line">    - SET CONSTRAINT Constraint_2 IMMEDIATE，持续对所有约束进行检查，直到所有的约束全部通过检查</span><br><span class="line">    - COMMIT</span><br></pre></td></tr></table></figure></li>
<li><strong>延迟约束的初始状态</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 延迟约束的初始状态，是指约束一开始是延迟检查或立即检查</span><br><span class="line"></span><br><span class="line">* INITIALLY IMMDEIATE</span><br><span class="line">  - 指定延迟约束在一开始就是立即检查的</span><br><span class="line">  - 只有在之后的事务中使用 SET CONSTRAINT 来修改延迟约束的检查时刻</span><br><span class="line"></span><br><span class="line">* INITIALLY DEFERRED</span><br><span class="line">  - 指定延迟约束在一开始就是延迟检查的</span><br><span class="line"></span><br><span class="line">  - 可以在 CREATE TABLE 中新建约束时指定</span><br><span class="line">  - 可以在 ALTER TABLE ADD CONSTRAINT 中新建约束时指定</span><br><span class="line">  - 可以用 ALTER TABLE MODIFY CONSTRAINT 来修改延迟约束的初始状态</span><br><span class="line">  - 不能用 ALTER TABLE MODIFY CONSTRAINT 将非延迟约束修改为延迟约束，如果想修改只能删除约束后重建</span><br><span class="line">  - 位置，位于 constraint_contents 之后</span><br></pre></td></tr></table></figure></li>
<li><strong>SET CONSTRAINT 语句</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 修改延迟约束的检查时间</span><br><span class="line">  - SET CONSTRAINT 的设置会覆盖延迟约束的初始状态</span><br><span class="line">  - SET CONSTRAINT 的修改，限定在一个事务之内</span><br><span class="line">  - 也可以使用 ALTER SESSION SET CONSTRAINT 方式的语法，作用相同</span><br><span class="line">  - SET CONSTRAINT IMMEDIATE 语句如果失败，不会回退已经执行的 DML 操作</span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 语法</span></span><br><span class="line"><span class="keyword">SET</span> &#123;<span class="keyword">CONSTRAINT</span><span class="operator">|</span>CONSTRAINTS&#125; &#123;<span class="keyword">ALL</span><span class="operator">|</span>Constraint_List&#125; &#123;IMMEDIATE<span class="operator">|</span>DEFERRED&#125; ;</span><br><span class="line"><span class="keyword">ALTER</span> SESSION <span class="keyword">SET</span> &#123;<span class="keyword">CONSTRAINT</span><span class="operator">|</span>CONSTRAINTS&#125; &#123;<span class="keyword">ALL</span><span class="operator">|</span>Constraint_List&#125; &#123;IMMEDIATE<span class="operator">|</span>DEFERRED&#125; ;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- CONSTRAINT|CONSTRAINTS</span></span><br><span class="line"><span class="comment">-- 语法提示词</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- ALL|Constraint_List</span></span><br><span class="line"><span class="comment">-- 指定要修改的约束</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- IMMEDIATE</span></span><br><span class="line"><span class="comment">-- 将延迟约束的检查时间修改到语句结束前，相当于禁用延迟检查的功能</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- DEFERRED</span></span><br><span class="line"><span class="comment">-- 将延迟约束的检查时间修改到事务提交前，相当于启用延迟检查</span></span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h2 id="5-4-约束-DDL"><a href="#5-4-约束-DDL" class="headerlink" title="5.4 约束 DDL"></a>5.4 约束 DDL</h2><hr>
<h3 id="知识点：CONSTRAINT-从句"><a href="#知识点：CONSTRAINT-从句" class="headerlink" title="知识点：CONSTRAINT 从句"></a>知识点：CONSTRAINT 从句</h3><ol>
<li><strong>列级 inline_constraint_clause</strong><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- NOT NULL</span></span><br><span class="line">[<span class="keyword">CONSTRAINT</span> Constraint_Name] [ <span class="keyword">NOT</span> ] <span class="keyword">NULL</span> [Constraint_State]</span><br><span class="line"></span><br><span class="line"><span class="comment">-- CHECK</span></span><br><span class="line">[<span class="keyword">CONSTRAINT</span> Constraint_Name] <span class="keyword">CHECK</span> (<span class="keyword">condition</span>) [Constraint_State]</span><br><span class="line"></span><br><span class="line"><span class="comment">-- UNIQUE</span></span><br><span class="line">[<span class="keyword">CONSTRAINT</span> Constraint_Name] <span class="keyword">UNIQUE</span> [Constraint_State]</span><br><span class="line"></span><br><span class="line"><span class="comment">-- PRIMARY KEY</span></span><br><span class="line">[<span class="keyword">CONSTRAINT</span> Constraint_Name] <span class="keyword">PRIMARY</span> KEY [Constraint_State]</span><br><span class="line"></span><br><span class="line"><span class="comment">-- FOREIGN KEY</span></span><br><span class="line">[<span class="keyword">CONSTRAINT</span> Constraint_Name] <span class="keyword">REFERENCES</span> TableName ( Column_List ) [<span class="keyword">ON</span> <span class="keyword">DELETE</span> &#123;CASCADE<span class="operator">|</span><span class="keyword">SET</span> <span class="keyword">NULL</span>&#125;] [Constraint_State]</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
<li><strong>表级 out_of_line_constraint_clause</strong><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- CHECK</span></span><br><span class="line">[<span class="keyword">CONSTRAINT</span> Constraint_Name] <span class="keyword">CHECK</span> (<span class="keyword">condition</span>) [Constraint_State]</span><br><span class="line"></span><br><span class="line"><span class="comment">-- UNIQUE</span></span><br><span class="line">[<span class="keyword">CONSTRAINT</span> Constraint_Name] &#123; <span class="keyword">UNIQUE</span> (Column_List) [Constraint_State]</span><br><span class="line"></span><br><span class="line"><span class="comment">-- PRIMARY KEY</span></span><br><span class="line">[<span class="keyword">CONSTRAINT</span> Constraint_Name] <span class="keyword">PRIMARY</span> KEY (Column_List) [Constraint_State]</span><br><span class="line"></span><br><span class="line"><span class="comment">-- FOREIGN KEY</span></span><br><span class="line">[<span class="keyword">CONSTRAINT</span> Constraint_Name] <span class="keyword">FOREIGN</span> KEY (Column_List) <span class="keyword">REFERENCES</span> <span class="keyword">table</span> ( Column_List ) [<span class="keyword">ON</span> <span class="keyword">DELETE</span> &#123;CASCADE<span class="operator">|</span><span class="keyword">SET</span> <span class="keyword">NULL</span>&#125;] [Constraint_State]</span><br></pre></td></tr></table></figure></li>
<li><strong>Constraint_State</strong><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[[<span class="keyword">NOT</span>] DEFERRABLE [INITIALLY &#123;IMMEDIATE <span class="operator">|</span> DEFERRED&#125;] ] [RELY<span class="operator">|</span>NORELY] [Using_Index_Clause] [ENABLE<span class="operator">|</span>DISABLE] [VALIDATE<span class="operator">|</span>NOVALIDATE]</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：USING-INDEX-从句"><a href="#知识点：USING-INDEX-从句" class="headerlink" title="知识点：USING INDEX 从句"></a>知识点：USING INDEX 从句</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 在创建 PRIMARY KEY 约束和 UNIQUE 约束时，显示指定使用的 UNIQUE 索引</span><br><span class="line">  - 可以是已经存在的 INDEX</span><br><span class="line">  - 可以现场指定 Create_Index 语句</span><br></pre></td></tr></table></figure></li>
<li><strong>语法</strong><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">USING</span> INDEX IndexName</span><br><span class="line"><span class="keyword">USING</span> INDEX ( Create_Index )</span><br></pre></td></tr></table></figure></li>
<li><strong>范例</strong><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- PRIMARY KEY</span></span><br><span class="line"><span class="keyword">PRIMARY</span> KEY [( Column_List )] Using_Index_Clause</span><br><span class="line"></span><br><span class="line"><span class="comment">-- UNIQUE</span></span><br><span class="line"><span class="keyword">UNIQUE</span> [( Column_List )] Using_Index_Clause</span><br><span class="line"></span><br><span class="line"><span class="comment">-- CREATE TABLE</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> TableName ( ColumnName DataType <span class="keyword">PRIMARY</span> KEY <span class="keyword">USING</span> INDEX ( Create_Index ) ... ) ;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- ALTER TABLE</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> TableName <span class="keyword">ADD</span> <span class="keyword">PRIMARY</span> KEY ( Column_List ) <span class="keyword">USING</span> INDEX IndexName ;</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> TableName <span class="keyword">ADD</span> <span class="keyword">PRIMARY</span> KEY ( Column_List ) <span class="keyword">USING</span> INDEX ( Create_Index ) ;</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：CREATE-TABLE-指定约束"><a href="#知识点：CREATE-TABLE-指定约束" class="headerlink" title="知识点：CREATE TABLE 指定约束"></a>知识点：CREATE TABLE 指定约束</h3><ol>
<li><strong>语法</strong><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> TableName (</span><br><span class="line">  ColumnName DataType [<span class="keyword">DEFAULT</span> <span class="keyword">Value</span>] Inline_Constraint_Clause [Inline_Constraint_Clause ...]</span><br><span class="line">  [, ColumnName DataType [<span class="keyword">DEFAULT</span> <span class="keyword">Value</span>] Inline_Constraint_Clause [Inline_Constraint_Clause ...] ]</span><br><span class="line">  ...</span><br><span class="line">  , Out_Of_Line_Constraint_Clause [, out_of_line_constraint_clause] ...</span><br><span class="line">  ) ;</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：ALTER-TABLE-修改约束"><a href="#知识点：ALTER-TABLE-修改约束" class="headerlink" title="知识点：ALTER TABLE 修改约束"></a>知识点：ALTER TABLE 修改约束</h3><ol>
<li><strong>添加约束</strong><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 添加列级约束</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> TableName MODIFY ( ColumnName [<span class="keyword">CONSTRAINT</span> Inline_Constraint_Clause [Inline_Constraint_Clause ...] ) ;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 添加表级约束</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> TableName <span class="keyword">ADD</span> Out_Of_Line_Constraint_Clause ;</span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 添加 NOT NULL 约束</span></span><br><span class="line">  <span class="keyword">ALTER</span> <span class="keyword">TABLE</span> TableName MODIFY ( ColumnName [<span class="keyword">CONSTRAINT</span> <span class="operator">&lt;</span>Constraint_Name<span class="operator">&gt;</span>] <span class="keyword">NOT</span> <span class="keyword">NULL</span> ) ;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 删除 NOT NULL 约束</span></span><br><span class="line">  <span class="keyword">ALTER</span> <span class="keyword">TABLE</span> TableName MODIFY ( ColumnName <span class="keyword">NULL</span> ) ;</span><br></pre></td></tr></table></figure></li>
<li><strong>删除约束</strong><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 删除约束</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> TableName <span class="keyword">DROP</span> <span class="keyword">CONSTRAINT</span> Constraint_Name [CASCADE] [ONLINE] ;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- CASCADE</span></span><br><span class="line"><span class="comment">-- 同时删除依赖此约束的其他外键约束</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- ONLINE</span></span><br><span class="line"><span class="comment">-- 允许在删除约束的行为结束前，执行 DML 操作</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 删除主键约束</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> TableName <span class="keyword">DROP</span> <span class="keyword">PRIMARY</span> KEY [CASCADE] [&#123;KEEP<span class="operator">|</span><span class="keyword">DROP</span>&#125; INDEX] [ONLINE] ;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 删除唯一约束</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> TableName <span class="keyword">DROP</span> <span class="keyword">UNIQUE</span> (Column_List) [CASCADE] [&#123;KEEP<span class="operator">|</span><span class="keyword">DROP</span>&#125; INDEX] [ONLINE] ;</span><br></pre></td></tr></table></figure></li>
<li><strong>重命名约束</strong><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 重命名约束</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> TableName RENAME <span class="keyword">CONSTRAINT</span> Old_Name <span class="keyword">TO</span> New_Name ;</span><br></pre></td></tr></table></figure></li>
<li><strong>启用和禁用约束</strong><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 启用约束</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> TableName ENABLE <span class="keyword">CONSTRAINT</span> Constraint_Name ;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 禁用约束</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> TableName DISABLE <span class="keyword">CONSTRAINT</span> Constraint_Name [CASCADE] ;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- CASCADE</span></span><br><span class="line"><span class="comment">-- 仅在 DISABLE PRIMARY KEY 和 UNIQUE 约束，并且是被其他外键所引用时，才可以使用，用于级联禁用相应的外键</span></span><br></pre></td></tr></table></figure></li>
<li><strong>修改约束的状态</strong><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 修改约束的启用禁用、生效失效、延迟检查/非延迟检查</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> TableName MODIFY <span class="keyword">CONSTRAINT</span> Constraint_Name Constraint_State [CASCADE] ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> TableName MODIFY <span class="keyword">PRIMARY</span> KEY Constraint_State [CASCADE] ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> TableName MODIFY <span class="keyword">UNIQUE</span> (Column_List) Constraint_State [CASCADE] ;</span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- Constraint_State</span></span><br><span class="line"><span class="comment">-- 普通约束</span></span><br><span class="line">[ENABLE<span class="operator">|</span>DISABLE] &#123;VALIDATE<span class="operator">|</span>NOVALIDATE&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 延迟约束</span></span><br><span class="line">INITIALLY &#123;IMMEDIATE<span class="operator">|</span>DEFERRED&#125; [ENABLE<span class="operator">|</span>DISABLE] [VALIDATE<span class="operator">|</span>NOVALIDATE]</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h2 id="5-5-回收站"><a href="#5-5-回收站" class="headerlink" title="5.5 回收站"></a>5.5 回收站</h2><hr>
<h3 id="知识点：回收站"><a href="#知识点：回收站" class="headerlink" title="知识点：回收站"></a>知识点：回收站</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">* 回收站 RECYCLE BIN</span><br><span class="line">  - 本质上是一个数据字典表</span><br><span class="line">  - 用来恢复被 DROP 掉的对象</span><br><span class="line">  - 对于 DROP 语句，如果没有加 PURGE，则本质上都只是将对象改名，并表示被移动到回收站中了</span><br><span class="line">  - 在 DROP 时，会连同对象的相关联的对象，如索引、约束等，一起放进回收站</span><br><span class="line"></span><br><span class="line">* 重命名的格式</span><br><span class="line">  - BIN$unique_id$version</span><br><span class="line">  - BIN       : 表示 RecycleBin</span><br><span class="line">  - unique_id : 数据库中该对象的唯一标志</span><br><span class="line">  - version   : 对象的版本号，26 个字符长度</span><br><span class="line"></span><br><span class="line">* 回收站的空间管理</span><br><span class="line">  - 回收站中的对象依然会占用空间，并占用用户的 QUOTA</span><br><span class="line">  - 回收站中的对象的 Extent 会被记录在 DBA_FREE_SPACE 中，但实际上是不可使用的</span><br><span class="line">  - 当表空间容量不足时，oracle 删除所有 RECYCLE BIN 中相应表空间上的对象以释放空间，之后再进行数据文件的 autoextend</span><br><span class="line"></span><br><span class="line">* 以下语句，不会将对象移动到回收站，而是直接删除</span><br><span class="line">  - SYS 用户 DROP SYS SCHEMA 的对象 : 会直接删除</span><br><span class="line">  - DROP TABLESPACE   : 会将 RecycleBin 中所有属于该 tablespace 的对象清除</span><br><span class="line">  - DROP USER         : 会将 RecycleBin 中所有属于该用户的对象清除</span><br><span class="line">  - DROP CLUSTER      : 会将 RecycleBin 中所有属于该 cluster 的成员对象清除</span><br><span class="line">  - DROP TYPE         : 会将 RecycleBin 中所有依赖该 type 的对象清除</span><br><span class="line"></span><br><span class="line">* 回收站的注意事项</span><br><span class="line">  - RECYCLE BIN 中的对象不能太多，否则会影响多表连接的效率</span><br></pre></td></tr></table></figure></li>
<li><strong>还原回收站中的对象</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">* FLASHBACK TABLE TO BEFORE DROP</span><br><span class="line">  - 从回收站中还原对象，并改回原始的名字</span><br><span class="line">  - 还原对象时，会连同一起还原表和表相关联的对象一起还原</span><br><span class="line"></span><br><span class="line">* 以下对象，会被连同恢复，但不会改为原来的名字</span><br><span class="line">  - 索引，触发器</span><br><span class="line">    - 表被恢复后，索引和触发器会被同时移出回收站，并且有效，但不会自动改名，仍然保持了在回收站中名字</span><br><span class="line">    - 需要用其他方式查询原有的名字</span><br><span class="line"></span><br><span class="line">* 以下对象，不会自动恢复</span><br><span class="line">  - bitmap 索引</span><br><span class="line">    - 删除后不会放到 RECYCLE BIN 中，需要用其他方式还原</span><br><span class="line">  - 存储过程</span><br><span class="line">    - 表被删除后会失效</span><br><span class="line">    - 表被恢复后不会被自动重新编译，需要手工重新编译</span><br></pre></td></tr></table></figure></li>
<li><strong>相关参数和数据字典</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">* RECYCLEBIN</span><br><span class="line">  - 参数，决定是否启用回收站功能</span><br><span class="line"></span><br><span class="line">* DBA_RECYCLEBIN    </span><br><span class="line">  - 记录 recycle bin 中的内容</span><br><span class="line"></span><br><span class="line">* RECYCLEBIN        </span><br><span class="line">  - 实际为 USER_RECYCLEBIN 的同义词</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：SHOW-RECYCLEBIN"><a href="#知识点：SHOW-RECYCLEBIN" class="headerlink" title="知识点：SHOW RECYCLEBIN"></a>知识点：SHOW RECYCLEBIN</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - sqlplus 指令</span><br><span class="line">  - 查看 RECYCLEBIN 中的内容</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：PURGE"><a href="#知识点：PURGE" class="headerlink" title="知识点：PURGE"></a>知识点：PURGE</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - sqlplus 指令</span><br><span class="line">  - 删除 recycle bin 中的表</span><br></pre></td></tr></table></figure></li>
<li><strong>格式</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">* PURGE RECYCLEBIN ;</span><br><span class="line"></span><br><span class="line">* PURGE TABLE table ;</span><br><span class="line"></span><br><span class="line">* PURGE INDEX index ;</span><br><span class="line"></span><br><span class="line">* PURGE TABLESPACE tablespace [USER user] ;</span><br><span class="line">  - 删除 recycle bin 中所有位于某个表空间并属于某个用户的对象</span><br><span class="line"></span><br><span class="line">* PURGE DBA_RECYCLEBIN ;</span><br><span class="line">  - 删除 recycle bin 中的所有用户的所有对象</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：FLASHBACK-TABLE-TO-BEFORE-DROP"><a href="#知识点：FLASHBACK-TABLE-TO-BEFORE-DROP" class="headerlink" title="知识点：FLASHBACK TABLE TO BEFORE DROP"></a>知识点：FLASHBACK TABLE TO BEFORE DROP</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 恢复 recycle bin 中的表到被删除前的状态</span><br></pre></td></tr></table></figure></li>
<li><strong>语法</strong><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">FLASHBACK <span class="keyword">TABLE</span> <span class="keyword">table</span> <span class="keyword">TO</span> BEFORE <span class="keyword">DROP</span> [RENAME <span class="keyword">TO</span> new_table_name] ;</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h1 id="Chapter06-数据库对象"><a href="#Chapter06-数据库对象" class="headerlink" title="Chapter06 数据库对象"></a>Chapter06 数据库对象</h1><hr>
<h2 id="6-1-数据库对象体系"><a href="#6-1-数据库对象体系" class="headerlink" title="6.1 数据库对象体系"></a>6.1 数据库对象体系</h2><hr>
<h3 id="知识点：方案-SCHEMA"><a href="#知识点：方案-SCHEMA" class="headerlink" title="知识点：方案 SCHEMA"></a>知识点：方案 SCHEMA</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 一个方案是一个用户之下所有对象的逻辑集合</span><br><span class="line">  - 一个方案之下的对象可能存储在不同的表空间上</span><br><span class="line">  - 方案为数据库用户所有，并且与该用户同名</span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 使用 ALTER SESSION 语句切换当前的 Schema</span></span><br><span class="line"><span class="keyword">ALTER</span> SESSION <span class="keyword">SET</span> <span class="built_in">CURRENT_SCHEMA</span><span class="operator">=</span>Schema ;</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：数据库对象"><a href="#知识点：数据库对象" class="headerlink" title="知识点：数据库对象"></a>知识点：数据库对象</h3><ol>
<li><strong>数据库对象分类</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">* 表</span><br><span class="line">  - 表是数据库最基础的存储结果，由很多行组成</span><br><span class="line">  - 数据库 90% 以上的对象是表、索引、视图</span><br><span class="line"></span><br><span class="line">* 索引</span><br><span class="line">  - 在表上构建的对象</span><br><span class="line">  - 用于提升查询的性能</span><br><span class="line"></span><br><span class="line">* 视图</span><br><span class="line">  - 数据的逻辑展示，数据可以来自多个表</span><br><span class="line"></span><br><span class="line">* 序列</span><br><span class="line">  - 生成数字值</span><br><span class="line"></span><br><span class="line">* 同义词</span><br><span class="line">  - 对原始对象创建的别名</span><br><span class="line"></span><br><span class="line">* 目录对象</span><br><span class="line">  - 用于表示 OS 目录位置</span><br><span class="line"></span><br><span class="line">* 触发器</span><br><span class="line"></span><br><span class="line">* 存储过程</span><br></pre></td></tr></table></figure></li>
<li><strong>对象的命名规则</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">* 长度</span><br><span class="line">  - 表名，1-30 个字符</span><br><span class="line">  - 库名，1-8 个字符</span><br><span class="line">  - dblink，不超过 128 个字符</span><br><span class="line"></span><br><span class="line">* 字符</span><br><span class="line">  - 首字符必须是字母</span><br><span class="line">  - 只能包含 A–Z, a–z, 0–9, _, $, #</span><br><span class="line">  - 字母不区分大小写</span><br><span class="line">  - 推荐使用下划线，不推荐使用井号和美元符号，可能会影响 shell 脚本</span><br><span class="line"></span><br><span class="line">* 限制</span><br><span class="line">  - 一个 schema 下不能有重名的对象</span><br><span class="line">  - 一个表中不可以有重名的列</span><br><span class="line">  - 不能是 ORACLE 的保留关键字</span><br><span class="line"></span><br><span class="line">* 双引号命名</span><br><span class="line">  - 使用双引号 quoted identifiers 引用标识符将名字包起来</span><br><span class="line">  - 使用双引号进行命名，则引用对象时也要使用双引号</span><br><span class="line">  - 使用双引号进行命名，区分大小写，可以使用 ORACLE 的保留关键字</span><br></pre></td></tr></table></figure></li>
<li><strong>相关字典</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">* SYS.OBJ$</span><br><span class="line">  - 对象的基表</span><br><span class="line"></span><br><span class="line">* DBA_OBJECTS</span><br><span class="line">  - 记录所有的对象</span><br><span class="line">  - object_id</span><br><span class="line">    - 对象的标识</span><br><span class="line">  - data_object_id</span><br><span class="line">    - 对象的段的标识</span><br><span class="line">    - 分配了段的对象才具有 data_object_id，其他为 null</span><br><span class="line">    - 初始情况下，object_id 和 data_object_id 相等</span><br><span class="line">    - 对象进行了操作如 alter table move 后，data_object_id 会变化，object_id 不变</span><br><span class="line"></span><br><span class="line">* DBA_DEPENDENCIES</span><br><span class="line">  - 记录数据库中对象之间的依赖关系</span><br><span class="line">  - 依赖关系是对象以上级别的，不包括外键关系</span><br><span class="line">    - 视图依赖哪张表</span><br><span class="line">    - 触发器依赖哪张表</span><br><span class="line">    - 函数依赖哪个过程</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：无效对象"><a href="#知识点：无效对象" class="headerlink" title="知识点：无效对象"></a>知识点：无效对象</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 不可用的索引或 PL/SQL 程序</span><br><span class="line">  - 无效对象会严重影响数据库性能</span><br><span class="line"></span><br><span class="line">* 处理无效对象</span><br><span class="line">  - ORACLE_HOME/rdbms/admin/utlrp.sql，自动检查和处理无效对象</span><br><span class="line">  - 手动对无效索引进行重建</span><br><span class="line">  - 手动修改 plsql 程序的源码并重编译</span><br><span class="line">  - 手动重建视图</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h2 id="6-2-索引"><a href="#6-2-索引" class="headerlink" title="6.2 索引"></a>6.2 索引</h2><hr>
<h3 id="知识点：索引"><a href="#知识点：索引" class="headerlink" title="知识点：索引"></a>知识点：索引</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">* 索引 Index</span><br><span class="line">  - 索引的主要目的是加速查询，减少查询消耗的磁盘 I/O</span><br><span class="line"></span><br><span class="line">* 索引的内容</span><br><span class="line">  - 索引本质上是一个字典</span><br><span class="line">  - key 是数据</span><br><span class="line">  - value 是一个列表，内有所有包含此数据的行的 ROWID 值</span><br><span class="line"></span><br><span class="line">* 基于函数的索引 Function-based indexes</span><br><span class="line">  - key 是函数运算/表达式的结果</span><br><span class="line">  - 在查询时，必须要在 WHERE 上使用完全相同的函数运算/表达式，才会走索引</span><br><span class="line">  - 其他情况，则不会走索引</span><br><span class="line"></span><br><span class="line">* PRIMARY KEY 约束和 UNIQUE 约束会自动创建索引</span><br><span class="line">  - Oracle 会自动给 Index 起名</span><br><span class="line">  - 如果 Constraint 没有起名，则 Oracle 会给 Index 和 Constraint 起相同的名字</span><br><span class="line">  - 索引被约束所绑定，则不能在未删除约束的情况下就删除索引</span><br><span class="line"></span><br><span class="line">* 索引的缺点</span><br><span class="line">  - 索引会减慢增删改，增加增删改所消耗的磁盘 I/O</span><br><span class="line">  - 索引会占用额外的空间，会增加额外的维护负担</span><br><span class="line"></span><br><span class="line">* 索引的适用情况</span><br><span class="line">  - 适合创建索引的情况</span><br><span class="line">    - 列的唯一值比较多</span><br><span class="line">    - 列包含大量空值</span><br><span class="line">    - 在 WHERE 子句或联结条件中频繁的列</span><br><span class="line">    - 表相当大，而且返回行行数不到总行数的 2% 到 4%</span><br><span class="line">  - 不适合创建索引的情况</span><br><span class="line">    - 表比较小</span><br><span class="line">    - 不是经常放在 WHERE 中的 column</span><br><span class="line">    - 预计多数查询检索的行要超过表中总行数的 2% 到 4%</span><br><span class="line">    - 表更新比较频繁</span><br><span class="line">    - 列常被作为表达式的一部分进行计算</span><br></pre></td></tr></table></figure></li>
<li><strong>索引的属性</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">* 索引的状态</span><br><span class="line">  - unusable</span><br><span class="line">    - 索引处于未创建段的状态</span><br><span class="line">    - REBUILD 后索引恢复正常</span><br><span class="line"></span><br><span class="line">* 索引无效</span><br><span class="line">  - 表移动后，会使表上的索引无效</span><br><span class="line">  - 当索引无效，则不能对表进行 INSERT，需要重建索引后才能恢复正常</span><br><span class="line"></span><br><span class="line">* 可见索引和隐藏索引</span><br><span class="line">  - 可见索引 VISIBLE</span><br><span class="line">  - 隐藏索引 INVISIBLE</span><br><span class="line">    - 在 DML 时会正常维护索引</span><br><span class="line">    - 在 SELECT 时不会使用索引</span><br><span class="line">    - 参数 OPTIMIZER_USE_INVISIBLE_INDEXES 可以设定优化器使用隐藏索引</span><br><span class="line"></span><br><span class="line">* 组合索引</span><br><span class="line">  - 一个索引引用多个列</span><br><span class="line">  - 创建组合索引，列的先后顺序需要考虑</span><br><span class="line">    - 唯一值少的列放在前面</span><br><span class="line">    - 唯一值多的列放在后面</span><br></pre></td></tr></table></figure></li>
<li><strong>索引的种类</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">* B-tree 索引</span><br><span class="line">  - ORACLE 默认的索引类型</span><br><span class="line"></span><br><span class="line">* 唯一索引 UNIQUE INDEX</span><br><span class="line">  - 要求列中的数据不能重复</span><br><span class="line">  - 唯一索引可以转换为非唯一索引</span><br><span class="line"></span><br><span class="line">* 位图索引 BITMAP INDEX</span><br><span class="line">  - BITMAP 索引，适合列中唯一值少的列</span><br><span class="line">  - 适合数据挖掘场景</span><br><span class="line">  - 适合数据仓库场景</span><br><span class="line">  - BITMAP 索引会严重影响 DML 操作</span><br><span class="line"></span><br><span class="line">* 反转索引 REVERSE INDEX</span><br><span class="line">  - 用来解决热点块</span><br><span class="line">  - 在单实例环境用的少，在 RAC 环境用的多</span><br><span class="line"></span><br><span class="line">* 降序索引 DESCEDING INDEX</span><br><span class="line">  - 实际是使用基于函数的索引</span><br><span class="line">  - 字符型的列，在索引中储存时按照降序进行储存</span><br><span class="line">  - 降序索引本质上是一个基于函数的索引</span><br></pre></td></tr></table></figure></li>
<li><strong>相关参数和数据字典</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">* OPTIMIZER_USE_INVISIBLE_INDEXES</span><br><span class="line">  - 指定优化器使用隐藏索引</span><br><span class="line"></span><br><span class="line">* DBA_INDEXES</span><br><span class="line">  - 记录所有的索引</span><br><span class="line"></span><br><span class="line">* DBA_IND_COLUMNS</span><br><span class="line">  - 记录索引和其定位的列</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：CREATE-INDEX"><a href="#知识点：CREATE-INDEX" class="headerlink" title="知识点：CREATE INDEX"></a>知识点：CREATE INDEX</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 创建索引</span><br><span class="line"></span><br><span class="line">* 需要的权限</span><br><span class="line">  - CREATE INDEXTYPE 系统权限</span><br></pre></td></tr></table></figure></li>
<li><strong>语法</strong><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 创建索引</span></span><br><span class="line"><span class="keyword">CREATE</span> [<span class="keyword">UNIQUE</span> <span class="operator">|</span> BITMAP] INDEX IndexName <span class="keyword">ON</span> TableName ( ColumnName ) ;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 创建基于函数的索引</span></span><br><span class="line"><span class="keyword">CREATE</span> INDEX IndexName <span class="keyword">ON</span> TableName ( Expression ) ;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 创建组合索引</span></span><br><span class="line"><span class="keyword">CREATE</span> [<span class="keyword">UNIQUE</span> <span class="operator">|</span> BITMAP] INDEX IndexName <span class="keyword">ON</span> TableName ( Column_List ) ;</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：ALTER-INDEX"><a href="#知识点：ALTER-INDEX" class="headerlink" title="知识点：ALTER INDEX"></a>知识点：ALTER INDEX</h3><ol>
<li><strong>介绍</strong><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 重建索引</span></span><br><span class="line"><span class="keyword">ALTER</span> INDEX IndexName REBUILD [TABLESPACE Tablespace ] ;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 清空索引占用的空间</span></span><br><span class="line"><span class="keyword">ALTER</span> INDEX IndexName UNUSABLE ;</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：DROP-INDEX"><a href="#知识点：DROP-INDEX" class="headerlink" title="知识点：DROP INDEX"></a>知识点：DROP INDEX</h3><ol>
<li><strong>介绍</strong><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 删除索引</span></span><br><span class="line"><span class="keyword">DROP</span> INDEX IndexName [ONLINE] ;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- ONLINE</span></span><br><span class="line"><span class="comment">-- 在删除索引时允许执行 DML</span></span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h2 id="6-3-视图"><a href="#6-3-视图" class="headerlink" title="6.3 视图"></a>6.3 视图</h2><hr>
<h3 id="知识点：视图"><a href="#知识点：视图" class="headerlink" title="知识点：视图"></a>知识点：视图</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 视图 view，是展现数据的一个窗口，功能上相当于一个 SELECT 语句的别名</span><br><span class="line">  - 视图所基于的表称为基表 base table，基表可以是表，也可以是其他视图</span><br><span class="line">  - 视图没有 ALTER 语句，如果要修改视图直接重建视图</span><br><span class="line"></span><br><span class="line">* 视图的特点</span><br><span class="line">  - 视图不储存数据，数据仍然储存在表中，视图本质上是存储在数据字典中的一个 SELECT 语句</span><br><span class="line">  - 视图的子查询不能使用 ORDER BY</span><br><span class="line">  - 可以通过视图对表中的数据进行增删改查，但不是所有的视图都具有此功能</span><br><span class="line"></span><br><span class="line">* 视图的优点</span><br><span class="line">  - 限制数据的访问</span><br><span class="line">  - 简化复杂的查询</span><br><span class="line">  - 提供数据独立性</span><br><span class="line">  - 提供不同的逻辑表</span><br><span class="line">  - 为不同的用户提供不同的视图，进而实现不同的访问权限</span><br><span class="line"></span><br><span class="line">* 不推荐通过视图来进行 DML 增删改</span><br><span class="line">  - 只有简单视图可以支持 DML 增删改基表数据</span><br><span class="line">  - 视图的 SELECT 语句包括下情况之一，都会影响通过视图来对基表进行增删改</span><br><span class="line">    - GROUP BY 子句</span><br><span class="line">    - DISTINCT 关键字</span><br><span class="line">    - ROWNUM 伪列</span><br><span class="line">    - 函数、表达式</span><br><span class="line">    - NOT NULL 的列没有在视图中</span><br></pre></td></tr></table></figure></li>
<li><strong>视图的分类</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">* 简单视图 Simple View</span><br><span class="line">  - 只有一个基表</span><br><span class="line">  - 不包含函数</span><br><span class="line">  - 不包含 GROUP BY</span><br><span class="line">  - 对于简单视图，可以通过该视图执行 DML 修改底层数据</span><br><span class="line"></span><br><span class="line">* 复杂视图 Complex View</span><br><span class="line">  - 一个基表，或多个基表的连接，或 UNION</span><br><span class="line">  - 包含函数</span><br><span class="line">  - 包含 group by</span><br><span class="line">  - 大多数情况下，不可以通过视图执行 DML 修改数据</span><br></pre></td></tr></table></figure></li>
<li><strong>相关字典</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">* DBA_VIEWS</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：CREATE-VIEW"><a href="#知识点：CREATE-VIEW" class="headerlink" title="知识点：CREATE VIEW"></a>知识点：CREATE VIEW</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">* 创建视图所需要的权限</span><br><span class="line">  - CREATE VIEW 系统权限</span><br></pre></td></tr></table></figure></li>
<li><strong>语法</strong><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> [<span class="keyword">OR</span> REPLACE] [FORCE<span class="operator">|</span>NOFORCE] <span class="keyword">VIEW</span> ViewName [( Column_Alias_List )]</span><br><span class="line">  <span class="keyword">AS</span> Sub_Query</span><br><span class="line">  [<span class="keyword">WITH</span> <span class="keyword">CHECK</span> OPTION [<span class="keyword">CONSTRAINT</span> Constranint_Name]]</span><br><span class="line">  [<span class="keyword">WITH</span> READ <span class="keyword">ONLY</span> [<span class="keyword">CONSTRAINT</span> Constranint_Name]]</span><br><span class="line">  ;</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">* OR REPLACE</span><br><span class="line">  - 如果该视图已经存在则重新创建它</span><br><span class="line">  - 重新创建视图不用担心数据丢失</span><br><span class="line"></span><br><span class="line">* FORCE|NOFORCE</span><br><span class="line">  - FORCE，不管基表是否存在都创建视图</span><br><span class="line">  - NOFORCE，仅当基表存在时才创建视，默认设定</span><br><span class="line"></span><br><span class="line">* Column_Alias_List</span><br><span class="line">  - 为视图的每一列指定一个列名</span><br><span class="line">  - 列名的数量必须与子查询的列的数量相同</span><br><span class="line">  - 省略的话，则直接使用子查询的列名</span><br><span class="line">  - 如果子查询的 Column_Name 是表达式或函数，则 ORACLE 会强制要求添加 Column_Alias_List</span><br><span class="line"></span><br><span class="line">* Sub_Query</span><br><span class="line">  - 视图所代表的查询</span><br><span class="line"></span><br><span class="line">* WITH CHECK OPTION</span><br><span class="line">  - 当通过视图来对基表进行 DML 时，只处理属于视图范围内的行</span><br><span class="line">  - INSERT，插入的行在插入后必须可以被视图搜索到</span><br><span class="line">  - UPDATE，更新的行必须已经在视图范围内，并且此行在更新后应该还在视图范围内</span><br><span class="line">  - DELETE，删除的行必须是视图范围内的行</span><br><span class="line"></span><br><span class="line">* WITH READ ONLY</span><br><span class="line">  - 完全禁止通过视图来对基表执行增删改</span><br><span class="line"></span><br><span class="line">* CONSTRAINT Constraint_Name</span><br><span class="line">  - 为对应的 WITH CHECK OPTION 或 WITH READ ONLY 约束起一个名字</span><br><span class="line">  - WITH CHECK OPTION 和 WITH READ ONLY 都是通过约束来实现的，也会被记录到 DBA_CONSTRAINTS 数据字典中</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：DROP-VIEW"><a href="#知识点：DROP-VIEW" class="headerlink" title="知识点：DROP VIEW"></a>知识点：DROP VIEW</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">* 删除视图需要的权限</span><br><span class="line">  - owner</span><br><span class="line">  - DROP ANY VIEW 系统权限</span><br></pre></td></tr></table></figure></li>
<li><strong>语法</strong><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">VIEW</span> ViewName [CASCADE CONSTRAINTS] ;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- CASCADE CONSTRAINTS</span></span><br><span class="line"><span class="comment">-- 顺便删除引用此视图的外键</span></span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h2 id="6-4-序列"><a href="#6-4-序列" class="headerlink" title="6.4 序列"></a>6.4 序列</h2><hr>
<h3 id="知识点：序列"><a href="#知识点：序列" class="headerlink" title="知识点：序列"></a>知识点：序列</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 序列 Sequence，用于生成顺序连续的数列，通常用来创建主键</span><br><span class="line"></span><br><span class="line">* 序列本质上是一段无记忆的代码</span><br><span class="line">  - 序列号是在使用时才生成，不是一开始就生成好并储存</span><br><span class="line">  - 序列不会记忆任何序列号，序列号由各个 session 自己储存</span><br><span class="line">  - 如果要重新开始序列，或者重新发出已经生成的数字，必须先删除序列再创建</span><br><span class="line"></span><br><span class="line">* 序列的默认初始值、终止值、最大值、最小值</span><br><span class="line">  - 步长为正数，则为递增序列</span><br><span class="line">    - 默认初始值为 1</span><br><span class="line">    - 默认终止值为 10^27</span><br><span class="line">    - 默认最小值为 1</span><br><span class="line">    - 默认最大值为 10^27</span><br><span class="line">  - 步长为负数，则为递减序列</span><br><span class="line">    - 默认初始值为 -1</span><br><span class="line">    - 默认终止值为 -10^26</span><br><span class="line">    - 默认最小值为 -10^26</span><br><span class="line">    - 默认最大值为 -1</span><br><span class="line">  - 如果指定了最大值或最小值，则初始值和终止值也会相应的改变</span><br><span class="line"></span><br><span class="line">* 序列的使用</span><br><span class="line">  - Sequence.NEXTVAL</span><br><span class="line">  - Sequence.CURRVAL</span><br><span class="line">  - 一个 session，必须已经被分配了一个 NEXTVAL 后，才能使用 CURRVAL</span><br><span class="line"></span><br><span class="line">* 序列号断裂的情况</span><br><span class="line">  - rollback</span><br><span class="line">  - 系统崩溃</span><br><span class="line">  - global 序列被其他 session 所使用</span><br></pre></td></tr></table></figure></li>
<li><strong>相关字典</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">* DBA_SEQUENCES</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：序列的性质"><a href="#知识点：序列的性质" class="headerlink" title="知识点：序列的性质"></a>知识点：序列的性质</h3><ol>
<li><strong>GLOBAL 和 SESSION</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">* GLOBAL 序列</span><br><span class="line">  - 序列的使用是全局同步的，不同的 Session 之间对序列的使用会相互影响</span><br><span class="line">  - Session A 如果使用 Sequence_X 得到了序列号 n，则 Session B 再使用 Sequence_X 将无法得到序列号 n</span><br><span class="line">  - GLOBAL 序列是默认选项</span><br><span class="line"></span><br><span class="line">* SESSION 序列</span><br><span class="line">  - 序列的使用是各个 Session 独立的，相互之间不会产生影响</span><br><span class="line">  - Session A 使用 Sequence_X 得到的序列号和 Session B 使用 Sequence_X 得到的序列号互相不影响</span><br></pre></td></tr></table></figure></li>
<li><strong>CACHE 和 NOCACHE</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">* CACHE</span><br><span class="line">  - 提前生成一批序列号并缓存到内存中</span><br><span class="line">  - 可以提高性能</span><br><span class="line">  - 如果系统发生崩溃，则已经缓存还未使用的序列号会丢失，则序列号会发生断裂</span><br><span class="line">  - 默认 ORACLE 会 CACHE 20</span><br><span class="line"></span><br><span class="line">* NOCACHE</span><br><span class="line">  - 序列号只有在被使用时才会生成</span><br></pre></td></tr></table></figure></li>
<li><strong>CYCLE 和 NOCYCLE</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">* CYCLE</span><br><span class="line">  - 序列号循环使用</span><br><span class="line">  - 当序列号超出了终止值，则会重新取用初始值并重新开始生成序列号</span><br><span class="line">  - 循环需要注意，生成的序列号的个数要大于 CACHE 的容量</span><br><span class="line"></span><br><span class="line">* NOCYCLE</span><br><span class="line">  - 不循环</span><br><span class="line">  - 超出了终止值，就会报错</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：热点块问题"><a href="#知识点：热点块问题" class="headerlink" title="知识点：热点块问题"></a>知识点：热点块问题</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">* 热点块问题</span><br><span class="line">  - 应用集中访问某一个数据块</span><br><span class="line">  - 如果访问涉及 DML 操作，则会产生大量的锁和等待</span><br><span class="line"></span><br><span class="line">* 解决方法</span><br><span class="line">  - 将数据行分散储存</span><br><span class="line">  - 方法是在使用序列时步长不设置为 1 而是其他值</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：CREATE-SEQUENCE"><a href="#知识点：CREATE-SEQUENCE" class="headerlink" title="知识点：CREATE SEQUENCE"></a>知识点：CREATE SEQUENCE</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">* CREATE SEQUENCE 需要的权限</span><br><span class="line">  - CREATE SEQUENCE 系统权限</span><br></pre></td></tr></table></figure></li>
<li><strong>语法</strong><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> SEQUENCE SequenceName</span><br><span class="line">  [INCREMENT <span class="keyword">BY</span> Number]</span><br><span class="line">  [<span class="keyword">START</span> <span class="keyword">WITH</span> Number]</span><br><span class="line">  [MAXVALUE Number <span class="operator">|</span> NOMAXVALUE]</span><br><span class="line">  [MINVALUE Number <span class="operator">|</span> NOMINVALUE]</span><br><span class="line">  [<span class="keyword">CYCLE</span> <span class="operator">|</span> NOCYCLE]</span><br><span class="line">  [CACHE Number <span class="operator">|</span> NOCACHE]</span><br><span class="line">  [<span class="keyword">GLOBAL</span> <span class="operator">|</span> SESSION]</span><br><span class="line">  ;</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">* INCREMENT BY Number</span><br><span class="line">  - 指定步长</span><br><span class="line"></span><br><span class="line">* START WITH Number</span><br><span class="line">  - 指定初始值</span><br><span class="line"></span><br><span class="line">* MAXVALUE Number | NOMAXVALUE</span><br><span class="line">  - 指定最大值</span><br><span class="line"></span><br><span class="line">* MINVALUE Number | NOMINVALUE</span><br><span class="line">  - 指定最小值</span><br><span class="line"></span><br><span class="line">* CYCLE | NOCYCLE</span><br><span class="line">  - 指定是否循环</span><br><span class="line"></span><br><span class="line">* CACHE Number | NOCACHE</span><br><span class="line">  - 指定是否缓存</span><br><span class="line"></span><br><span class="line">* GLOBAL | SESSION</span><br><span class="line">  - 指定是 GLOBAL 序列还是 SESSION 序列</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：ALTER-SEQUENCE"><a href="#知识点：ALTER-SEQUENCE" class="headerlink" title="知识点：ALTER SEQUENCE"></a>知识点：ALTER SEQUENCE</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - ALTER SEQUENCE 只会影响后续的序列号，不会影响已经生成的数字</span><br><span class="line">  - ALTER SEQUENCE 不能修改 START WITH</span><br></pre></td></tr></table></figure></li>
<li><strong>语法</strong><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> SEQUENCE SequenceName</span><br><span class="line">  [INCREMENT <span class="keyword">BY</span> Number]</span><br><span class="line">  [MAXVALUE Number <span class="operator">|</span> NOMAXVALUE]</span><br><span class="line">  [MINVALUE Number <span class="operator">|</span> NOMINVALUE]</span><br><span class="line">  [<span class="keyword">CYCLE</span> <span class="operator">|</span> NOCYCLE]</span><br><span class="line">  [CACHE Number <span class="operator">|</span> NOCACHE]</span><br><span class="line">  [<span class="keyword">GLOBAL</span> <span class="operator">|</span> SESSION]</span><br><span class="line">  ;</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：DROP-SEQUENCE"><a href="#知识点：DROP-SEQUENCE" class="headerlink" title="知识点：DROP SEQUENCE"></a>知识点：DROP SEQUENCE</h3><ol>
<li><strong>语法</strong><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> SEQUENCE SequenceName ;</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h2 id="6-5-其他类型对象"><a href="#6-5-其他类型对象" class="headerlink" title="6.5 其他类型对象"></a>6.5 其他类型对象</h2><hr>
<h3 id="知识点：同义词-Synonym"><a href="#知识点：同义词-Synonym" class="headerlink" title="知识点：同义词 Synonym"></a>知识点：同义词 Synonym</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 同义词，相当于对象的别名，是对特点对象的代号</span><br><span class="line">  - 同义词可以指向任何对象，包括其他用户的对象</span><br><span class="line">  - 同义词可以指向程序包，但不能指向程序包的子程序，如过程或函数</span><br><span class="line"></span><br><span class="line">* 同义词的权限</span><br><span class="line">  - 同义词没有自己的权限</span><br><span class="line">  - 同义词的权限完全取决于所指向的对象的权限</span><br><span class="line"></span><br><span class="line">* 同义词的删除</span><br><span class="line">  - 同义词不会被自动删除，不会被关联删除</span><br><span class="line">  - DROP TABLE 删除同义词</span><br></pre></td></tr></table></figure></li>
<li><strong>同义词的分类</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">* 私有同义词</span><br><span class="line">  - 用户创建</span><br><span class="line">  - 仅用户自己可以访问</span><br><span class="line"></span><br><span class="line">* 公有同义词</span><br><span class="line">  - 只有 DBA 可以创建和删除</span><br><span class="line">  - 所有用户都可以访问</span><br><span class="line">  - 公有同义词的 OWNER 为 PUBLIC</span><br></pre></td></tr></table></figure></li>
<li><strong>相关字典</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">* DBA_SYNONYMS</span><br><span class="line">  - 记录所有的同义词</span><br></pre></td></tr></table></figure></li>
<li><strong>同义词 DDL</strong><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- CREATE SYNONYM 语法：</span></span><br><span class="line"><span class="keyword">CREATE</span> [PUBLIC] SYNONYM Synonym <span class="keyword">FOR</span> Object ;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 需要的权限：</span></span><br><span class="line"><span class="comment">-- CREATE SYNONYM        系统权限，创建私有同义词</span></span><br><span class="line"><span class="comment">-- CREATE PUBLIC SYNONYM 系统权限，创建公有同义词</span></span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- DROP SYNONYM 语法:</span></span><br><span class="line"><span class="keyword">DROP</span> [PUBLIC] SYNONYM Synonym ;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 需要的权限：OWNER</span></span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：目录对象-Directory"><a href="#知识点：目录对象-Directory" class="headerlink" title="知识点：目录对象 Directory"></a>知识点：目录对象 Directory</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 目录对象，Oracle 特有，用来指代 OS 上的 Dir，亦或者 ASM 上的位置</span><br><span class="line">  - 通过对目录对象的操作，使数据库可以读写 OS 或 ASM 上的文件</span><br></pre></td></tr></table></figure></li>
<li><strong>相关的权限</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">* 相关的系统权限</span><br><span class="line">  - CREATE ANY DIRECTORY  ，允许创建目录对象</span><br><span class="line">  - DROP ANY DIRECTORY    ，允许删除目录对象</span><br><span class="line"></span><br><span class="line">* 相关的对象权限</span><br><span class="line">  - READ ON DIRECTORY     ，读取目录中的文件</span><br><span class="line">  - WRITE ON DIRECTORY    ，写入目录中的文件</span><br><span class="line">  - EXECUTE ON DIRECTORY  ，执行</span><br></pre></td></tr></table></figure></li>
<li><strong>相关字典</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">* DBA_DIRECTORIES</span><br><span class="line">  - 记录所有的目录对象</span><br></pre></td></tr></table></figure></li>
<li><strong>目录对象 DDL</strong><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- CREATE DIRECTORY 语法：</span></span><br><span class="line"><span class="keyword">CREATE</span> [<span class="keyword">OR</span> REPLACE] DIRECTORY Directory <span class="keyword">AS</span> <span class="string">&#x27;Dir_Path&#x27;</span> ;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- Dir_Path</span></span><br><span class="line"><span class="comment">-- 开头不能有空格</span></span><br><span class="line"><span class="comment">-- 结尾不能有斜杠</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 范例：</span></span><br><span class="line"><span class="comment">-- 创建目录对象，指向 OS 文件目录</span></span><br><span class="line"><span class="keyword">CREATE</span> DIRECTORY dir <span class="keyword">AS</span> <span class="string">&#x27;/u01/app/oracle/oradata/pdb1&#x27;</span> ;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 创建目录对象，指向 ASM 目录</span></span><br><span class="line"><span class="keyword">CREATE</span> DIRECTORY dir <span class="keyword">AS</span> <span class="string">&#x27;+DATA/HELLODB/DATAFILE&#x27;</span> ;</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h1 id="Chapter07-数据类型"><a href="#Chapter07-数据类型" class="headerlink" title="Chapter07 数据类型"></a>Chapter07 数据类型</h1><hr>
<h2 id="7-1-数据类型介绍"><a href="#7-1-数据类型介绍" class="headerlink" title="7.1 数据类型介绍"></a>7.1 数据类型介绍</h2><hr>
<h3 id="知识点：字面量-Literal"><a href="#知识点：字面量-Literal" class="headerlink" title="知识点：字面量 Literal"></a>知识点：字面量 Literal</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">* 单引号 single quotation marks</span><br><span class="line">  - 使用两个连续的单引号表示一个单引号字面量</span><br><span class="line">  - 如：SELECT &#x27;James&#x27;&#x27;s work&#x27; FROM DUAL ;</span><br><span class="line"></span><br><span class="line">* 字符型和日期型</span><br><span class="line">  - 字符型和日期型的字面量，都要使用单引号</span><br><span class="line">  - 字符型区分大小写</span><br><span class="line">  - 日期型区分格式，默认日期格式，DD-MON-RR</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：替换引用符"><a href="#知识点：替换引用符" class="headerlink" title="知识点：替换引用符"></a>知识点：替换引用符</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 替换引用符 Alternative Quote Operator (q)</span><br><span class="line">  - 作用，对字符型的字面量，更换所使用的标记界定符</span><br><span class="line">  - 允许使用任意字符</span><br><span class="line">    - 可以是任意单字符，单字节或双字节</span><br><span class="line">    - 可以是任意成对字符，如 [ ]，&#123; &#125;，( )，&lt; &gt;</span><br><span class="line">  - 优点</span><br><span class="line">    - 可以增加字符型字面量的可读性</span><br><span class="line">    - 可以跳脱字符型字面量中单引号字符的情况</span><br><span class="line"></span><br><span class="line">* 使用方式，加 q</span><br><span class="line">  - Example: q&#x27;\ Department&#x27;s Manager Id: \&#x27;</span><br><span class="line">  - Example: q&#x27;&lt; Department&#x27;s Manager Id: &gt;&#x27;</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：隐式转换和显式转换"><a href="#知识点：隐式转换和显式转换" class="headerlink" title="知识点：隐式转换和显式转换"></a>知识点：隐式转换和显式转换</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">* 隐式转换 Implicit Data Type Conversion</span><br><span class="line">  - 在进行比较或计算时，如果两个值的类型不同，Oracle 会自动进行类型的转换</span><br><span class="line">  - 包含一个类型转换为另一个类型、同一个类型之间精度和小数位的转换</span><br><span class="line">  - 转换时，字面量要符合相应的格式化模型参数，或符合模糊识别的规则</span><br><span class="line"></span><br><span class="line">* 显式转换 Explicit Data Conversion</span><br><span class="line">  - 使用类型转换函数，如 to_char、to_number 等，在语句层指明类型转换</span><br><span class="line"></span><br><span class="line">* 更推荐使用显式转换</span><br><span class="line">  - 显式转换的 SQL 语句语义更清晰、更易理解</span><br><span class="line">  - 连续的隐式转换会影响性能</span><br><span class="line">  - 隐式转换需要其他影响因素，如参数、数据库版本，在不同的场景，同样的 SQL 语句的执行结果会不同</span><br><span class="line">  - 隐式转换可能造成不走索引</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h2 id="7-2-数值型"><a href="#7-2-数值型" class="headerlink" title="7.2 数值型"></a>7.2 数值型</h2><hr>
<h3 id="知识点：NUMBER-型"><a href="#知识点：NUMBER-型" class="headerlink" title="知识点：NUMBER 型"></a>知识点：NUMBER 型</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 数值型数据</span><br><span class="line">  - 如果不指定 p、s，则为浮点数 floating-point</span><br><span class="line">  - 如果指定 p、s，则为定点数 fixed-point</span><br></pre></td></tr></table></figure></li>
<li><strong>格式</strong><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">NUMBER(p,s)</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">* p</span><br><span class="line">  - 精度 precision</span><br><span class="line">  - 表示 number 的有效数字的最大位数 the maximum number of significant decimal digits</span><br><span class="line"></span><br><span class="line">* s</span><br><span class="line">  - 准度 scale</span><br><span class="line">  - 表示 number 中，小数的位数</span><br><span class="line">  - 准度可以为负</span><br><span class="line">  - 准度不能大于精度</span><br></pre></td></tr></table></figure></li>
<li><strong>范例</strong><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> test ( a NUMBER ) ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> test ( a NUMBER(<span class="number">10</span>,<span class="number">2</span>) ) ;</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：TO-NUMBER-函数"><a href="#知识点：TO-NUMBER-函数" class="headerlink" title="知识点：TO_NUMBER 函数"></a>知识点：TO_NUMBER 函数</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">* 作用</span><br><span class="line">  - 将 Expression 转换为 NUMBER 型</span><br></pre></td></tr></table></figure></li>
<li><strong>格式</strong><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">TO_NUMBER( Expression [ <span class="keyword">DEFAULT</span> Return_Value <span class="keyword">ON</span> CONVERSION ERROR ] [, Format [, <span class="string">&#x27;Nls_Parameter&#x27;</span> ] ])</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">* Expression</span><br><span class="line">  - 可以是字符型，如 CHAR、VARCHAR2、NCHAR、NVARCHAR2</span><br><span class="line">  - 可以是数值型，如 NUMBER、BINARY_FLOAT、BINARY_DOUBLE，此时返回 Expression 的结果</span><br><span class="line">  - 可以是 NULL，此时返回 NULL</span><br><span class="line"></span><br><span class="line">* Format</span><br><span class="line">  - 指定格式化模型</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h2 id="7-3-字符型"><a href="#7-3-字符型" class="headerlink" title="7.3 字符型"></a>7.3 字符型</h2><hr>
<h3 id="知识点：VARCHAR2-型"><a href="#知识点：VARCHAR2-型" class="headerlink" title="知识点：VARCHAR2 型"></a>知识点：VARCHAR2 型</h3><ol>
<li><strong>VARCHAR2 型</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">* VARCHAR2 型</span><br><span class="line">  - 变长字符型</span><br><span class="line">  - 最大容量为 4000 个字节，最大字符数取决于数据库使用的字符集</span><br><span class="line">  - 在 CREATE TABLE 时必须同时指定 VARCHAR2 的容量</span><br><span class="line"></span><br><span class="line">* NVARCHAR2</span><br><span class="line">  - 与 VARCHAR2 大体相同，不过使用的是 national character set</span><br></pre></td></tr></table></figure></li>
<li><strong>格式</strong><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">VARCHAR2(Size [BYTE<span class="operator">|</span><span class="type">CHAR</span>])</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-- 范例</span><br><span class="line">CREATE TABLE test (a VARCHAR2(100));</span><br></pre></td></tr></table></figure></li>
<li><strong>相关参数</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">* MAX_STRING_SIZE</span><br><span class="line">  - 修改 VARCHAR2 的最大字节数</span><br><span class="line">  - STANDARD，表示 VARCHAR2 支持最大 4000 个字节，默认形式</span><br><span class="line">  - EXTENDED，表示 VARCHAR2 支持最大 32767 字节</span><br><span class="line">  - 需要配合 rdbms/admin/utlrp.sql 一起使用</span><br><span class="line">  - 不推荐修改，否则迁移数据会很麻烦，如果一定要储存长字符串可以考虑 LOB 型</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：CHAR-型"><a href="#知识点：CHAR-型" class="headerlink" title="知识点：CHAR 型"></a>知识点：CHAR 型</h3><ol>
<li><strong>CHAR 型</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 定长度字符型</span><br><span class="line">  - 当数据不足时，自动在末尾追加 space</span><br><span class="line">  - 最大 2000 字节</span><br><span class="line"></span><br><span class="line">* NCHAR 型</span><br><span class="line">  - 与 CHAR 大体相同，不过使用的是 national character set</span><br></pre></td></tr></table></figure></li>
<li><strong>格式</strong><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">CHAR</span>(Size [BYTE<span class="operator">|</span><span class="type">CHAR</span>])</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-- 范例</span><br><span class="line">CREATE TABLE test (a CHAR(100));</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：TO-CHAR-函数"><a href="#知识点：TO-CHAR-函数" class="headerlink" title="知识点：TO_CHAR 函数"></a>知识点：TO_CHAR 函数</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 将其他类型的数据转换为 VARCHAR2 型</span><br></pre></td></tr></table></figure></li>
<li><strong>格式</strong><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">TO_CHAR(Number [, Format [, <span class="string">&#x27;Nls_Parameter&#x27;</span> ] ])</span><br><span class="line"></span><br><span class="line">TO_CHAR(Datetime [, Format [, <span class="string">&#x27;Nls_Parameter&#x27;</span> ] ])</span><br><span class="line"></span><br><span class="line">TO_CHAR(<span class="type">Interval</span> [, Format [, <span class="string">&#x27;Nls_Parameter&#x27;</span> ] ])</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h2 id="7-4-日期时间型"><a href="#7-4-日期时间型" class="headerlink" title="7.4 日期时间型"></a>7.4 日期时间型</h2><hr>
<h3 id="知识点：DATE-型"><a href="#知识点：DATE-型" class="headerlink" title="知识点：DATE 型"></a>知识点：DATE 型</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 日期型数据</span><br><span class="line">  - 储存的 time field：年，月，日，时，分，秒</span><br></pre></td></tr></table></figure></li>
<li><strong>格式</strong><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">DATE</span></span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 范例</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> test ( a <span class="type">DATE</span> ) ;</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：TIMESTAMP-型"><a href="#知识点：TIMESTAMP-型" class="headerlink" title="知识点：TIMESTAMP 型"></a>知识点：TIMESTAMP 型</h3><ol>
<li><strong>TIMESTAMP 型</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 时间戳型数据</span><br><span class="line">  - 储存的 time field：在 DATE 型的基础上，储存秒数的小数点后 1-9 位，称为 functional second，默认 6 位</span><br></pre></td></tr></table></figure></li>
<li><strong>格式</strong><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">TIMESTAMP</span>(n)</span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 范例</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> test ( a <span class="type">TIMESTAMP</span> ) ;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> test ( a <span class="type">TIMESTAMP</span>(<span class="number">6</span>) ) ;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 字面量</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> test <span class="keyword">VALUES</span> ( <span class="type">TIMESTAMP</span><span class="string">&#x27;1999-12-01 10:00:00&#x27;</span> );</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：TIMESTAMP-WITH-TIME-ZONE-型"><a href="#知识点：TIMESTAMP-WITH-TIME-ZONE-型" class="headerlink" title="知识点：TIMESTAMP WITH TIME ZONE 型"></a>知识点：TIMESTAMP WITH TIME ZONE 型</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 带时区的时间戳型</span><br><span class="line">  - 在 TIMESTAMP 型的基础上，额外储存时区信息 TZH 和 TZM</span><br></pre></td></tr></table></figure></li>
<li><strong>范例</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">-- DDL</span><br><span class="line">CREATE TABLE test ( t TIMESTAMP WITH TIME ZONE) ;</span><br><span class="line"></span><br><span class="line">-- 字面量</span><br><span class="line">INSERT INTO test VALUES ( TIMESTAMP &#x27;1999-12-01 10:00:00 +08:00&#x27; );</span><br><span class="line">INSERT INTO test VALUES ( TIMESTAMP &#x27;1999-12-01 10:00:00 Asia/Shanghai&#x27; );</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：TIMESTAMP-WITH-LOCAL-TIME-ZONE-型"><a href="#知识点：TIMESTAMP-WITH-LOCAL-TIME-ZONE-型" class="headerlink" title="知识点：TIMESTAMP WITH LOCAL TIME ZONE 型"></a>知识点：TIMESTAMP WITH LOCAL TIME ZONE 型</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 不储存时区信息 TZH 和 TZM</span><br><span class="line">  - 在提交时间戳数据时，Oracle 会自动根据数据库时区和会话时区，对时间戳进行计算，将时间戳的值转换为 dbtimezone 的时间戳，然后才储存</span><br></pre></td></tr></table></figure></li>
<li><strong>范例</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">-- DDL</span><br><span class="line">CREATE TABLE test ( t TIMESTAMP WITH LOCAL TIME ZONE) ;</span><br><span class="line"></span><br><span class="line">-- 字面量</span><br><span class="line">INSERT INTO test VALUES ( TIMESTAMP &#x27;1999-12-01 10:00:00 &#x27; );</span><br><span class="line">INSERT INTO test VALUES ( TIMESTAMP &#x27;1999-12-01 10:00:00 +08:00&#x27; );</span><br><span class="line">INSERT INTO test VALUES ( TIMESTAMP &#x27;1999-12-01 10:00:00 Asia/Shanghai&#x27; );</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：TO-DATE-函数"><a href="#知识点：TO-DATE-函数" class="headerlink" title="知识点：TO_DATE 函数"></a>知识点：TO_DATE 函数</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">* 作用</span><br><span class="line">  - 将字符型转换为 DATE 型</span><br></pre></td></tr></table></figure></li>
<li><strong>格式</strong><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">TO_DATE(<span class="type">Char</span> [ <span class="keyword">DEFAULT</span> Return_Value <span class="keyword">ON</span> CONVERSION ERROR ] [, Format [, <span class="string">&#x27;Nls_Parameter&#x27;</span> ] ])</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：TO-TIMESTAMP-函数"><a href="#知识点：TO-TIMESTAMP-函数" class="headerlink" title="知识点：TO_TIMESTAMP 函数"></a>知识点：TO_TIMESTAMP 函数</h3><ol>
<li><strong>TO_TIMESTAMP 函数</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">* 作用</span><br><span class="line">  - 将字符型转换为 TIMESTAMP 型</span><br><span class="line"></span><br><span class="line">* 格式</span><br><span class="line">  TO_TIMESTAMP(Char [ DEFAULT Return_Value ON CONVERSION ERROR ] [, Format [, &#x27;Nls_Parameter&#x27; ] ])</span><br></pre></td></tr></table></figure></li>
<li><strong>TO_TIMESTAMP_TZ 函数</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">* 作用</span><br><span class="line">  - 将字符型转换为 TIMESTAMP WITH TIME ZONE 型</span><br><span class="line"></span><br><span class="line">* 格式</span><br><span class="line">  TO_TIMESTAMP_TZ(Char [ DEFAULT Return_Value ON CONVERSION ERROR ] [, Format [, &#x27;Nls_Parameter&#x27; ] ])</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：时区-Time-Zone"><a href="#知识点：时区-Time-Zone" class="headerlink" title="知识点：时区 Time Zone"></a>知识点：时区 Time Zone</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 数据库的运行包含两个时区 dbtimezone 和 sessiontimezone</span><br><span class="line"></span><br><span class="line">* 数据库时区 dbtimezone</span><br><span class="line">  - 数据库在储存时间数据时，参考此时区</span><br><span class="line"></span><br><span class="line">* 客户端时区 sessiontimezone</span><br><span class="line">  - 查询数据库时，返回的数据会按照客户端时区进行转换</span><br></pre></td></tr></table></figure></li>
<li><strong>相关字典</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">* V$TIMEZONE_NAMES</span><br><span class="line">  - 记录了所有的时区的名字</span><br><span class="line">  - TZNAME</span><br><span class="line">    - 时区的地区名 Time zone region</span><br></pre></td></tr></table></figure></li>
<li><strong>相关函数</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">* DBTIMEZONE</span><br><span class="line">  - 返回数据库时区</span><br><span class="line">  - 返回值为一个时区偏移 time zone offset，类型为字符型，格式为 &#x27;[+|-]TZH:TZM&#x27;，或者是时区的地区名 time zone region</span><br><span class="line">  - 范例：SELECT DBTIMEZONE FROM dual ;</span><br><span class="line"></span><br><span class="line">* SESSIONTIMEZONE</span><br><span class="line">  - 返回客户端时区</span><br><span class="line">  - 返回值格式与 DBTIMEZONE 函数相同</span><br><span class="line">  - 范例：SELECT SESSIONTIMEZONE FROM dual ;</span><br><span class="line"></span><br><span class="line">* TZ_OFFSET</span><br><span class="line">  - 返回指定时区的时区偏移</span><br><span class="line">  - 格式：TZ_OFFSET(&#x27;time_zone_region&#x27; | &#x27;&#123;+|-&#125; hh : mi&#x27; | SESSIONTIMEZONE | DBTIMEZONE )</span><br></pre></td></tr></table></figure></li>
<li><strong>相关 DDL</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">* ALTER SESSION SET TIME_ZONE</span><br><span class="line">  - 调整会话的时区</span><br><span class="line">  - 语法：ALTER SESSION SET TIME_ZONE = Time_Zone ;</span><br><span class="line">  - time_zone 可用值</span><br><span class="line">    &#x27;[+|-] hh:mi&#x27;</span><br><span class="line">    &#x27;time_zone_region&#x27;</span><br><span class="line">    LOCAL</span><br><span class="line">    DBTIMEZONE</span><br><span class="line"></span><br><span class="line">* ALTER DATABASE SET TIME_ZONE</span><br><span class="line">  - 调整数据库的时区</span><br><span class="line">  - 需要重启数据库才能生效</span><br><span class="line">  - 语法：ALTER DATABASE SET TIME_ZONE = Time_Zone ;</span><br><span class="line">  - time_zone 可用值</span><br><span class="line">    &#x27;[+|-] hh:mi&#x27;</span><br><span class="line">    &#x27;time_zone_region&#x27;</span><br><span class="line">    LOCAL</span><br><span class="line">    DBTIMEZONE</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：日期时间型的算数运算"><a href="#知识点：日期时间型的算数运算" class="headerlink" title="知识点：日期时间型的算数运算"></a>知识点：日期时间型的算数运算</h3><ol>
<li><strong>日期时间型加减数值型</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 结果为 DATE 型</span><br><span class="line">  - 数值型的整数，表示一天</span><br><span class="line">  - 对所有的日期时间型都有效，如 date、timestamp 等</span><br><span class="line"></span><br><span class="line">* 范例</span><br><span class="line">  - SYSDATE + 1         加一天</span><br><span class="line">  - SYSDATE + 1/24      加一小时</span><br><span class="line">  - SYSDATE + 1/24/60   加一分钟</span><br></pre></td></tr></table></figure></li>
<li><strong>日期时间型加减日期型</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 结果为数值型，单位为天</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h2 id="7-5-时间间隔型"><a href="#7-5-时间间隔型" class="headerlink" title="7.5 时间间隔型"></a>7.5 时间间隔型</h2><hr>
<h3 id="知识点：时间间隔型"><a href="#知识点：时间间隔型" class="headerlink" title="知识点：时间间隔型"></a>知识点：时间间隔型</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">* 时间间隔型 INTERVAL</span><br><span class="line">  - 用于储存一段时间 a period of time</span><br><span class="line">  - 对应了不同的 datetime fields</span><br><span class="line"></span><br><span class="line">* INTERVAL 型和 DATE 型的算数运算</span><br><span class="line">  - DATE 型可以加减 INTERVAL 型</span><br><span class="line">  - 如果结果超出范围，会报错</span><br><span class="line">  - 如 SELECT TO_DATE(&#x27;2020-01-31&#x27;) + INTERVAL &#x27;1&#x27; MONTH FROM DUAL ; 会报错，因为 2 月没有 31 日</span><br></pre></td></tr></table></figure></li>
<li><strong>时间间隔型标准 ISO 格式字面量</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 时间间隔型的字面量的字符串表现形式</span><br><span class="line">  - 放在单引号中</span><br><span class="line">  - 大写字母</span><br><span class="line">  - 不能包含空格</span><br><span class="line"></span><br><span class="line">* YM_ISO_FORMAT 格式</span><br><span class="line">  - 用来表示从年到小数点秒的时间间隔</span><br><span class="line">  - 可以用在 TO_YMINTERVAL 函数中，TO_YMINTERVAL 函数会自动忽略 Days，Hours，Minutes，Seconds，Frac_secs</span><br><span class="line">  - 格式</span><br><span class="line">    [-]P[&lt;years&gt; Y][&lt;months&gt; M][&lt;days&gt;D][T[&lt;hours&gt;H][&lt;minutes&gt; M][&lt;seconds&gt;[.&lt;frac_secs&gt;]S]]</span><br><span class="line"></span><br><span class="line">* DS_ISO_FORMAT 格式</span><br><span class="line">  - 用来表示从天到小数点秒的时间间隔</span><br><span class="line">  - 可以用在 TO_DSINTERVAL 函数中</span><br><span class="line">  - 格式</span><br><span class="line">    [-]P[&lt;days&gt;D][T[&lt;hours&gt;H][&lt;minutes&gt;M][&lt;seconds&gt;[.&lt;frac_secs]S]]</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：INTERVAL-YEAR-TO-MONTH-型"><a href="#知识点：INTERVAL-YEAR-TO-MONTH-型" class="headerlink" title="知识点：INTERVAL YEAR TO MONTH 型"></a>知识点：INTERVAL YEAR TO MONTH 型</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 年月间隔</span><br><span class="line">  - 储存年、月</span><br><span class="line">  - 可以为负</span><br><span class="line"></span><br><span class="line">* 格式</span><br><span class="line">  INTERVAL YEAR [(year_precision)] TO MONTH</span><br><span class="line"></span><br><span class="line">* year_precision</span><br><span class="line">  - 指定 year 的数字的位数，默认为 2</span><br></pre></td></tr></table></figure></li>
<li><strong>范例</strong><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- CREATE TABLE</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> test ( a <span class="type">INTERVAL</span> <span class="keyword">YEAR</span> <span class="keyword">TO</span> <span class="keyword">MONTH</span>) ;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 时间间隔为 4 年</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="keyword">table</span> <span class="keyword">VALUES</span> ( <span class="type">INTERVAL</span> <span class="string">&#x27;4&#x27;</span> <span class="keyword">YEAR</span>) ;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 时间间隔为 3 个月</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="keyword">table</span> <span class="keyword">VALUES</span> ( <span class="type">INTERVAL</span> <span class="string">&#x27;3&#x27;</span> <span class="keyword">MONTH</span>) ;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 时间间隔为 4 年 3 个月</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="keyword">table</span> <span class="keyword">VALUES</span> ( <span class="type">INTERVAL</span> <span class="string">&#x27;4-3&#x27;</span> <span class="keyword">YEAR</span> <span class="keyword">TO</span> <span class="keyword">MONTH</span>) ;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 时间间隔为 -3 个月</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="keyword">table</span> <span class="keyword">VALUES</span> ( <span class="type">INTERVAL</span> <span class="string">&#x27;-0-3&#x27;</span> <span class="keyword">YEAR</span> <span class="keyword">TO</span> <span class="keyword">MONTH</span>) ;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 与 DATE 型进行计算</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="type">Date</span> <span class="operator">+</span><span class="operator">/</span><span class="operator">-</span> <span class="type">INTERVAL</span> <span class="string">&#x27;4-3&#x27;</span> <span class="keyword">YEAR</span> <span class="keyword">TO</span> <span class="keyword">MONTH</span> <span class="keyword">FROM</span> DUAL ;</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：INTERVAL-DAY-TO-SECOND-型"><a href="#知识点：INTERVAL-DAY-TO-SECOND-型" class="headerlink" title="知识点：INTERVAL DAY TO SECOND 型"></a>知识点：INTERVAL DAY TO SECOND 型</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 天时分秒间隔型</span><br><span class="line">  - 储存天、时、分、秒</span><br><span class="line">  - 可以为负</span><br><span class="line">  - 秒可以带小数点，支持 1-9 位小数，默认为 6 位</span><br><span class="line"></span><br><span class="line">* 格式</span><br><span class="line">  INTERVAL DAY [(day_precision)] TO SECOND [(fractional_seconds_precision)]</span><br><span class="line"></span><br><span class="line">* day_precision</span><br><span class="line">  - 天的位数，范围 0 到 9，默认为 2</span><br><span class="line"></span><br><span class="line">* fractional_seconds_precision</span><br><span class="line">  - 秒的小数点后位数，范围 0 到 9，默认为 6</span><br></pre></td></tr></table></figure></li>
<li><strong>范例</strong><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- CREATE TABLE</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> test ( a <span class="type">INTERVAL</span> <span class="keyword">DAY</span> <span class="keyword">TO</span> <span class="keyword">SECOND</span> ) ;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 字面量</span></span><br><span class="line"><span class="type">INTERVAL</span> <span class="string">&#x27;4&#x27;</span> <span class="keyword">DAY</span></span><br><span class="line"><span class="type">INTERVAL</span> <span class="string">&#x27;4&#x27;</span> <span class="keyword">HOUR</span></span><br><span class="line"><span class="type">INTERVAL</span> <span class="string">&#x27;4&#x27;</span> <span class="keyword">MINUTE</span></span><br><span class="line"><span class="type">INTERVAL</span> <span class="string">&#x27;4&#x27;</span> <span class="keyword">SECOND</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 组合使用字面量</span></span><br><span class="line"><span class="type">INTERVAL</span> <span class="string">&#x27;40 5&#x27;</span> <span class="keyword">DAY</span> <span class="keyword">TO</span> <span class="keyword">HOUR</span></span><br><span class="line"><span class="type">INTERVAL</span> <span class="string">&#x27;40 5:15&#x27;</span> <span class="keyword">DAY</span> <span class="keyword">TO</span> <span class="keyword">MINUTE</span></span><br><span class="line"><span class="type">INTERVAL</span> <span class="string">&#x27;40 5:0:0&#x27;</span> <span class="keyword">DAY</span> <span class="keyword">TO</span> <span class="keyword">SECOND</span></span><br><span class="line"><span class="type">INTERVAL</span> <span class="string">&#x27;40 5:15:12&#x27;</span> <span class="keyword">DAY</span> <span class="keyword">TO</span> <span class="keyword">SECOND</span></span><br><span class="line"><span class="type">INTERVAL</span> <span class="string">&#x27;40 5:15:12.12121&#x27;</span> <span class="keyword">DAY</span> <span class="keyword">TO</span> <span class="keyword">SECOND</span></span><br><span class="line"><span class="type">INTERVAL</span> <span class="string">&#x27;5:15&#x27;</span> <span class="keyword">HOUR</span> <span class="keyword">TO</span> <span class="keyword">MINUTE</span></span><br><span class="line"><span class="type">INTERVAL</span> <span class="string">&#x27;5:15:12&#x27;</span> <span class="keyword">HOUR</span> <span class="keyword">TO</span> <span class="keyword">SECOND</span></span><br><span class="line"><span class="type">INTERVAL</span> <span class="string">&#x27;15:12&#x27;</span> <span class="keyword">MINUTE</span> <span class="keyword">TO</span> <span class="keyword">SECOND</span></span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：TO-YMINTERVAL-函数"><a href="#知识点：TO-YMINTERVAL-函数" class="headerlink" title="知识点：TO_YMINTERVAL 函数"></a>知识点：TO_YMINTERVAL 函数</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">* 作用</span><br><span class="line">  - 将字符型转换为 INTERVAL YEAR TO MONTH 型</span><br><span class="line"></span><br><span class="line">* 格式</span><br><span class="line">  TO_YMINTERVAL(&#x27;[+|-]years-months&#x27; [DEFAULT return_value ON CONVERSION ERROR])</span><br><span class="line">  TO_YMINTERVAL(&#x27;ym_iso_interval&#x27;   [DEFAULT return_value ON CONVERSION ERROR])</span><br></pre></td></tr></table></figure></li>
<li><strong>范例</strong><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 1 年 1 个月的时间间隔</span></span><br><span class="line">TO_YMINTERVAL(<span class="string">&#x27;1-1&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">-- -1 个月的时间间隔</span></span><br><span class="line">TO_YMINTERVAL(<span class="string">&#x27;-0-1&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">-- ym_iso 形式的参数</span></span><br><span class="line">TO_YMINTERVAL(<span class="string">&#x27;P1Y2M&#x27;</span>)</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：TO-DSINTERVAL-函数"><a href="#知识点：TO-DSINTERVAL-函数" class="headerlink" title="知识点：TO_DSINTERVAL 函数"></a>知识点：TO_DSINTERVAL 函数</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">* 作用</span><br><span class="line">  - 将字符型转换为 INTERVAL DAY TO SECOND 型</span><br><span class="line"></span><br><span class="line">* 格式</span><br><span class="line">  TO_DSINTERVAL(&#x27;[+|-]days hours:minutes:seconds[.franctional_sedonds]&#x27; [DEFAULT return_value ON CONVERSION ERROR])</span><br><span class="line">  TO_DSINTERVAL(&#x27;ds_iso_interval&#x27; [DEFAULT return_value ON CONVERSION ERROR])</span><br></pre></td></tr></table></figure></li>
<li><strong>范例</strong><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">TO_DSINTERVAL(<span class="string">&#x27;10 0:0:0&#x27;</span>)</span><br><span class="line"></span><br><span class="line">TO_DSINTERVAL(<span class="string">&#x27;P1DT2M&#x27;</span>)</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：NUMTOYMINTERVAL-函数"><a href="#知识点：NUMTOYMINTERVAL-函数" class="headerlink" title="知识点：NUMTOYMINTERVAL 函数"></a>知识点：NUMTOYMINTERVAL 函数</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">* 作用</span><br><span class="line">  - 将数值型转换为 INTERVAL YEAR TO MONTH 型</span><br><span class="line"></span><br><span class="line">* 格式</span><br><span class="line">  NUMTOYMINTERVAL( n, &#x27;interval_unit&#x27;)</span><br><span class="line"></span><br><span class="line">* n</span><br><span class="line">  - 指定数字</span><br><span class="line">  - 可以是小数</span><br><span class="line">  - 可以是负数</span><br><span class="line"></span><br><span class="line">* interval_unit</span><br><span class="line">  - 指定 n 所代表的单位，只能指定一个单位</span><br><span class="line">  - &#x27;YEAR&#x27;</span><br><span class="line">  - &#x27;MONTH&#x27;</span><br></pre></td></tr></table></figure></li>
<li><strong>范例</strong><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 查看 1.5 年以后的日期</span></span><br><span class="line"><span class="keyword">SELECT</span> SYSDATE <span class="operator">+</span> NUMTOYMINTERVAL(<span class="number">1.5</span>, <span class="string">&#x27;YEAR&#x27;</span>) <span class="keyword">FROM</span> DUAL ;</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：NUMTODSINTERVAL-函数"><a href="#知识点：NUMTODSINTERVAL-函数" class="headerlink" title="知识点：NUMTODSINTERVAL 函数"></a>知识点：NUMTODSINTERVAL 函数</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">* 作用</span><br><span class="line">  - 将数值型转换为 INTERVAL DAY TO SECOND 型</span><br><span class="line"></span><br><span class="line">* 格式</span><br><span class="line">  NUMTODSINTERVAL( n, &#x27;interval_unit&#x27;)</span><br><span class="line"></span><br><span class="line">* n</span><br><span class="line">  - 指定数字</span><br><span class="line">  - 可以是小数</span><br><span class="line">  - 可以是负数</span><br><span class="line"></span><br><span class="line">* interval_unit</span><br><span class="line">  - 指定 n 所代表的单位，只能指定一个单位</span><br><span class="line">  - &#x27;DAY&#x27;</span><br><span class="line">  - &#x27;HOUR&#x27;</span><br><span class="line">  - &#x27;MINUTE&#x27;</span><br><span class="line">  - &#x27;SECOND&#x27;</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h2 id="7-6-空值"><a href="#7-6-空值" class="headerlink" title="7.6 空值"></a>7.6 空值</h2><hr>
<h3 id="知识点：空值-NULL"><a href="#知识点：空值-NULL" class="headerlink" title="知识点：空值 NULL"></a>知识点：空值 NULL</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 空值，表示没有数值，不代表任何具体数值</span><br><span class="line">  - NULL 与 NULL 不是相等的，也不是不相等的</span><br><span class="line">  - NULL 不同于 0 或空格</span><br><span class="line">    - 0 是数值型</span><br><span class="line">    - 空格是字符型</span><br><span class="line">  - 在条件判断中，NULL 作为 FALSE 处理</span><br><span class="line"></span><br><span class="line">* NULL 参与运算</span><br><span class="line">  - 算术运算、比较运算中，包含空值，结果还是空值</span><br><span class="line">  - group by clause 中，所有 NULL 集中在一个组中</span><br><span class="line">  - order by clause 中，NULL 当做最大值处理</span><br><span class="line"></span><br><span class="line">* 向表中新增空值</span><br><span class="line">  - 隐式方法，省略此列</span><br><span class="line">  - 显示方法，使用 NULL 关键字</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：NVL-函数"><a href="#知识点：NVL-函数" class="headerlink" title="知识点：NVL 函数"></a>知识点：NVL 函数</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">* 格式</span><br><span class="line">  NVL(Expression_1, Expression_2)</span><br><span class="line"></span><br><span class="line">* 作用</span><br><span class="line">  - 如果 Expression_1   是 NULL，则返回 Expression_2</span><br><span class="line">  - 如果 Expression_1 不是 NULL，则返回 Expression_1</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：NVL2-函数"><a href="#知识点：NVL2-函数" class="headerlink" title="知识点：NVL2 函数"></a>知识点：NVL2 函数</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">* 格式</span><br><span class="line">  NVL(Expression_1, Expression_2, Expression_3)</span><br><span class="line"></span><br><span class="line">* 作用</span><br><span class="line">  - 如果 Expression_1 不是 NULL，则返回 Expression_2</span><br><span class="line">  - 如果 Expression_1   是 NULL，则返回 Expression_3</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h2 id="7-7-格式化模型"><a href="#7-7-格式化模型" class="headerlink" title="7.7 格式化模型"></a>7.7 格式化模型</h2><hr>
<h3 id="知识点：格式化模型"><a href="#知识点：格式化模型" class="headerlink" title="知识点：格式化模型"></a>知识点：格式化模型</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 格式化模型 FORMAT MODEL</span><br><span class="line">    - 在输入时，指定数据库如何识别字面量</span><br><span class="line">    - 在输出时，指定数据库使用的打印格式</span><br><span class="line"></span><br><span class="line">* FORMAT MODEL 的两种类型</span><br><span class="line">  - 数字格式化模型</span><br><span class="line">  - 日期时间格式化模型</span><br></pre></td></tr></table></figure></li>
<li><strong>格式化模型作为函数的参数</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">* 在 TO_CHAR 函数中，将 NUMBER 或 BINARY_FLOAT 或 BINARY_DOUBLE，转换成字符型</span><br><span class="line"></span><br><span class="line">* 在 TO_NUMBER 函数中，将 CHAR 或 VARCHAR2，转换成 number 型</span><br><span class="line"></span><br><span class="line">* 在 TO_BINARY_FLOAT 或 TO_BINARY_DOUBLE 函数中，将 CHAT 或 VARCHAR2 转换成 BINARY_FLOAT 或 BINARY_DOUBLE 型</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：数字格式化模型"><a href="#知识点：数字格式化模型" class="headerlink" title="知识点：数字格式化模型"></a>知识点：数字格式化模型</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - number format model</span><br><span class="line">  - 限定数据库识别数字型数据的格式</span><br><span class="line">  - 指导数据库从字面量中读取数字型值</span><br><span class="line"></span><br><span class="line">* 超出数字格式化模型的显示</span><br><span class="line">  - 使用 number format models，都会导致 value 进行 round</span><br><span class="line">  - 如果 value 的小数点左边的 significant digits 有效数字比 number format model 的规定多，则整个 values 会被多个井号 # 替换</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：数字格式化模型元素"><a href="#知识点：数字格式化模型元素" class="headerlink" title="知识点：数字格式化模型元素"></a>知识点：数字格式化模型元素</h3><ol>
<li><strong>基本元素</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">* 9</span><br><span class="line">  - 表示一位数字</span><br><span class="line">  - 正数前面带一个空格</span><br><span class="line">  - 负数前带负号</span><br><span class="line"></span><br><span class="line">* 0</span><br><span class="line">  - 表示一位数字，没有数字则补全零</span><br><span class="line">  - 只能放在连续的 9 的左边或右边，不能放在两个 9 的中间</span><br><span class="line">  - 注意 90.90 的用法</span><br><span class="line">  - 注意 0099 与 0999 功能相同</span><br><span class="line"></span><br><span class="line">* .</span><br><span class="line">* D</span><br><span class="line">  - 表示一个小数点</span><br><span class="line"></span><br><span class="line">* ,</span><br><span class="line">  - 表示一个逗号，用作分组符号，可以用来做千分位符</span><br><span class="line">  - 在指定的位置显示逗号</span><br><span class="line">  - 注意逗号要在小数点左边</span><br><span class="line"></span><br><span class="line">* G</span><br><span class="line">  - 表示分组符号</span><br><span class="line">  - 多数情况下就是一个逗号</span><br></pre></td></tr></table></figure></li>
<li><strong>货币元素</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 不能单独使用，需要配合基本元素一起使用</span><br><span class="line"></span><br><span class="line">* $</span><br><span class="line">  - 放在最左边，表示开始加一个美元符号</span><br><span class="line"></span><br><span class="line">* L</span><br><span class="line">  - 放在最左边，表示开始加一个本地货币符号</span><br><span class="line">  - 本地货币符号由 NLS_CURRENCY 决定</span><br><span class="line"></span><br><span class="line">* U</span><br><span class="line">  - 放在最左边，表示开始加一个货币符号</span><br><span class="line">  - 货币符号由 NLS_DUAL_CURRENCY 决定</span><br></pre></td></tr></table></figure></li>
<li><strong>正负元素</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 不能单独使用，需要配合基本元素一起使用</span><br><span class="line"></span><br><span class="line">* mi</span><br><span class="line">  - 放在最右边，表示 value 的正负号放在最右边</span><br><span class="line">  - 空格表示正数</span><br><span class="line">  - 负号表示负数</span><br><span class="line"></span><br><span class="line">* pr</span><br><span class="line">  - 放在最右边，表示 value 的正负由 angle brackets 表示</span><br><span class="line">  - 没有 angle brackets 表示正数</span><br><span class="line">  - 放在 angle brackets 中表示负数</span><br><span class="line"></span><br><span class="line">* S</span><br><span class="line">  - 放在最左边或最右边，用来将正负号都显示出来</span><br><span class="line">  - 放在最左边表示正负号放在最左边</span><br><span class="line">  - 放在最右边表示正负号放在最右边</span><br></pre></td></tr></table></figure></li>
<li><strong>科学计数法元素</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">* eeee</span><br><span class="line">  - 放在最右边，表示用科学计数法表示</span><br><span class="line">  - 左边跟用来表示表示底数部分的格式的其他 number format model</span><br><span class="line">  - 一般是 9.9999eeee 的形式，底数是具有小数点的格式</span><br></pre></td></tr></table></figure></li>
<li><strong>罗马数字</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">* RN</span><br><span class="line">  - 单独使用，表示大写罗马数字</span><br><span class="line">  - 只能表示正整数，范围为 1 到 3999</span><br><span class="line"></span><br><span class="line">* rn</span><br><span class="line">  - 单独使用，表示小写罗马数字</span><br><span class="line">  - 只能表示正整数，范围为 1 到 3999</span><br></pre></td></tr></table></figure></li>
<li><strong>十六进制表示</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">* X</span><br><span class="line">  - 表示十六进制</span><br><span class="line">  - X 表示大写，x 表示小写</span><br><span class="line">  - 只能单独使用，如 XX 或 XXX 等的用法，不能和其他元素一起使用</span><br><span class="line">  - 只接受正数或 0，否则返回 error</span><br><span class="line">  - 如果不是整数，则先 round 到整数，再换成十六进制</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：日期时间格式化模型"><a href="#知识点：日期时间格式化模型" class="headerlink" title="知识点：日期时间格式化模型"></a>知识点：日期时间格式化模型</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - number format model</span><br><span class="line">  - 长度不能超过 22 个字符</span><br><span class="line">  - 默认的日期格式化模型由几个 NLS session parameter 控制</span><br><span class="line">    - 显示控制，NLS_DATE_FORMAT、NLS_TIMESTAMP_FORMAT、NLS_TIMESTAMP_TZ_FORMAT</span><br><span class="line">    - 隐式控制，NLS_TERRITORY</span><br><span class="line"></span><br><span class="line">* 作用</span><br><span class="line">  - 放在各种 to_datetime 函数中，如 TO_DATE，TO_TIMESTAMP，TO_TIMESTAMP_TZ，从 character string 中识别出 datatime</span><br><span class="line">  - 放在 to_char 函数中，将 datatime 转换为字符串</span><br><span class="line"></span><br><span class="line">* 应用范围</span><br><span class="line">  - to_char 函数可以使用所有 datatime format model</span><br><span class="line">  - to_date、to_timestamp 等转换为 datetime 的函数只能使用部分 datatime format model</span><br><span class="line"></span><br><span class="line">* 关于大小写</span><br><span class="line">  - datatime format model 的大小写均可用，但表示不同的意思</span><br><span class="line">  - 星期一</span><br><span class="line">    - DAY 表示为 MONDAY</span><br><span class="line">    - Day 表示为 Monday</span><br><span class="line">    - day 表示为 monday</span><br><span class="line">  - yyyy 和 YYYY，虽然返回的内容看起来相同，但实际上是不同的数据类型</span><br><span class="line">    - 可以执行: SELECT to_char( hire_date,&#x27;yyyy&#x27;) FROM hr.employees GROUP BY to_char( hire_date,&#x27;yyyy&#x27;) ;</span><br><span class="line">    - 无法执行: SELECT to_char( hire_date,&#x27;YYYY&#x27;) FROM hr.employees GROUP BY to_char( hire_date,&#x27;yyyy&#x27;) ;</span><br></pre></td></tr></table></figure></li>
<li><strong>RR 纪年</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - RR 纪年，round year</span><br><span class="line"></span><br><span class="line">* 现在是 00 到 49 年</span><br><span class="line">  - 00 到 49 被认为是同一个世纪</span><br><span class="line">  - 50 到 99 被认为是上一个世纪</span><br><span class="line"></span><br><span class="line">* 现在是 50 到 99 年</span><br><span class="line">  - 00 到 40 被认为是下一个世纪</span><br><span class="line">  - 50 到 99 被认为是同一个世纪</span><br></pre></td></tr></table></figure></li>
<li>**日期时间格式化模型的模糊识别原则 String-to-Date Conversion **<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">* 自动置为零时零分零秒</span><br><span class="line">  - datatime format model 如果有 date field 和 time field，而 string 中缺失 time field，此时 oracle 自动将 time field 置为零时零分零秒</span><br><span class="line"></span><br><span class="line">* 自动推断符号</span><br><span class="line">  - datatime format model 如果有标点符号，则即使 string 中缺失了标点符号，或使用的其他符号，oracle 也可以进行推断，在不影响意思的情况下翻译出原意</span><br><span class="line">  - 如，datatime format model 为 &#x27;yyyy/mm/dd&#x27;，则 oracle 也可以识别出 20190802 或 2019-08-02</span><br><span class="line"></span><br><span class="line">* 自动忽略在 leading zeroes 和多个 blank 上的不匹配</span><br><span class="line"></span><br><span class="line">* 自动使用类似的元素进行匹配</span><br><span class="line">  - 对于一些 datatime format element，如果一次匹配失败，oracle 会尝试用其他 element 来进行匹配</span><br><span class="line">  - MM，用 MON 和 MONTH</span><br><span class="line">  - MON，用 MONTH</span><br><span class="line">  - MONTH，用 MON</span><br><span class="line">  - YY，用 YYYY</span><br><span class="line">  - RR，用 RRRR</span><br><span class="line"></span><br><span class="line">* FX 格式化模型修正符会禁用所有的模糊识别原则</span><br></pre></td></tr></table></figure></li>
<li><strong>日期时间格式化模型的地区区别 Globalization Support</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">* 一些 datetime format model elements 的显示会受到地区和语言的影响</span><br><span class="line">  - MONTH、MON</span><br><span class="line">  - DAY、DY</span><br><span class="line">  - BC、AD、B.C.、A.D.</span><br><span class="line">  - AM、PM、A.M、P.M.</span><br><span class="line"></span><br><span class="line">* 要么显式的受 NLS_DATE_LANGUAGE 参数控制，要么隐式的受 NLS_LANGUAGE 参数控制</span><br><span class="line"></span><br><span class="line">* 数字 1 表示星期一还是星期日，隐式的受 NLS_TERRITORY 参数控制</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：日期时间格式化模型元素"><a href="#知识点：日期时间格式化模型元素" class="headerlink" title="知识点：日期时间格式化模型元素"></a>知识点：日期时间格式化模型元素</h3><ol>
<li><strong>文本</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 文本元素在会被直接显示</span><br><span class="line">  - 包括符号、空白、文本</span><br><span class="line"></span><br><span class="line">* 符号</span><br><span class="line">  -</span><br><span class="line">  /</span><br><span class="line">  ,</span><br><span class="line">  .</span><br><span class="line">  ;</span><br><span class="line">  :</span><br><span class="line"></span><br><span class="line">* 文本</span><br><span class="line">  - &quot;text&quot;</span><br><span class="line"></span><br><span class="line">* 空白</span><br></pre></td></tr></table></figure></li>
<li><strong>公元，世纪，年</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">* AD</span><br><span class="line">* A.D.</span><br><span class="line">* BC</span><br><span class="line">* B.C.</span><br><span class="line">  - 表示公元前，公元后</span><br><span class="line"></span><br><span class="line">* CC</span><br><span class="line">* SCC</span><br><span class="line">  - 表示世纪</span><br><span class="line">  - S 表示公元前的年份用负号表示</span><br><span class="line">  - 不适用于各种 TO_datetime 函数，并且，2000 年识别为 20 世纪</span><br><span class="line"></span><br><span class="line">* YYYY</span><br><span class="line">* YYY</span><br><span class="line">* YY</span><br><span class="line">* Y</span><br><span class="line">  - 表示年，分别对应 4 位数字、3 位数字、2 位数字、1 位数字</span><br><span class="line"></span><br><span class="line">* Y,YYY</span><br><span class="line">  - 表示年，中间有个逗号</span><br><span class="line"></span><br><span class="line">* SYYYY</span><br><span class="line">  - 表示年，不过 bc 前的年前面加一个负号</span><br><span class="line"></span><br><span class="line">* YEAR</span><br><span class="line">* SYEAR</span><br><span class="line">  - 表示年，英语拼写表示</span><br><span class="line">  - S 表示 bc 前的年前面加一个负号</span><br></pre></td></tr></table></figure></li>
<li><strong>季度、月、日</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">* Q</span><br><span class="line">  - 表示第几个季度，1 个数字表示</span><br><span class="line"></span><br><span class="line">* MM</span><br><span class="line">  - 表示月份，2 个数字表示</span><br><span class="line"></span><br><span class="line">* MON</span><br><span class="line">  - 表示月份，英文缩写表示</span><br><span class="line"></span><br><span class="line">* MONTH</span><br><span class="line">  - 表示月份，完整英文表示</span><br><span class="line"></span><br><span class="line">* RM</span><br><span class="line">  - 表示月份，罗马数字表示</span><br><span class="line"></span><br><span class="line">* DD</span><br><span class="line">  - 表示月份的几号</span><br><span class="line"></span><br><span class="line">* DDD</span><br><span class="line">  - 表示一年的第几天</span><br><span class="line"></span><br><span class="line">* J</span><br><span class="line">  - Julian day，从 January 1, 4712 BC 开始算有多少天，数字必须是整数</span><br></pre></td></tr></table></figure></li>
<li><strong>Weekday</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">* D</span><br><span class="line">  - 表示星期几，数字表示</span><br><span class="line"></span><br><span class="line">* DY</span><br><span class="line">  - 表示星期几，英文缩写表示</span><br><span class="line"></span><br><span class="line">* DAY</span><br><span class="line">  - 表示星期几，完整英文表示</span><br></pre></td></tr></table></figure></li>
<li><strong>时、分、秒、上午下午</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">* AM</span><br><span class="line">* A.M.</span><br><span class="line">* PM</span><br><span class="line">* P.M.</span><br><span class="line">  - 表示上午，下午</span><br><span class="line"></span><br><span class="line">* HH</span><br><span class="line">* HH12</span><br><span class="line">* HH24</span><br><span class="line">  - 表示小时</span><br><span class="line"></span><br><span class="line">* MI</span><br><span class="line">  - 表示分钟</span><br><span class="line"></span><br><span class="line">* SS</span><br><span class="line">  - 表示秒</span><br><span class="line"></span><br><span class="line">* SSSSS</span><br><span class="line">  - 表示秒，表示从 midnight 开始算有多少秒，取值范围 0 到 86399</span><br></pre></td></tr></table></figure></li>
<li><strong>Calendar Week</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">* WW</span><br><span class="line">  - 表示是一年中的第几个周</span><br><span class="line">  - 纯粹按照数字计算，不区分是否是从周一开始到周日结尾</span><br><span class="line">  - 取值范围为 1 到 53</span><br><span class="line"></span><br><span class="line">* W</span><br><span class="line">  - 表示是一个月中的第几个周</span><br><span class="line">  - 纯粹按照数字计算，不区分是否是从周一开始到周日结尾</span><br><span class="line">  - 取值为 1 到 5</span><br><span class="line"></span><br><span class="line">* IW</span><br><span class="line">  - 表示是一年当中的第几个周</span><br><span class="line"></span><br><span class="line">* IYYY</span><br><span class="line">  - 表示此日期所属于的 calender week 是属于哪一年，4 个数字表示</span><br><span class="line"></span><br><span class="line">* IYY</span><br><span class="line">  - 和 IYYY 功能相同，3 个数字表示</span><br><span class="line"></span><br><span class="line">* IY</span><br><span class="line">  - 和 IYYY 功能相同，2 个数字表示</span><br><span class="line"></span><br><span class="line">* I</span><br><span class="line">  - 和 IYYY 功能相同，1 个数字表示</span><br></pre></td></tr></table></figure></li>
<li><strong>TIMESTAMP</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">* FFn</span><br><span class="line">  - Fractional seconds</span><br><span class="line">  - n 取值为 1 到 9，表示小数点后数字的位数</span><br><span class="line">  - 使用时注意在 FF 前加一个小数点</span><br><span class="line"></span><br><span class="line">* X</span><br><span class="line">  - 小数点</span><br><span class="line"></span><br><span class="line">* TZR</span><br><span class="line">  - 时区</span><br><span class="line"></span><br><span class="line">* TZH</span><br><span class="line">  - 时区小时</span><br><span class="line"></span><br><span class="line">* TZM</span><br><span class="line">  - 时区分</span><br><span class="line"></span><br><span class="line">* TZD</span><br><span class="line">  - 夏令时</span><br></pre></td></tr></table></figure></li>
<li><strong>英语语法</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 可以在 Datetime Format 添加后缀，实现特殊的显示</span><br><span class="line">  - 只能用于输出，不能用于输入</span><br><span class="line"></span><br><span class="line">* sp</span><br><span class="line">  - 英语拼写</span><br><span class="line"></span><br><span class="line">* th</span><br><span class="line">  - 加上英语 th 表示序号</span><br><span class="line"></span><br><span class="line">* spth</span><br><span class="line">  - 使用英语序数词进行拼写</span><br></pre></td></tr></table></figure></li>
<li><strong>其他</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">* 基于地区的习惯 datatime 表示方法</span><br><span class="line">  - 具体显示格式取决于 NLS_TERRITORY 和 NLS_LANGUAGE 两个变量</span><br><span class="line">  - DL</span><br><span class="line">    - 按照 long date format 显示，AMERICAN_AMERICA local 的格式为 fmDay, Month dd, yyyy</span><br><span class="line">    - 只能和 TS 一起使用</span><br><span class="line">  - DS</span><br><span class="line">    - 按照 short date format 显示，AMERICAN_AMERICA local 的格式为 MM/DD/RRRR</span><br><span class="line">    - 只能和 TS 一起使用</span><br><span class="line">  - TS</span><br><span class="line">    - 按照 short time format 显示</span><br><span class="line">    - 可以和 DL 或 DS 一起使用</span><br><span class="line">    一起使用时以空格间隔</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：格式化模型修正符"><a href="#知识点：格式化模型修正符" class="headerlink" title="知识点：格式化模型修正符"></a>知识点：格式化模型修正符</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - Format Model Modifiers</span><br><span class="line">  - 格式化模型修正符用在 to_char 函数中，对输出格式进行调整</span><br><span class="line">  - 格式化模型修正符可以在一个 format model 中出现多次</span><br><span class="line">    - 第一次出现表示开启影响</span><br><span class="line">    - 第二次出现表示关闭影响</span><br><span class="line">    - 第三次出现表示重新开启影响</span><br><span class="line">    - 依次类推</span><br><span class="line"></span><br><span class="line">* FM</span><br><span class="line">  - fill mode 禁用填充</span><br><span class="line">  - 正常情况下，Oracle 会用 leading zeroes 或 trailing blank 来填充</span><br><span class="line">  - 填充的标准是相关 format model 的最大可能长度，如 month 的最大可能长度是 September，即 9 个字符</span><br><span class="line">  - FM 会禁用这些填充</span><br><span class="line"></span><br><span class="line">* FX</span><br><span class="line">  - Format exact 完全匹配</span><br><span class="line">  - 正常情况下，Oracle 会对 blank 和 leading zeroes 和标点符号进行模糊识别匹配</span><br><span class="line">  - FX 会禁用模糊识别，要求字符串的内容必须和 format moel 完全相同，否则 return error</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h2 id="7-8-NLS"><a href="#7-8-NLS" class="headerlink" title="7.8 NLS"></a>7.8 NLS</h2><hr>
<h3 id="知识点：NLS"><a href="#知识点：NLS" class="headerlink" title="知识点：NLS"></a>知识点：NLS</h3><ol>
<li><strong>NLS 介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - National Language Support</span><br><span class="line">  - 受 NLS 影响的内容</span><br><span class="line">    - 字符集</span><br><span class="line">    - 时区</span><br><span class="line">    - 排序方式</span><br><span class="line"></span><br><span class="line">* NLS 优先级</span><br><span class="line">  - Sql function</span><br><span class="line">  - alter session</span><br><span class="line">  - 客户端操作系统环境变量</span><br><span class="line">  - 参数文件</span><br><span class="line">  - 数据库默认参数</span><br></pre></td></tr></table></figure></li>
<li><strong>相关字典</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">* V$NLS_VALID_VALUES</span><br><span class="line">  - NLS 语言和排序参数的可用值</span><br><span class="line"></span><br><span class="line">* V$NLS_PARAMETERS</span><br><span class="line">  - 当前 PGA 的 NLS 参数的值</span><br><span class="line"></span><br><span class="line">* NLS_SESSION_PARAMETERS</span><br><span class="line">  - 当前会话的 NLS 参数的值</span><br><span class="line"></span><br><span class="line">* NLS_INSTANCE_PARAMETERS</span><br><span class="line">  - 当前实例的 NLS 参数的值</span><br><span class="line"></span><br><span class="line">* NLS_DATABASE_PARAMETERS</span><br><span class="line">  - 数据库的 NLS 参数的值</span><br></pre></td></tr></table></figure></li>
<li><strong>相关参数</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">* nls_calendar</span><br><span class="line"></span><br><span class="line">* nls_comp</span><br><span class="line"></span><br><span class="line">* nls_currency</span><br><span class="line">  - 货币符号</span><br><span class="line"></span><br><span class="line">* nls_dual_currency</span><br><span class="line"></span><br><span class="line">* nls_iso_currency</span><br><span class="line"></span><br><span class="line">* nls_language</span><br><span class="line">  - 显示语言</span><br><span class="line"></span><br><span class="line">* nls_length_semantics</span><br><span class="line"></span><br><span class="line">* nls_nchar_conv_excp</span><br><span class="line"></span><br><span class="line">* nls_numeric_characters</span><br><span class="line"></span><br><span class="line">* nls_sort</span><br><span class="line">  - 排序使用的算法</span><br><span class="line"></span><br><span class="line">* nls_territory</span><br><span class="line">  - 地区</span><br><span class="line"></span><br><span class="line">* nls_date_format</span><br><span class="line">  - date 型的显示格式</span><br><span class="line"></span><br><span class="line">* nls_date_language</span><br><span class="line"></span><br><span class="line">* nls_time_format</span><br><span class="line"></span><br><span class="line">* nls_time_tz_format</span><br><span class="line"></span><br><span class="line">* nls_timestamp_format</span><br><span class="line">  - timestamp 型的显示格式</span><br></pre></td></tr></table></figure></li>
<li><strong>OS 环境变量</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">* NLS_LANG</span><br><span class="line">  - NLS_LANG 环境变量会覆盖参数文件中的 nls 参数设置</span><br><span class="line">    - NLS_LANGUAGE</span><br><span class="line">    - NLS_TERRITORY</span><br><span class="line">    - NLS_CURRENCY</span><br><span class="line">    - NLS_ISO_CURRENCY</span><br><span class="line">    - NLS_DATE_LANGUAGE</span><br><span class="line"></span><br><span class="line">* 范例</span><br><span class="line">  - export NLS_LANG=&#x27;simplified chinese_china.al32utf8&#x27;</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：字符集"><a href="#知识点：字符集" class="headerlink" title="知识点：字符集"></a>知识点：字符集</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">* 字符集 character set</span><br><span class="line"></span><br><span class="line">* 字符集参数格式</span><br><span class="line">  language_territory.characterset</span><br><span class="line">  - language_territory    -- 影响显示方式</span><br><span class="line">  - characterset          -- 影响数据库存储的数据</span><br><span class="line"></span><br><span class="line">* 字符集命名方式</span><br><span class="line">  LanguageBitSizeEncoding</span><br><span class="line">  - Language  支持的语言，AL 表示 all language</span><br><span class="line">  - BitSize   字符的宽度</span><br><span class="line">  - Encoding  编码方式</span><br><span class="line">  - 例如，AL32UTF8，表示支持所有的语言，字符宽度为 32 bit，编码方式为 UTF8</span><br><span class="line"></span><br><span class="line">* Oracle 数据库常用字符集</span><br><span class="line">  - AL32UTF8  储存康熙字典汉字</span><br><span class="line">  - AL16UTF16 储存任意汉字</span><br></pre></td></tr></table></figure></li>
<li><strong>编码方式</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">* 单字节字符</span><br><span class="line">  - 单字节 7 位字符集，可以定义 128 个字符，最常用的字符集为 US7ASCII</span><br><span class="line">  - 单字节 8 位字符集，可以定义 256 个字符，适合于欧洲大部分国家</span><br><span class="line"></span><br><span class="line">* 多字节字符</span><br><span class="line">  - 变长多字节编码，某些字符用一个字节表示，其它字符用两个或多个字节表示，常用于对亚洲语言的支持，如 AL32UTF8</span><br><span class="line">  - 定长多字节编码，每一个字符都使用固定长度字节的编码方案，目前 oracle 唯一支持的定长多字节编码是 AF16UTF16，也仅用于国家字符集</span><br><span class="line"></span><br><span class="line">* unicode 编码</span><br><span class="line">  - Unicode 为目前全世界使用的所有已知字符提供唯一编码方案</span><br><span class="line">  - UTF-16 是 unicode 16 位编码方式，定长多字节编码，用 2 个字节表示一个 unicode 字符，AF16UTF16 是 UTF-16 编码字符集</span><br><span class="line">  - UTF-8 是 unicode 8 位编码方式，变长多字节编码，可以用 1、2、3 个字节表示一个 unicode 字符，AL32UTF8、UTF8、UTFE 都是 UTF-8 编码字符集</span><br></pre></td></tr></table></figure></li>
<li><strong>数据库字符集和国家字符集</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">* 数据库字符集 character set</span><br><span class="line">  - 存储 CHAR、VARCHAR2、CLOB、LONG 等类型数据</span><br><span class="line">  - 用来表示诸如表名、列名、PL/SQL 变量等</span><br><span class="line">  - 用来存储 SQL 和 PL/SQL 程序单元等</span><br><span class="line"></span><br><span class="line">* 国家字符集 national character set</span><br><span class="line">  - 存储 NCHAR、NVARCHAR2、NCLOB 等类型数据</span><br><span class="line">  - 实质上是作为 oracle 的附加字符集，主要为了增强 oracle 的字符处理能力，提供对亚洲使用定长多字节编码的支持，而数据库字符集则不能</span><br><span class="line">  - 默认使用 AF16UTF16</span><br></pre></td></tr></table></figure></li>
<li><strong>修改字符集</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 可以在 session 级别修改字符集</span><br><span class="line">  - 轻易不要在 database 级别修改字符集</span><br><span class="line"></span><br><span class="line">* 修改 database 字符集操作</span><br><span class="line">  - shutdown</span><br><span class="line">  - startup mount</span><br><span class="line">  - alter database mount exclusive</span><br><span class="line">  - alter system enable restricted session</span><br><span class="line">  - alter system job_quene_processes=0</span><br><span class="line">  - alter database open</span><br><span class="line">  - alter database character set al32utf8</span><br><span class="line">  - alter database character set internal_use al32utf8</span><br><span class="line">  - alter system job_quene_processes=20</span><br><span class="line">  - shutdown</span><br><span class="line">  - startup</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：NLS-SORT-参数"><a href="#知识点：NLS-SORT-参数" class="headerlink" title="知识点：NLS_SORT 参数"></a>知识点：NLS_SORT 参数</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 指定排序使用的算法，会影响 ORDER BY、GROUP BY、=、&lt;&gt;、&lt;=、&gt;=、IN、BETWEEN、LIKE 等</span><br><span class="line">  - string 型</span><br><span class="line">  - ALTER SESSION 级别</span><br><span class="line"></span><br><span class="line">* 格式</span><br><span class="line">  NLS_SORT=Algorithm[_ai|_cl]</span><br><span class="line"></span><br><span class="line">* Algorithm</span><br><span class="line">  - 指定排序算法</span><br><span class="line"></span><br><span class="line">* _ai</span><br><span class="line">  - 不区分重音</span><br><span class="line"></span><br><span class="line">* _cl</span><br><span class="line">  - 不区分大小写</span><br></pre></td></tr></table></figure></li>
<li><strong>常用的排序算法</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">* BINARY</span><br><span class="line">  - 二进制排序，默认方式</span><br><span class="line"></span><br><span class="line">* SCHINESE_PINYIN_M</span><br><span class="line">  - 简体中文拼音排序</span><br><span class="line"></span><br><span class="line">* SCHINESE_STROKE_M</span><br><span class="line">  - 简体中文笔画排序</span><br><span class="line"></span><br><span class="line">* SCHINESE_RADICAL_M</span><br><span class="line">  - 简体中文偏旁排序</span><br><span class="line"></span><br><span class="line">* Oracle 支持的排序算法列表</span><br><span class="line">  https://docs.oracle.com/en/database/oracle/oracle-database/18/nlspg/appendix-A-locale-data.html#GUID-CC85A33C-81FC-4E93-BAAB-1B3DB9036060</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h2 id="7-9-其他数据类型"><a href="#7-9-其他数据类型" class="headerlink" title="7.9 其他数据类型"></a>7.9 其他数据类型</h2><hr>
<h3 id="知识点：LOB-型"><a href="#知识点：LOB-型" class="headerlink" title="知识点：LOB 型"></a>知识点：LOB 型</h3><ol>
<li><strong>LONG 型</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">* 变长字符型数据</span><br><span class="line"></span><br><span class="line">* 最大为 2 GB</span><br></pre></td></tr></table></figure></li>
<li><strong>CLOB 型</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">* 最大为 (4 gigabytes -1) * (DB_BLOCK_SIZE)</span><br></pre></td></tr></table></figure></li>
<li><strong>BLOB 型</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">* 最大为 (4 gigabytes -1) * (DB_BLOCK_SIZE initialization parameter (8 TB to 128 TB))</span><br><span class="line"></span><br><span class="line">* 实际只储存外部文件的指针，实际数据文件在数据库之外</span><br></pre></td></tr></table></figure></li>
<li><strong>RAW 型和 LONG RAW 型</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">* 原始二进制数据</span><br></pre></td></tr></table></figure></li>
<li><strong>BFILE 型</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">* 外部文件的二进制数据，最大为 4 GB</span><br><span class="line"></span><br><span class="line">* 创建指向系统文件的指针</span><br><span class="line"></span><br><span class="line">* 文件放在操作系统上，数据库中创建 BFILE 的内容</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h1 id="Chapter08-表的高级特性"><a href="#Chapter08-表的高级特性" class="headerlink" title="Chapter08 表的高级特性"></a>Chapter08 表的高级特性</h1><hr>
<h2 id="8-1-表的属性"><a href="#8-1-表的属性" class="headerlink" title="8.1 表的属性"></a>8.1 表的属性</h2><hr>
<h3 id="知识点：表的属性"><a href="#知识点：表的属性" class="headerlink" title="知识点：表的属性"></a>知识点：表的属性</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">* 位置</span><br><span class="line">  - column_definition</span><br><span class="line">  - physical_properties_clause</span><br><span class="line">  - table_properties_clause</span><br></pre></td></tr></table></figure></li>
<li><strong>表的物理属性 physical_properties_clause</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 通过控制表的物理属性，控制表的类型</span><br><span class="line">  - 控制的内容包括段属性、外部表等</span><br><span class="line"></span><br><span class="line">* physical_properties_clause</span><br><span class="line">  &#123; [ deferred_segment_creation ] segment_attributes_clause [ table_compression ] [ inmemory_table_clause ] [ ilm_clause ] &#125;</span><br><span class="line">  &#123; [ deferred_segment_creation ] ORGANIZATION HEAP [ segment_attributes_clause ] heap_org_table_clause &#125;</span><br><span class="line">  &#123; [ deferred_segment_creation ] ORGANIZATION INDEX [ segment_attributes_clause ] index_org_table_clause &#125;</span><br><span class="line">  &#123; [ deferred_segment_creation ] ORGANIZATION EXTERNAL external_table_clause &#125;</span><br><span class="line">  &#123; [ deferred_segment_creation ] EXTERNAL PARTITION ATTRIBUTES external_table_clause [REJECT LIMIT] &#125;</span><br><span class="line">  &#123; CLUSTER cluster (column [, column ]...) &#125;</span><br></pre></td></tr></table></figure></li>
<li><strong>表的功能属性 table_properties_clause</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 通过指定属性，控制表的功能</span><br><span class="line">  - 包括只读表、分区表等</span><br><span class="line"></span><br><span class="line">* table_properties_clause</span><br><span class="line">  [ column_properties ]</span><br><span class="line">  [ read_only_clause ]</span><br><span class="line">  [ indexing_clause ]</span><br><span class="line">  [ table_partitioning_clauses ]</span><br><span class="line">  [ attribute_clustering_clause ]</span><br><span class="line">  [ CACHE | NOCACHE ]</span><br><span class="line">  [ result_cache_clause ]</span><br><span class="line">  [ parallel_clause ]</span><br><span class="line">  [ ROWDEPENDENCIES | NOROWDEPENDENCIES ]</span><br><span class="line">  [ enable_disable_clause ]...</span><br><span class="line">  [ row_movement_clause ]</span><br><span class="line">  [ logical_replication_clause ]</span><br><span class="line">  [ flashback_archive_clause ]</span><br><span class="line">  [ ROW ARCHIVAL ]</span><br><span class="line">  [ AS Sub_Query | &#123; FOR EXCHANGE WITH TABLE [ schema .] table &#125; ]</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：只读表"><a href="#知识点：只读表" class="headerlink" title="知识点：只读表"></a>知识点：只读表</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 只读表，表示不允许进行任何可能修改数据的操作</span><br><span class="line"></span><br><span class="line">* 只读表不可以进行的操作</span><br><span class="line">  - DML</span><br><span class="line">  - 会修改数据的 DDL</span><br><span class="line">    - TRUNCATE TABLE</span><br><span class="line">    - ALTER TABLE RENAME COLUMN</span><br><span class="line">    - ALTER TABLE DROP COLUMN</span><br><span class="line">    - ALTER TABLE SET COLUMN UNUSED</span><br><span class="line">    - FLASHBACK TABLE</span><br><span class="line">  - SELECT FOR UPDATE 语句</span><br><span class="line">  - 删除表的 READ ONLY 分区</span><br><span class="line">  - 删除只读表的分区</span><br><span class="line"></span><br><span class="line">* 只读表可以进行的操作</span><br><span class="line">  - 删除表</span><br><span class="line">    - DROP TABLE</span><br><span class="line">  - 不修改数据的 DDL</span><br><span class="line">    - ALTER TABLE RENAME table</span><br><span class="line">    - ALTER TABLE MOVE</span><br><span class="line">    - ALTER TABLE ENABLE ROW MOVEMENT</span><br><span class="line">    - ALTER TABLE SHRINK</span><br><span class="line">    - ALTER TABLE ADD/DROP SUPPLEMENTAL LOG</span><br><span class="line">  - 不修改数据的列的 DDL</span><br><span class="line">    - ALTER TABLE ADD COLUMN</span><br><span class="line">    - ALTER TABLE MODIFY COLUMN</span><br><span class="line">    - ALTER TABLE DROP UNUSED COLUMNS</span><br><span class="line">  - 添加修改删除约束</span><br><span class="line">    - ALTER TABLE ADD/MODIFY/DROP/ENABLE/DISABLE CONSTRAINT</span><br><span class="line">  - 可以对相应的索引进行操作</span><br><span class="line">    - CREATE INDEX</span><br><span class="line">    - ALTER INDEX</span><br><span class="line">    - DROP INDEX</span><br></pre></td></tr></table></figure></li>
<li><strong>DDL</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">-- 语法</span><br><span class="line">READ ONLY</span><br><span class="line">READ WRITE</span><br><span class="line"></span><br><span class="line">-- 应用</span><br><span class="line">CREATE TABLE table READ ONLY AS Sub_Query ;</span><br><span class="line">ALTER TABLE table READ ONLY ;</span><br><span class="line">ALTER TABLE table READ WRITE ;</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h2 id="8-2-特殊列"><a href="#8-2-特殊列" class="headerlink" title="8.2 特殊列"></a>8.2 特殊列</h2><hr>
<h3 id="知识点：隐藏列-INIVISIBLE"><a href="#知识点：隐藏列-INIVISIBLE" class="headerlink" title="知识点：隐藏列 INIVISIBLE"></a>知识点：隐藏列 INIVISIBLE</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 12C 新功能</span><br><span class="line">  - 可以用 SELECT column 查看</span><br><span class="line">  - 无法用 DESC 命令查看</span><br><span class="line">  - 无法用 SELECT * 查看</span><br><span class="line">  - INSERT 语句要显式指定 column</span><br><span class="line">  - %ROWTYPE 会自动忽略掉隐藏列</span><br><span class="line"></span><br><span class="line">* 虚拟列可以设置为隐藏列</span><br><span class="line"></span><br><span class="line">* 隐藏列的限制</span><br><span class="line">  - 外部表，簇表，临时表，不可以设置隐藏列</span><br><span class="line"></span><br><span class="line">* 应用</span><br><span class="line">  - 修改列的顺序</span><br><span class="line">    - 设置一个列 INVISIBLE 后再 VISIABLE，则列会排列到表的最末尾</span><br></pre></td></tr></table></figure></li>
<li><strong>相关字典</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">* DBA_TAB_COLS</span><br><span class="line">  - HIDDEN_COLUMN 列</span><br><span class="line"></span><br><span class="line">* DBA_TAB_COLS</span><br><span class="line">  - COLUMN_ID 列，会被置 NULL</span><br></pre></td></tr></table></figure></li>
<li><strong>语法</strong><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- CREATE TABLE</span></span><br><span class="line"><span class="comment">-- 关键字放需要放在 DEFALUT 之前</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> TableName ( ColumnName DataType [INVISIBLE<span class="operator">|</span>VISIBLE] <span class="keyword">DEFAULT</span> <span class="keyword">Value</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">-- ALTER TABLE</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> TableName MODIFY ( ColumnName &#123;INVISIBLE<span class="operator">|</span>VISIBLE&#125; )</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：虚拟列-VIRTUAL"><a href="#知识点：虚拟列-VIRTUAL" class="headerlink" title="知识点：虚拟列 VIRTUAL"></a>知识点：虚拟列 VIRTUAL</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 虚拟列，是通过引用同一个表的其他列同一行的数据，来计算而生成数据，不实际储存数据</span><br><span class="line"></span><br><span class="line">* 虚拟列的特性</span><br><span class="line">  - 只能在堆表上创建</span><br><span class="line">  - 不能引用其他虚拟列</span><br><span class="line">  - 不能引用其他的表的列</span><br><span class="line">  - 不能被 INSERT，不能被 UPDATE</span><br><span class="line">  - 可以省略数据类型</span><br><span class="line">  - 可以被 select</span><br><span class="line">  - 可以创建索引</span><br><span class="line">  - 可以用在 where 中</span><br><span class="line">  - 可以创建约束</span><br><span class="line">  - 可以被外键引用</span><br></pre></td></tr></table></figure></li>
<li><strong>相关字典</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">* DBA_TAB_COLS</span><br><span class="line">  - VIRTUAL_COLUMN 列，记录是否是虚拟列</span><br></pre></td></tr></table></figure></li>
<li><strong>语法</strong><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- CREATE TABLE 创建虚拟列</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> TableName ( ColumnName [DataType] [VISIBLE<span class="operator">|</span>INVISIBLE] [GENERATED ALWAYS] <span class="keyword">AS</span> ( Expression ) [VIRTUAL] [Constraints] )</span><br><span class="line"></span><br><span class="line"><span class="comment">-- ALTER TABLE ADD 添加一个虚拟列</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> TableName <span class="keyword">ADD</span> ColumnName [DataType] [VISIBLE<span class="operator">|</span>INVISIBLE] [GENERATED ALWAYS] <span class="keyword">AS</span> ( Expression ) [VIRTUAL] [Constraints] ;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- ALTER TABLE ADD 添加多个虚拟列</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> TableName <span class="keyword">ADD</span> (</span><br><span class="line">    ColumnName [DataType] [VISIBLE<span class="operator">|</span>INVISIBLE] [GENERATED ALWAYS] <span class="keyword">AS</span> ( Expression ) [VIRTUAL] [Constraints]</span><br><span class="line">    [, ColumnName [DataType] [VISIBLE<span class="operator">|</span>INVISIBLE] [GENERATED ALWAYS] <span class="keyword">AS</span> ( Expression ) [VIRTUAL] [Constraints] ] ... )</span><br><span class="line">    ;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- ALTER TABLE MODIFY 修改虚拟列</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> TableName MODIFY ColumnName [DataType] [GENERATED ALWAYS] <span class="keyword">AS</span> ( Expression ) [VIRTUAL] ;</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">* AS ( Expression )</span><br><span class="line">  - 指定虚拟列的值的表达式</span><br><span class="line"></span><br><span class="line">* GENERATED ALWAYS</span><br><span class="line">  - 语法提示词</span><br><span class="line"></span><br><span class="line">* VIRTUAL</span><br><span class="line">  - 语法提示词</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：自增列-IDENTITY"><a href="#知识点：自增列-IDENTITY" class="headerlink" title="知识点：自增列 IDENTITY"></a>知识点：自增列 IDENTITY</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 12C 新功能</span><br><span class="line">  - Oracle 会自动创建一个序列，对每一次 INSERT 语句，自动将序列的值添加到自增列中</span><br><span class="line">  - ALWAYS 型的自增列不能显式 INSERT</span><br><span class="line">  - 序列可以是递增的，也可以是递减的</span><br><span class="line">  - 自增列会隐式的建立一个 NOR DEFERRABLE 的 NOT NULL 约束</span><br><span class="line"></span><br><span class="line">* 自增列的作用</span><br><span class="line">  - 为表生成不会产生中断的数据，作为主键</span><br><span class="line">  - 如果自增列使用了 CACHE，那么如果关闭数据库，则还是可能产生中断的数据</span><br><span class="line"></span><br><span class="line">* 自增列的限制</span><br><span class="line">  - 取代 DEFAULT 的设置</span><br><span class="line">  - 自增列的数据类型必须是 NUMBER</span><br><span class="line">  - 一个表只能有一个自增列</span><br><span class="line">  - 子查询建表不会继承自增列</span><br><span class="line"></span><br><span class="line">* 在已存在数据的表中添加自增列</span><br><span class="line">  - Oracle 会自动在已存在的行上随机填充 id</span><br><span class="line">  - 对之后的 INSERT 则正常进行标识</span><br></pre></td></tr></table></figure></li>
<li><strong>相关字典</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">* DBA_TAB_COLS</span><br><span class="line">  - IDENTITY_COLUMN 列，记录是否是自增列</span><br></pre></td></tr></table></figure></li>
<li><strong>identity_clause 从句</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">* 位置</span><br><span class="line">  - 放在原来 DEFAULT 的位置</span><br><span class="line"></span><br><span class="line">* 语法</span><br><span class="line">  GENERATED &#123; ALWAYS | &#123;BY DEFAULT [ON NULL]&#125; &#125; AS IDENTITY [( identity_option [ ...] )]</span><br><span class="line"></span><br><span class="line">* ALWAYS</span><br><span class="line">  - 自增列的数据只能由 oralce 根据序列来填充，不能显式指定，如手动 INSERT，或者在 INSERT 语句中使用 DEFAULT 关键字</span><br><span class="line"></span><br><span class="line">* BY DEFAULT</span><br><span class="line">  - 自增列的数据既可以根据序列来填充，也可以显式指定</span><br><span class="line"></span><br><span class="line">* ON NULL</span><br><span class="line">  - 如果 INSERT 语句在自增列上的数据为 NULL，则填充序列</span><br><span class="line"></span><br><span class="line">* identity_options</span><br><span class="line">  - 设置序列的属性，所有内容与 CREATE SEQUENCE 相同</span><br><span class="line">  - INCREMENT BY n</span><br><span class="line">  - MAXVALUE n | NOMAXVALUE</span><br><span class="line">  - MINVALUE n | NOMINVALUE</span><br><span class="line">  - CYCLE | NOCYCLE</span><br><span class="line">  - CACHE n | NOCACHE</span><br><span class="line">  - ORDER | NOORDER</span><br><span class="line">  - START WITH n</span><br><span class="line">  - START WITH LIMIT VALUE</span><br><span class="line">    - identity_options 中唯一一个与 CREATE SEQUENCE 不同的语句</span><br><span class="line">    - 只能用在 ALTER TABLE MODIFY 语句中</span><br><span class="line">    - 将已存在数据的列修改为自增列时，会自动选取已存在数据中的最值，之后的序列的起点从最值开始</span><br><span class="line">    - 递增型则最大值，递减型则最小值</span><br></pre></td></tr></table></figure></li>
<li><strong>应用</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">* CREATE TABLE 创建自增列</span><br><span class="line"></span><br><span class="line">* ALTER TABLE ADD 添加自增列</span><br><span class="line"></span><br><span class="line">* ALTER TABLE MODIFY 修改自增列</span><br><span class="line">  - ALTER TABLE table MODIFY ( column GENERATED ALWAYS AS IDENTITY ( START WITH LIMIT VALUE ) )</span><br><span class="line"></span><br><span class="line">* ALTER TABLE MODIFY 删除自增列</span><br><span class="line">  ALTER TABLE MODIFY ( column DROP IDENTIFY )</span><br><span class="line">  - 删除自增列的自增属性</span><br><span class="line">  - 级联删除相应的序列</span><br><span class="line">  - 已存在的数据不受影响</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h2 id="8-3-临时表"><a href="#8-3-临时表" class="headerlink" title="8.3 临时表"></a>8.3 临时表</h2><hr>
<h2 id="8-4-外部表"><a href="#8-4-外部表" class="headerlink" title="8.4 外部表"></a>8.4 外部表</h2><hr>
<h3 id="知识点：外部表"><a href="#知识点：外部表" class="headerlink" title="知识点：外部表"></a>知识点：外部表</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 外部表 external table，直接将 OS 上的文本文件或 EXCEL 文件等，当做表的方式进行读取</span><br><span class="line">  - 本质上是一个指向 OS 数据文件的指针</span><br><span class="line">  - 需要指定目录对象</span><br><span class="line">  - 外部表只支持 READ</span><br><span class="line">  - 不支持 DML</span><br><span class="line">  - 不支持建立索引</span><br><span class="line"></span><br><span class="line">* 优点</span><br><span class="line">  - 通过外部表，可以直接从外部数据文件中加载数据，更简捷，不需要中转表，这对处理大量数据可以节省空间</span><br><span class="line"></span><br><span class="line">* 装载数据</span><br><span class="line">  - 从外部表中将数据导入到数据库中</span><br><span class="line">  - 先创建外部表，再使用 INSERT SELECT 或 CREATE TABLE AS SELECT 将数据添加到数据库中的表中</span><br><span class="line"></span><br><span class="line">* 卸载数据</span><br><span class="line">  - 从数据库中将数据保存到外部数据文件作为外部表</span><br><span class="line">  - ORACLE 卸载数据只能使用 oracle_datapump 接口</span><br></pre></td></tr></table></figure></li>
<li><strong>接口方式</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">* ORACLE</span><br><span class="line">  - sql_loader</span><br><span class="line">    - 默认方式</span><br><span class="line">    - 支持文本文件、csv 文件、excel 文件</span><br><span class="line">  - oracle_datapump</span><br><span class="line">    - 可以直接从 dmp 文件中调取数据，也可以在数据库加载 dmp 文件前通过使用外部表来验证 dmp 文件中的数据</span><br><span class="line">    - 仅支持 dmp 文件，并且是使用 datapump 创建的 dmp 文件，不支持 exp 创建的 dmp 文件</span><br><span class="line">  - oracle_hdfs</span><br><span class="line">  - oracle_hive</span><br></pre></td></tr></table></figure></li>
<li><strong>相关字典</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">* ORACLE</span><br><span class="line">  - DBA_EXTERNAL_TABLES       记录所有的外部表</span><br><span class="line">  - DBA_EXTERNAL_LOCATIONS    记录外部表指向的操作系统文件</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="知识点：Oracle-创建外部表"><a href="#知识点：Oracle-创建外部表" class="headerlink" title="知识点：Oracle 创建外部表"></a>知识点：Oracle 创建外部表</h3><ol>
<li><strong>Oracle_LOADER 创建外部表</strong><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="keyword">Table</span> ( Column_List )      <span class="comment">-- 外部表的列应当与操作系统文件中的列的数量和数据类型要对应</span></span><br><span class="line">  ORGANIZATION <span class="keyword">EXTERNAL</span>(</span><br><span class="line">    TYPE Oracle_LOADER                  <span class="comment">-- 指定接口为 sql_loader</span></span><br><span class="line">    <span class="keyword">DEFAULT</span> DIRECTORY dir               <span class="comment">-- 指定目录对象</span></span><br><span class="line">    ACCESS PARAMETERS(                  <span class="comment">-- 指定打开操作系统文件的参数</span></span><br><span class="line">      RECORDS DELIMITED <span class="keyword">BY</span> NEWLINE        <span class="comment">-- 指定外部数据文件是一行为一个记录</span></span><br><span class="line">      FIELDS TERMINATED <span class="keyword">by</span> <span class="string">&#x27;|&#x27;</span>            <span class="comment">-- 指定外部数据文件中以 &#x27;|&#x27; 为列分隔符</span></span><br><span class="line">      MISSING FIELD <span class="keyword">VALUES</span> <span class="keyword">ARE</span> <span class="keyword">NULL</span>       <span class="comment">-- 指定外部数据文件中如有缺失则填写 NULL</span></span><br><span class="line">      (                                   <span class="comment">-- 指定外部表的每一列对应操作系统文件中的哪一列</span></span><br><span class="line">        id,</span><br><span class="line">        count,</span><br><span class="line">        flag,</span><br><span class="line">        comm,</span><br><span class="line">        order_date <span class="type">CHAR</span> DATE_FORMAT <span class="type">DATE</span> MASK &quot;mm/dd/yyyy&quot;    <span class="comment">-- 指定以何种方式读取操作操作系统文件中表示 date 的列</span></span><br><span class="line">      )</span><br><span class="line">    )</span><br><span class="line">    LOCATION( <span class="string">&#x27;test.csv&#x27;</span> )                <span class="comment">-- 指定操作系统文件名</span></span><br><span class="line">  )</span><br><span class="line">  REJECT LIMIT UNLIMITED                  <span class="comment">-- 不加这一行可能会报错，所以一般都加上</span></span><br><span class="line">  ;</span><br></pre></td></tr></table></figure></li>
<li><strong>Oracle_DATAPUMP 创建外部表</strong><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="keyword">table</span> ( Column_List )</span><br><span class="line">  ORGANIZATION <span class="keyword">EXTERNAL</span>(</span><br><span class="line">    TYPE Oracle_DATAPUMP</span><br><span class="line">    <span class="keyword">DEFAULT</span> DIRECTORY dir</span><br><span class="line">    LOCATION( <span class="string">&#x27;emp.dmp&#x27;</span> [, ...] )          <span class="comment">-- 多个 dmp 文件自动启用并行</span></span><br><span class="line">    )</span><br><span class="line">    ;</span><br></pre></td></tr></table></figure></li>
<li><strong>Oracle_DATAPUMP 卸载数据</strong><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="keyword">table</span> [( Column_List )]</span><br><span class="line">  ORGANIZATION <span class="keyword">EXTERNAL</span>(</span><br><span class="line">    TYPE Oracle_DATAPUMP</span><br><span class="line">    <span class="keyword">DEFAULT</span> DIRECTORY dir</span><br><span class="line">    ACCESS PARAMETERS (</span><br><span class="line">      [COMPRESSION ENABLED BASIC]         <span class="comment">-- 启用压缩，压缩功能需要付费</span></span><br><span class="line">      )</span><br><span class="line">    LOCATION( <span class="string">&#x27;emp.dmp&#x27;</span> [, ...] )</span><br><span class="line">    )</span><br><span class="line">  [PARALLEL n]                            <span class="comment">-- 并行数要与 LOCATION 子句中的文件数相同</span></span><br><span class="line">  <span class="keyword">AS</span> Sub_Query</span><br><span class="line">  ;</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h2 id="8-5-分区表"><a href="#8-5-分区表" class="headerlink" title="8.5 分区表"></a>8.5 分区表</h2><hr>
<h3 id="知识点：分区表"><a href="#知识点：分区表" class="headerlink" title="知识点：分区表"></a>知识点：分区表</h3><ol>
<li><strong>介绍</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">* 介绍</span><br><span class="line">  - 将一个表划分为多个分区表</span><br><span class="line">  - 目的，提高大表的查询效率</span><br><span class="line"></span><br><span class="line">* 优点：</span><br><span class="line">  - 改善查询性能 : 分区对象的查询仅搜索自己关系的分区</span><br><span class="line">  - 增强可用性   : 如果某个分区出现故障，其它分区的数据仍然可用</span><br><span class="line">  - 维护方便     : 如果某个分区出现故障，仅修复该分区即可</span><br><span class="line">  - 均衡 I/O     : 将不同的分区放置不同的磁盘，以均衡 I/O，改善整个系统性能</span><br><span class="line"></span><br><span class="line">* 缺点：</span><br><span class="line">  - 已经存在的表无法直接转化为分区表，不过有很多间接方法</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ol>

    </div>

    
    
    

    <footer class="post-footer">

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2000/01/01/Blog03-%E4%BA%91%E8%AE%A1%E7%AE%97/" rel="prev" title="Blog03-云计算">
                  <i class="fa fa-chevron-left"></i> Blog03-云计算
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2000/01/01/Blog13-mysql/" rel="next" title="Blog13-mysql">
                  Blog13-mysql <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 2000 – 
  <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">John Doe</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/muse/" rel="noopener" target="_blank">NexT.Muse</a>
  </div>

    </div>
  </footer>

  
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script>

  





  




  

  <script class="next-config" data-name="enableMath" type="application/json">false</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"per_page":true,"tags":"none","cdn":"//cdn.bootcss.com/mathjax/2.7.1/latest.js?config=TeX-AMS-MML_HTMLorMML","js":{"url":"https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js","integrity":"sha256-r+3itOMtGGjap0x+10hu6jW/gZCzxHsoKrOd7gyRSGY="}}</script>
<script src="/js/third-party/math/mathjax.js"></script>



</body>
</html>
